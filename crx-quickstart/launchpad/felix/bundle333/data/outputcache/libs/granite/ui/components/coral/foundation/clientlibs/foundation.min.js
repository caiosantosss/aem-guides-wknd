(function(n,h){if(navigator.userAgent.match(/.*?(Trident|Edge)/))h(n).on("click","button[type\x3dsubmit]",function(b){var g=this.getAttribute("form");g&&(b.preventDefault(),b=n.getElementById(g))&&(g=n.createEvent("Event"),g.initEvent("submit",!0,!0),b.dispatchEvent(g))});h(n).on("click","button[type\x3dreset]",function(b){var g=this.getAttribute("form");g&&(b.preventDefault(),(b=n.getElementById(g))&&b.reset())});Array.prototype.find||(Array.prototype.find=function(b,g){var c;Array.prototype.some.call(this,
function(a){return b.apply(g,arguments)?(c=a,!0):!1});return c});String.prototype.startsWith||(String.prototype.startsWith=function(b,g){return this.substr(g||0,b.length)===b});String.prototype.endsWith||(String.prototype.endsWith=function(b,g){g=g<this.length?g|0:this.length;return this.substr(g-b.length,b.length)===b});n.contains||(h=function(b){if(1>arguments.length)throw new TypeError("1 argument is required");do{if(this===b)return!0;b&&(b=b.parentNode)}while(b);return!1},n.contains=h,Element.prototype.contains=
h)})(document,Granite.$);Granite=window.Granite||{};Granite.UI=Granite.UI||{};Granite.UI.Foundation=Granite.UI.Foundation||{};(function(n,h,b){b.options.transformHash=!1})(document,Granite.$,History);
(function(n,h,b,g){b.UI.Foundation.Utils=b.UI.Foundation.Utils||function(){var c=[],a=function(f,m,p,k){k=k||g(m);var t=[];f.find(m).each(function(){var l=this;k.is(function(){return p(this,l)})?g(l).remove():t.push(g(l).detach()[0])});return g(t)},d=function(f,m){if(0===f.length)return Array.prototype.push.apply(f,m),f;g.each(m,function(){var p=this;f.some(function(k){return k.src===p.src})||f.push(p)});return f},e=function(f,m){var p=[];g.each(f,function(){var k=h.createElement("script"),t=g.Deferred();
p.push(t);g(k).one("load error",function(){t.resolve()});k.async=!1;k.src=this.src;m.appendChild(k)});return g.when.apply(null,p)};return{everyReverse:function(f,m,p){for(var k=f.length-1;0<=k;k--)if(!m.call(p,f[k],k,f))return!1;return!0},debounce:function(f,m,p){var k;return function(){var t=this,l=arguments,q=p&&!k;clearTimeout(k);k=setTimeout(function(){k=null;p||f.apply(t,l)},m);q&&f.apply(t,l)}},sanitizeHtml:function(f){return DOMPurify.sanitize(f,{SANITIZE_DOM:!1,CUSTOM_ELEMENT_HANDLING:{tagNameCheck:function(m){return!0},
attributeNameCheck:function(m){return!0},allowCustomizedBuiltInElements:!0},ADD_ATTR:"coral-close tracking trackingelement trackingfeature variant is form fieldtrackingidentifier trackingWidget".split(" ")})},processHtml:function(f,m,p,k){if(f.jquery)var t=f;else t=h.createElement("div"),t.innerHTML=f,t=g(t);var l=a(t,"script[src]",function(u,w){return u.src===w.src},g(d(c,g("script[src]")))),q=a(t,"link[rel\x3dstylesheet]",function(u,w){return u.href===w.href}),r=g("head");k||(r.append(g("link[rel\x3dstylesheet]",
h.body)),g("script[src]",h.body).remove());var z=e(l,r[0]);r.append(q);p&&setTimeout(function(){z.done(p)},0);k=t.find(m);return f.jquery?m?k.length?k:t:t:m?k.length?k[0].outerHTML:t[0].innerHTML:t[0].innerHTML}}}()})(window,document,Granite,Granite.$);
(function(n,h){Granite.UI.Foundation.Registry=Granite.UI.Foundation.Registry||function(){var b=new Map;return{register:function(g,c){b.has(g)?b.get(g).push(c):b.set(g,[c])},get:function(g){return b.has(g)?b.get(g):[]}}}();Granite.UI.Foundation.Registry.register("foundation.adapters",{type:"foundation-registry",selector:h(n),adapter:function(){return Granite.UI.Foundation.Registry}})})(window,Granite.$);
(function(n,h){n.UI.Foundation.Adapters=n.UI.Foundation.Adapters||function(){var b=n.UI.Foundation.Registry,g=function(){return b.get("foundation.adapters")};return{register:function(c,a,d){b.register("foundation.adapters",{type:c,selector:a,adapter:d})},has:function(c){return g().some(function(a){return a.type===c})},get:function(c){var a=[];g().forEach(function(d){d.type===c&&a.push(d)});return a},adapt:function(c,a){if(c&&a){var d=h(c),e;n.UI.Foundation.Utils.everyReverse(g(),function(p){return p.type===
a&&d.is(p.selector)?(e=p,!1):!0});if(e){var f="foundation.adapters.internal.adapters."+e.type,m=d.data(f);if(m&&m.config===e)return m.instance;c=e.adapter(c);d.data(f,{config:e,instance:c});return c}}}}}();h.fn.adaptTo=h.fn.adaptTo||function(b){return n.UI.Foundation.Adapters.adapt(this[0],b)}})(Granite,Granite.$);
(function(n,h){var b=!1;h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracker",selector:h(n),adapter:function(){return{setDebugMode:function(g){b=!!g},trackPage:function(g){b&&console.dir({type:"page",data:g});try{n.Granite.Tracking.Tracker.trackPage(g)}catch(c){}},trackEvent:function(g){b&&console.dir({type:"event",data:g});try{n.Granite.Tracking.Tracker.trackEvent(g)}catch(c){}}}}})})(window,Granite.$);
(function(n,h,b){b(function(){var g=b("meta[name\x3d'foundation.tracking.page']",h.head).attr("content");g&&(g=JSON.parse(g),b(n).adaptTo("foundation-tracker").trackPage(g))})})(window,document,Granite.$);
(function(n,h,b){b(h).on("click","[data-foundation-tracking-event]",function(g){b(this).adaptTo("foundation-tracking-event").track(g)});b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracking-event",selector:"[data-foundation-tracking-event]",adapter:function(g){var c=b(g);return{track:function(a){var d=g.getAttribute("data-foundation-tracking-event"),e=g.getAttribute("tracking");a=c.adaptTo("foundation-tracking-event-data-provider");!d||e&&"ON"!==e||(d=JSON.parse(d),
a=a&&a.getTrackingAttributes&&a.getTrackingAttributes(c),a={element:d.element||"No element defined",feature:d.feature||"No feature defined",type:d.type,action:"click",widget:d.widget||{},attributes:a||{}},a.widget.name=a.widget&&a.widget.name?a.widget.name:"No widget defined",b(n).adaptTo("foundation-tracker").trackEvent(a))}}}})})(window,document,Granite.$);
(function(n,h){function b(g){if("string"!==typeof g)return"";if("en"!==Granite.I18n.getLocale()){var c=Granite.I18n.getLocale(),a=Granite.I18n.getDictionary(c);return Object.values(a).includes(g)?Object.keys(a).find(function(d){return a[d]===g}):g.match("^[a-zA-Z0-9\\s-_]+")?g:""}return g.toLowerCase()}"undefined"!==typeof Coral&&Coral.tracking&&Coral.tracking.addListener(function(g,c,a,d){c=a.getAttribute("tracking");c&&"ON"!==c||(a=h(a),a=(c=a.adaptTo("foundation-tracking-event-data-provider"))&&
c.getTrackingAttributes&&c.getTrackingAttributes(a),g={element:b(g.targetElement)||"No element defined",type:b(g.targetType),action:b(g.eventType),widget:{name:b(g.rootElement)||"No widget defined",type:b(g.rootType)},feature:b(g.rootFeature)||"No feature defined",attributes:a||{}},h(n).adaptTo("foundation-tracker").trackEvent(g))})})(window,Granite.$);
(function(n,h,b){b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-form-handle-tracking",selector:"form",adapter:function(g){return{trackFormSubmit:function(){if(g||g.matches("form")){var c=b(g),a=c.adaptTo("foundation-tracking-event-data-provider"),d=c.serializeArray?c.serializeArray():[],e=g.getAttribute("fieldTrackingIdentifier"),f=g.getAttribute("trackingElement"),m=g.getAttribute("trackingFeature"),p=g.getAttribute("trackingWidget");c=a&&a.getTrackingAttributes?
a.getTrackingAttributes(c):{};a={};var k;if(k=p)b:{try{JSON.parse(p)}catch(l){k=!1;break b}k=!0}p=k?JSON.parse(p):{};p.name=p.name?p.name:"No widget defined";p.type=p.type?p.type:"form";if(e&&d&&0<d.length)try{var t=JSON.parse("["+e+"]");e={};for(k=0;k<d.length;k++)e[d[k].name]=d[k].value;for(d=0;d<t.length;d++)e[t[d].name]&&(a[t[d].tag]=e[t[d].name])}catch(l){}c=Object.assign(c,a);f={element:f||"No element defined",type:"button",action:"click",widget:p,feature:m||"No feature defined",attributes:b.isEmptyObject(c)?
{}:c};b(n).adaptTo("foundation-tracker").trackEvent(f)}}}}})})(window,document,Granite.$);
(function(n,h,b,g){function c(){e||(e=(new g.Dialog).set({closable:"on"}).on("coral-overlay:close",function(k){k.target.remove()}));return e}function a(){f||(f=(new g.Dialog).set({backdrop:g.Dialog.backdrop.STATIC,interaction:"off"}).on("coral-overlay:close",function(k){k.target.remove()}));return f}function d(){if(!m){m=h(n.createElement("div")).addClass("foundation-ui-mask");m.attr("role","alert");var k=n.createElement("span");k.setAttribute("class","u-coral-screenReaderOnly");k.innerHTML=b.I18n.get("Loading");
var t=(new g.Wait).set({centered:!0,size:"L"});t.append(k);m.append(t)}return m}var e,f,m,p=h(window).adaptTo("foundation-registry");p.register("foundation.adapters",{type:"foundation-ui",selector:h(window),adapter:function(){return{alert:function(k,t,l){var q=c();q.variant=l||"default";q.header.textContent=k||"";q.content.innerHTML=t||"";n.body.appendChild(q);q.show()},notify:function(k,t,l,q){q=q&&"number"===typeof q&&0<q?q:5E3;k=k||function(){switch(l){case "error":return b.I18n.get("Error");case "notice":return b.I18n.get("Notice");
case "success":return b.I18n.get("Success");case "help":return b.I18n.get("Help");default:return b.I18n.get("Info")}}();if(g.Toast){var r=(new g.Toast).on("coral-overlay:close",function(z){z.target.remove()});r.set({autoDismiss:q});"warning"===String(l).toLowerCase()?l="error":"help"!==String(l).toLowerCase()&&l||(l="info");r.variant=l;r.content.innerHTML=t||k;n.body.appendChild(r);r.show()}else r=new g.Alert,r.classList.add("foundation-ui-notification"),r.variant=l||"info",r.header.textContent=k,
r.content.innerHTML=t||"",b.UI.Foundation.Utils.everyReverse(p.get("foundation.ui.notify.positionhandler"),function(z){return!1===z.call(r,r)})&&n.body.appendChild(r);setTimeout(function(){r.remove()},q);return{clear:function(){r.remove()}}},waitTicker:function(k,t){var l=new g.Dialog;l.backdrop=g.Dialog.backdrop.STATIC;l.header.textContent=k;l.header.insertBefore(new g.Wait,l.header.firstChild);l.content.innerHTML=t||"";n.body.appendChild(l);l.show();return{updateMessage:function(q){l.content.innerHTML=
q},clear:function(){l.hide();requestAnimationFrame(function(){l.remove()})}}},prompt:function(k,t,l,q,r){var z=a();z.variant=l||"default";z.header.textContent=k||"";z.content.innerHTML=b.UI.Foundation.Utils.sanitizeHtml(t||"");z.footer.innerHTML="";q.forEach(function(u){var w=new g.Button;w.label.textContent=u.text;u.id&&(w.id=u.id);u.primary?(z.focusOnShow=w,w.variant="primary"):u.warning&&(w.variant="warning");w.on("click",function(A){z.hide();u.handler&&u.handler(u);r&&r(u.id,u)});z.footer.appendChild(w)});
n.body.appendChild(z);z.show()},wait:function(k){d().appendTo(k||n.body)},clearWait:function(){d().detach()}}}})})(document,Granite.$,Granite,Coral);
(function(n,h,b){var g=[],c=function(f,m,p,k){k=k||b(m);var t=[];Array.prototype.forEach.call(f.querySelectorAll(m),function(l){k.is(function(){return p(this,l)})?b(l).remove():t.push(b(l).detach()[0])});return t},a=function(f,m){if(0===f.length)return Array.prototype.push.apply(f,m),f;b.each(m,function(){var p=this;f.some(function(k){return k.src===p.src})||f.push(p)});return f},d=function(f,m){f=f.map(function(p){var k=b.Deferred(),t=h.createElement("script");b(t).one("load error",function(){k.resolve()});
t.async=!1;t.src=p.src;m.appendChild(t);return k});return b.when.apply(null,f)},e=function(f,m){var p=c(f,"script[src]",function(t,l){return t.src===l.src},b(a(g,b("script[src]"))));f=c(f,"link[rel\x3dstylesheet]",function(t,l){return t.href===l.href});var k=b("head");m||(k.append(b("link[rel\x3dstylesheet]",h.body)),b("script[src]",h.body).remove());m=d(p,k[0]);k.append(f);return m};b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-htmlparser",selector:b(n),
adapter:function(){return{parse:function(f,m){var p=f instanceof Element||f instanceof DocumentFragment?f:this.createFragment(f);return e(p,m).then(function(){return p})},createFragment:function(f){var m=h.createElement("template");return"content"in m?(m.innerHTML=f,h.importNode(m.content,!0)):h.createRange().createContextualFragment(f)}}}})})(window,document,Granite.$);
(function(n,h,b){var g=0<=h.platform.toUpperCase().indexOf("MAC");b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-keyboard",selector:b(n),adapter:function(){return{normalize:function(c){c=c.replace(/meta|command|cmd|control/,"ctrl");return g?c.replace(/control|ctrl/,"\u2318"):c}}}})})(window,navigator,Granite.$);
(function(n,h,b){b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-messenger",selector:b(n),adapter:function(){return{put:function(g,c,a){try{var d=JSON.parse(n.sessionStorage.getItem("foundation-util-messenger.internal.messages"))||[];d.push({title:g,message:c,type:a});n.sessionStorage.setItem("foundation-util-messenger.internal.messages",JSON.stringify(d))}catch(e){n.console&&console.warn("Error occur saving message",e)}},promptAll:function(){var g=b(n).adaptTo("foundation-ui"),
c=JSON.parse(n.sessionStorage.getItem("foundation-util-messenger.internal.messages"));c&&(c.forEach(function(a){g.notify(a.title,a.message,a.type)}),n.sessionStorage.removeItem("foundation-util-messenger.internal.messages"))}}}});b(function(){b(n).adaptTo("foundation-util-messenger").promptAll()})})(window,document,Granite.$);
(function(n,h,b){function g(a){var d="GET",e=a,f=void 0;if(2E3<a.length){var m=a.lastIndexOf("?");0<=m&&(d="POST",e=a.substring(0,m),f=a.substring(m+1))}return{method:d,url:e,data:f}}function c(a){this.el=a.el;this.isLoading=!1;this.hasNext=!0;this.offset=0;this.limit=a.limit||20;this.size=a.size;this._resolveURL=a.resolveURL;this._processResponse=a.processResponse;this._onNewPage=a.onNewPage||b.noop;this._wait=a.wait||function(){return{clear:b.noop}};this._tolerance=20;this._started=this._destroyed=
!1;this._scrollHandler=this._performTimeoutId=null}c.prototype.start=function(a,d,e,f){if(this._destroyed)throw Error("Illegal state: paginator is already destroyed");if(this._started)throw Error("Illegal state: paginator is already started");var m=this,p=this.el;this._started=!0;this.offset=0<=a?a:0;this.hasNext="boolean"===typeof d?d:!0;var k=function(){m._scrollHandler=h.UI.Foundation.Utils.debounce(function(){m._destroyed||p.clientHeight+p.scrollTop+m._tolerance>=p.scrollHeight&&m._loadNextPage()},
100);p.addEventListener("scroll",m._scrollHandler);m.restart(m.offset,m.hasNext,e)};f?this._performTimeoutId=setTimeout(function(){k()},f):k()};c.prototype.restart=function(a,d,e){if(this._destroyed)throw Error("Illegal state: paginator is already destroyed");if(!this._started)throw Error("Illegal state: paginator is not yet started");this.offset=0<=a?a:0;this.hasNext="boolean"===typeof d?d:!0;e&&this.isLoading&&this._lastRequest.abort();this._doFirstLoad(e)};c.prototype.destroy=function(){this._scrollHandler&&
(this.el.removeEventListener("scroll",this._scrollHandler),this._scrollHandler=null);clearTimeout(this._performTimeoutId);this.isLoading&&this._lastRequest.abort();this._destroyed=!0};c.prototype._doFirstLoad=function(a){var d=this;if(!a){a=this.el.clientHeight;var e=this.el.scrollHeight;a=0<a&&e-a<=this._tolerance}a&&this._loadNextPage().then(function(){d._doFirstLoad()});return a};c.prototype._loadNextPage=function(){var a=this;if(this.isLoading||!this.hasNext)return b.Deferred().reject().promise();
this.isLoading=!0;var d=this._wait(this),e=this._resolveURL(this);e=g(e);this._lastRequest=b.ajax({method:e.method,url:e.url,data:e.data,cache:!1});return this._lastRequest.then(function(f){d.clear();return a._processResponse(a,f)},function(f,m){a.isLoading=!1;d.clear();"abort"!==m&&(f=h.I18n.get("Error"),m=h.I18n.get("Fail to load next page."),b(n).adaptTo("foundation-ui").alert(f,m,"error"))}).then(function(f){a.offset+=f.length;a.hasNext=f.hasNext;a.isLoading=!1;a._onNewPage(a)})};b(n).adaptTo("foundation-registry").register("foundation.adapters",
{type:"foundation-util-paginator",selector:b(n),adapter:function(){return c}})})(window,Granite,Granite.$);
(function(n,h){function b(g){this._descriptor=g;this._mixins=[]}b.prototype.mix=function(g){this._mixins.push(g);return this};b.prototype.build=function(){var g=this._descriptor,c=this._mixins.reduce(function(d,e){return e(d)},g),a=this._mixins.reduceRight(function(d,e){return e(d)},g);return{configurable:g.configurable,enumerable:g.enumerable,get:c.get,set:a.set}};b.createAttrBasedProperty=function(g,c){return{get:function(){var a=this.getAttribute(g);return void 0===c?a:null===a?c:a},set:function(a){this.setAttribute(g,
a)}}};b.createBooleanAttrBasedProperty=function(g,c){return{get:function(){return this.hasAttribute(g)?!0:void 0===c?!1:c},set:function(a){a?this.setAttribute(g,""):this.removeAttribute(g)}}};b.integerType=function(g){return function(c){return{get:function(){var a=parseInt(c.get.call(this),10);return isNaN(a)?g:a},set:function(a){a=parseInt(a,10);isNaN(a)&&(a=0);c.set.call(this,a)}}}};b.positiveNumber=function(g){return function(c){return{get:function(){var a=c.get.call(this);return 0>a?g:a},set:function(a){if(0>
a)throw new RangeError("Value is negative number");c.set.call(this,a)}}}};h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-propertybuilder",selector:h(n),adapter:function(){return b}})})(window,Granite.$);
(function(n,h,b){function g(d){this.el=d.el;this._$el=b(this.el);this._selector=d.selector;this._validate=d.validate||function(){return!0};this._perform=d.perform||b.noop;a++;this._ns=".foundation-util-gesture-longpress-pointer-"+a;this._destroyed=!1}var c=b(h),a=0;g.prototype.start=function(){if(this._destroyed)throw Error("Illegal state: this class is already destroyed");if(navigator.pointerEnabled)this._$el.on("pointerdown"+this._ns,this._selector,this._handlePointerEvent.bind(this));else this._$el.on("touchstart"+
this._ns,this._selector,this._handleTouchEvent.bind(this))};g.prototype._handlePointerEvent=function(d){if(0===d.originalEvent.button&&d.originalEvent.isPrimary&&this._validate()){var e=d.originalEvent.clientX,f=d.originalEvent.clientY,m=d.currentTarget,p=this,k=setTimeout(function(){c.off(p._ns);p._perform(m)},500),t=function(){clearTimeout(k);c.off(p._ns)};c.on("pointermove"+this._ns,function(l){(10<Math.abs(l.originalEvent.clientX-e)||10<Math.abs(l.originalEvent.clientY-f))&&t()}).on("pointerup"+
this._ns,t).on("pointercancel"+this._ns,t)}};g.prototype._handleTouchEvent=function(d){if(!(1<d.originalEvent.touches.length)&&this._validate()){var e=d.originalEvent.touches[0];e={x:e.clientX,y:e.clientY};var f=d.currentTarget,m=this,p=setTimeout(function(){c.off(m._ns);m._perform(f)},500),k=function(){clearTimeout(p);c.off(m._ns)};c.on("touchmove"+this._ns,function(t){t=t.originalEvent.touches[0];(10<Math.abs(t.clientX-e.x)||10<Math.abs(t.clientY-e.y))&&k()}).on("touchend"+this._ns,k).on("touchcancel"+
this._ns,k)}};g.prototype.destroy=function(){this._destroyed=!0;this._$el.off(this._ns)};b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-gesture-longpress",selector:b(n),adapter:function(){return g}})})(window,document,Granite.$);
(function(n,h){function b(g,c,a){if(!a)throw Error("Error saving user preferences: action param is missing");c.forEach(function(d){g[d+"@Delete"]=""});h.post({url:a,data:g}).fail(function(d,e,f){console.error("Error saving user preferences:",e,f)})}h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-preference",selector:h(n),adapter:function(){var g=h("meta[name\x3d'user.preferences']",document.head),c=g.attr("data-foundation-preference-action"),a={};try{a=JSON.parse(g.prop("content"))}catch(d){}return{_setAction:function(d){c=
d},names:function(){return Object.keys(a)},get:function(d){return a[d]},getBoolean:function(d,e){d=this.get(d);return void 0!==e&&void 0===d?e:"boolean"===typeof d?d:"true"===d?!0:"false"===d?!1:!!d},getNumber:function(d,e){d=this.get(d);if("number"===typeof d)return d;e=void 0===e?0:e;d=Number(d).valueOf();return isNaN(d)?e:d},set:function(d,e){var f=new Map;f.set(d,e);this.setAll(f)},setAll:function(d){var e={},f=[];d.forEach(function(m,p){void 0===m?(delete a[p],f.push(p)):(a[p]=m,e[p]=m)});h(document).trigger("foundation-preference-change");
b(e,f,c)}}}})})(window,Granite.$);(function(n,h){var b=Granite.UI.Foundation.Utils.everyReverse,g=h(n).adaptTo("foundation-registry");g.register("foundation.adapters",{type:"foundation-response-parser",selector:h(n),adapter:function(){return{parse:function(c){var a,d=c.getResponseHeader("content-type");if(!d)return c.responseText;b(g.get("foundation.response.parser"),function(e){if(!d.match(e.contentType))return!0;e=e.handler(c);if(!1===e)return!0;a=e;return!1});return a}}}})})(window,Granite.$);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.response.parser",{name:"foundation.json",contentType:/application\/json/,handler:function(b){return JSON.parse(b.responseText)}})})(window,Granite.$);(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.response.parser",{name:"foundation.html",contentType:/text\/html/,handler:function(b){return h(n).adaptTo("foundation-util-htmlparser").createFragment(b.responseText)}})})(window,Granite.$);
(function(n,h,b,g){function c(l,q){for(var r=l.length-1;0<=r;r--){var z=l[r];if(z.submittable&&q.is(z.submittable))return z}}function a(l,q){this.el=l;this.selectorConfig=q;this.$el=b(l);this.customMessage=this.message=null;this.isValidated=!1;this.state=function(r){return{getCustomError:function(){return!!r.customMessage},isValid:function(){return!r.customMessage&&!r.message},isValidated:function(){return r.isValidated}}}(this)}function d(l){return l.reduceRight(function(q,r){r.submittable&&q.push(r.submittable);
return q},[]).join(",")}function e(l,q){return l.some(function(r){return r.exclusion?q.is(r.exclusion):!1})}function f(l){return b(l.adaptTo("foundation-validation-helper").getSubmittables()).map(function(){var q=b(this).adaptTo("foundation-validation");if(!q.checkValidity({suppressEvent:!0}))return{el:this,api:q}}).map(function(){var q=b.Event("foundation-validation-invalid");b(this.el).trigger(q);if(!q.isDefaultPrevented())return this})}function m(l){l=f(l);return 0<l.length?(l.each(function(){this.api.updateUI()}),
l[0].el.focus(),!1):!0}var p=g.UI.Foundation.Utils.everyReverse,k=b(n).adaptTo("foundation-registry");a.prototype={willValidate:function(){if(!this.selectorConfig){var l=k.get("foundation.validation.selector");this.selectorConfig=c(l,this.$el)}return(l=this.selectorConfig.candidate)&&this.$el.is(l)},setCustomValidity:function(l){this.customMessage=l},getValidity:function(){return this.state},checkValidity:function(l){l=l||{};if(!this.willValidate())return this.customMessage=this.message=null,this.isValidated=
!0,l.suppressEvent||this.$el.trigger("foundation-validation-valid"),!0;this.isValidated=!0;if(this.customMessage)return l.suppressEvent||this.$el.trigger("foundation-validation-invalid"),!1;this.message=null;p(k.get("foundation.validation.validator"),function(q){return q.validate&&this.$el.is(q.selector)?(q=q.validate(this.el))?(this.message=q,!1):!0:!0},this);if(this.message)return l.suppressEvent||this.$el.trigger("foundation-validation-invalid"),!1;l.suppressEvent||this.$el.trigger("foundation-validation-valid");
return!0},getValidationMessage:function(){return this.willValidate()?this.customMessage||this.message||"":""},updateUI:function(){if("none"!==this.el.dataset.foundationValidationUi){var l=this.getValidity().isValid()?function(q){if(!q.clear||!this.$el.is(q.selector))return!0;var r=!1;q.clear(this.el,{next:function(){r=!0}});return r}:function(q){if(!q.show||!this.$el.is(q.selector))return!0;var r=!1;q.show(this.el,this.getValidationMessage(),{next:function(){r=!0}});return r};p(k.get("foundation.validation.validator"),
l,this)}}};var t=new WeakMap;b.extend(b.expr[":"],{"-foundation-submittable":function(l){if(t.has(l))return t.get(l).isSubmittable;var q=b(l),r=k.get("foundation.validation.selector"),z=c(r,q),u=!1;z&&(u=!e(r,q));t.set(l,{isSubmittable:u,selectorConfig:z});return u}});k.register("foundation.adapters",{type:"foundation-validation",selector:":-foundation-submittable",adapter:function(l){return new a(l,t.get(l).selectorConfig)}});k.register("foundation.adapters",{type:"foundation-validation-helper",
selector:"*",adapter:function(l){return{getSubmittables:function(){var q=k.get("foundation.validation.selector");return b(l).find(d(q)).filter(function(){var r=!e(q,b(this));t.set(this,{isSubmittable:r});return r}).toArray()},isValid:function(){return this.getSubmittables().every(function(q){q=b(q).adaptTo("foundation-validation");var r=q.getValidity();return r.isValidated()?r.isValid():q.checkValidity({suppressEvent:!0})})}}}});h.addEventListener("submit",function(l){var q=b(l.target);if(q.is("form")&&
!0!==q.prop("noValidate")&&(void 0!==q.prop("noValidate")||void 0===q.attr("novalidate"))){var r=q.data("foundation-validation-bind.internal.valid");(void 0!==r?r:m(q))||(l.stopPropagation(),l.preventDefault())}},!0)})(window,document,Granite.$,Granite);
(function(n,h,b,g){function c(f){n.console&&1>d&&(d++,console.warn("@deprecated ",f,"; use foundation-validation"))}function a(f){var m=f.validate;m&&(f.validate=function(t){return m(b(t))});var p=f.show;p&&(f.show=function(t,l,q){p(b(t),l)===b.validator.CONTINUE&&q.next()});var k=f.clear;k&&(f.clear=function(t,l){k(b(t))===b.validator.CONTINUE&&l.next()});return f}var d=0;b.extend(b.expr[":"],{submittable:function(f){c(":submittable");return b(f).is(":-foundation-submittable")}});b.fn.willValidate=
function(){c("$.fn.willValidate");var f=this.adaptTo("foundation-validation");return f?f.willValidate():!1};b.fn.validationMessage=function(){c("$.fn.validationMessage");var f=this.adaptTo("foundation-validation");return f?f.getValidationMessage():""};b.fn.checkValidity=function(){c("$.fn.checkValidity");var f=this.adaptTo("foundation-validation");return f?f.checkValidity():!0};b.fn.setCustomValidity=function(f){c("$.fn.setCustomValidity");return this.each(function(){var m=b(this).adaptTo("foundation-validation");
m&&m.setCustomValidity(f)})};b.fn.updateErrorUI=function(){c("$.fn.updateErrorUI");return this.each(function(){var f=b(this).adaptTo("foundation-validation");f&&f.updateUI()})};var e=b(n).adaptTo("foundation-registry");b.validator={CONTINUE:1,STOP:2,register:function(){c("$.validator");b.each(arguments,function(){e.register("foundation.validation.validator",a(this))})},isValid:function(f,m){c("$.validator");return f.adaptTo("foundation-validation-helper").getSubmittables().every(function(p){p=b(p).adaptTo("foundation-validation");
var k=p.getValidity();return k.isValidated()?k.isValid():p.checkValidity({suppressEvent:m})})}};b(h).on("foundation-validation-valid",function(f){b(f.target).trigger("valid")});b(h).on("foundation-validation-invalid",function(f){var m=b.Event("invalid",{isJqueryValidator:!0});b(f.target).trigger(m);m.isDefaultPrevented()&&f.preventDefault()})})(window,document,Granite.$,Granite);
(function(n,h){function b(c){var a=c.find(".foundation-validation-bind"),d=c.prop("id");d&&(a=a.add(h(".foundation-validation-bind[form]").filter(function(){return h(this).attr("form")===d})));return a}function g(c){var a=b(c);if(a.length){var d=c.adaptTo("foundation-validation-helper").isValid();c.data("foundation-validation-bind.internal.valid",d);a.prop("disabled",!d)}}h(n).on("foundation-validation-invalid","form",function(c){var a=h(this);b(a).prop("disabled",!0);c=c.target;var d=a.data("foundation-validation-bind.internal.invalids");
void 0===d&&(d=[],a.data("foundation-validation-bind.internal.invalids",d));0>d.indexOf(c)&&d.push(c)});h(n).on("foundation-validation-valid","form",function(c){var a=h(this),d=a.data("foundation-validation-bind.internal.invalids");if(d)if(c=d.indexOf(c.target),0<=c&&d.splice(c,1),0===d.length)g(a);else{c=!1;for(var e=d.length;e--;){if(a.has(d[e]).length){c=!0;break}d.splice(e,1)}c||g(a)}else g(a)})})(document,Granite.$);
(function(n,h,b,g){function c(d,e){return d?d.match(new RegExp("(^|\\s+)"+e+"(\\s+|$)"),"g")?d:d+" "+e:e}function a(d){if(d&&d.getLabelledBy)return d.getLabelledBy()}n=b(n).adaptTo("foundation-registry");n.register("foundation.validation.validator",{selector:"*",show:function(d,e){var f=b(d),m=f.adaptTo("foundation-field");m&&m.setInvalid&&m.setInvalid(!0);var p=f.data("foundation-validation.internal.error");p?(p.content.innerHTML=e,p.parentNode||(f.after(p),p.show(),d=c(a(m),p.id),m&&m.setLabelledBy&&
m.setLabelledBy(d))):(p=new g.Tooltip,p.variant="error",p.interaction="off",p.placement="top",p.target=d,p.content.innerHTML=e,p.open=!0,p.id=g.commons.getUID(),f.data("foundation-validation.internal.error",p),f.after(p),d=c(a(m),p.id),m&&m.setLabelledBy&&m.setLabelledBy(d))},clear:function(d){var e=b(d);(d=e.adaptTo("foundation-field"))&&d.setInvalid&&d.setInvalid(!1);var f=e.data("foundation-validation.internal.error");f&&(f.hide(),f.remove(),(e=a(d))&&-1!==e.indexOf(f.id)&&(e=e.split(" ").filter(function(m){return m!==
f.id}).join(" "),d&&d.setLabelledBy&&d.setLabelledBy(e)))}});n.register("foundation.validation.selector",{exclusion:".foundation-field-mixed"});n.register("foundation.validation.selector",{exclusion:".foundation-field-related"})})(window,document,Granite.$,Coral);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.validation.validator",{selector:"[data-foundation-validation~\x3d'foundation.jcr.name'],[data-validation~\x3d'foundation.jcr.name']",validate:function(g){g=g.value;for(var c=0,a=g.length;c<a;c++)if(0<='%/\\:*?"[]|\n\t\r. '.indexOf(g[c])||127<g.charCodeAt(c))return b.I18n.get("Invalid character '{0}'. It must be a valid JCR name.",[g[c]])}})})(window,Granite.$,Granite);
(function(n,h,b){var g=Granite.UI.Foundation.Time;g?(g.relative=b(n).adaptTo("foundation-preference").get("relativeDateCutoff"),g.locale=h.documentElement.lang||n.navigator.userLanguage||n.navigator.language):console.warn("Granite.UI.Foundation.Time is not available; no setting is set")})(window,document,Granite.$);
(function(n,h,b,g,c,a){function d(){var k=Reflect.construct(HTMLElement,[],this.constructor);k._construct();return k}function e(k){return k?"#"===k[0]?b.when(h.querySelector(k)):b.ajax({url:k,cache:!1}).then(function(t){return b(n).adaptTo("foundation-util-htmlparser").parse(t)}).then(function(t){return b(t).children()[0]}):b.Deferred().reject().promise()}function f(k){return{setName:function(t){k.setAttribute("name",t)},setDisabled:function(t){k.disabled=t},setReadOnly:function(t){k.readOnly=t},
getValues:function(){return k.items.getAll().map(function(t){return{value:t.value,text:t.label.textContent,isUserDefined:t.hasAttribute("data-foundation-autocomplete-value-userdefined")}})},setValues:function(t){k.items.clear();this.appendValues(t)},appendValues:function(t){t.forEach(function(l){var q=(new g.Tag).set({closable:!0,value:l.value,label:{textContent:l.text}});l.isUserDefined&&q.setAttribute("data-foundation-autocomplete-value-userdefined","");if(l.data)for(var r in l.data)if(l.data.hasOwnProperty(r)){var z=
r,u=r.charAt(0);u!==u.toUpperCase()&&(z=u.toUpperCase(),1<r.length&&(z+=r.substr(1)));q.dataset["foundationAutocompleteCustom"+z]=l.data[r]}k.items.add(q)})}}}var m=0<=n.navigator.userAgent.indexOf("Trident/7.0"),p=b(n).adaptTo("foundation-util-propertybuilder");d.prototype=Object.create(HTMLElement.prototype);d.prototype.constructor=d;Object.defineProperties(d.prototype,{field:{get:function(){return this._input}},delay:(new p(p.createAttrBasedProperty("delay"))).mix(p.integerType(500)).mix(p.positiveNumber(500)).build(),
pickerSrc:p.createAttrBasedProperty("pickersrc"),valueDisplayMode:p.createAttrBasedProperty("valuedisplaymode","inline"),variant:p.createAttrBasedProperty("variant"),name:p.createAttrBasedProperty("name",""),placeholder:p.createAttrBasedProperty("placeholder",""),labelledBy:p.createAttrBasedProperty("labelledby",""),labelled:p.createAttrBasedProperty("labelled",c.I18n.get("Open Selection Dialog")),disabled:p.createBooleanAttrBasedProperty("disabled"),readOnly:p.createBooleanAttrBasedProperty("readonly"),
invalid:p.createBooleanAttrBasedProperty("invalid"),required:p.createBooleanAttrBasedProperty("required"),multiple:p.createBooleanAttrBasedProperty("multiple"),forceSelection:p.createBooleanAttrBasedProperty("forceselection"),droppable:p.createBooleanAttrBasedProperty("droppable"),value:{get:function(){return this.multiple?this.values[0]:this.values[0]||""},set:function(k){this.values=[k]}},values:{get:function(){return this._getValueAPI(function(k){return k.getValues().map(function(t){return t.value})})},
set:function(k){var t=this;this._getValueAPI(function(l){var q=k.map(function(r){return{value:r,text:r}});t.multiple?l.setValues(q):l.setValues(0<q.length?[q[0]]:[]);t._validate()})}}});d.prototype._construct=function(){var k=this,t=b(this);this._render();var l;m?this._input.addEventListener("keydown",function(r){clearTimeout(l);l=setTimeout(k._onUserInput.bind(k),k.delay)}):this._input.addEventListener("input",function(r){clearTimeout(l);l=setTimeout(k._onUserInput.bind(k),k.delay)});this._input.addEventListener("keydown",
function(r){switch(r.keyCode){case 38:case 40:r.preventDefault();clearTimeout(l);k._suggestion.open?k._focus(k._suggestion,38===r.keyCode):k._onUserInput();break;case 27:r.preventDefault();k._suggestion.open&&r.stopPropagation();clearTimeout(l);k._cancelSuggestion();break;case 9:clearTimeout(l);k._cancelSuggestion();break;case 13:(k._suggestion.open||"inline"!==k.valueDisplayMode&&""!==k._input.value)&&r.preventDefault(),clearTimeout(l),r=k._input.value.trim(),r.length&&k._appendValue(r).then(function(){k._cancelSuggestion();
k._input.value=""})}});this._input.addEventListener("blur",function(r){k.multiple||(r=k._input.value,""!==r&&r.trim()!==r&&k._appendValue(k._input.value.trim(),!0).then(function(){k._cancelSuggestion()}));!k.multiple&&k.forceSelection&&k._getValueAPI(function(z){z=z.getValues();k._input.value=z.length?z[0].text:""})});t.on("foundation-assetdropped",".foundation-autocomplete-droppable",function(r){r.preventDefault();r.stopPropagation();k._appendValue(r.path,!0)});t.on("change","coral-taglist[foundation-autocomplete-value]",
function(r){k._onValueChangeByUser()});t.on("coral-collection:remove","coral-taglist[foundation-autocomplete-value]",function(r){k.classList.contains("foundation-field-mixed")&&(r=r.originalEvent.detail.item,r.value.startsWith("+")||k._removedValuesWhenMixed.push(r.value))});t.on("change foundation-field-change",function(r){r.target!==k&&r.stopImmediatePropagation()});this._button.addEventListener("click",function(r){r.preventDefault();k._togglePicker()});this._suggestion={el:null,open:!1,api:null};
this._value={el:null,api:null};this._picker={el:null,open:!1,loading:!1,api:null};this._removedValuesWhenMixed=[];this._setupValueObserver();t=this.attributes;for(var q=0;q<t.length;q++)this.attributeChangedCallback(t[q].name,void 0,t[q].value)};d.prototype._render=function(){for(var k=0;k<this.children.length;k++){var t=this.children[k];t.classList.contains("foundation-autocomplete-inputgroupwrapper")&&this.removeChild(t)}this._inputGroup=h.createElement("div");this._inputGroup.classList.add("coral-InputGroup");
this._inputGroup.setAttribute("role","presentation");this._input=new g.Textfield;this._input.classList.add("coral-InputGroup-input");this._input.autocomplete="off";this._input.placeholder=this.placeholder;this._input.labelledBy=this.labelledBy;this._input.setAttribute("role","combobox");this._input.setAttribute("aria-expanded",!1);this.droppable&&this._input.classList.add("foundation-autocomplete-droppable");k=h.createElement("span");k.classList.add("coral-InputGroup-button");this._button=(new g.Button).set({icon:"FolderOpenOutline",
title:this.labelled,type:"button"});this._button.setAttribute("aria-label",this.labelled);k.appendChild(this._button);this._inputGroup.appendChild(this._input);this._inputGroup.appendChild(k);this._inputGroupWrapper=h.createElement("div");this._inputGroupWrapper.classList.add("foundation-autocomplete-inputgroupwrapper");this._inputGroupWrapper.appendChild(this._inputGroup);this.insertBefore(this._inputGroupWrapper,this.firstChild);this._onVariantChange()};d.prototype.attributeChangedCallback=function(k,
t,l){if("pickersrc"===k)this._picker.el=null;else if("variant"===k)this._onVariantChange();else if("name"===k)this._getValueAPI(function(z){z.setName(l)});else if("placeholder"===k)this._input.setAttribute("placeholder",l),this._input.setAttribute("aria-label",l);else if("labelledby"===k)this._input.setAttribute("labelledby",l);else if("labelled"===k)this._button.setAttribute("aria-label",l);else if("disabled"===k){var q=null!==l;this._input.disabled=q;this._button.disabled=q;this._getValueAPI(function(z){z.setDisabled(q)})}else if("readonly"===
k){var r=null!==l;this._input.readOnly=r;this._button.disabled=r;this._getValueAPI(function(z){z.setReadOnly(r)})}else"invalid"===k?this._input.invalid=null!==l:"required"===k&&this._input.setAttribute("aria-required",null!==l)};d.prototype.focus=function(){requestAnimationFrame(function(){this._input.focus()}.bind(this))};d.prototype.clear=function(){this.values=[];this._input&&requestAnimationFrame(function(){this._input.value=""}.bind(this))};d.prototype._setupValueObserver=function(){var k=this,
t=[this._handleInputSize(),this._handleSingleSelectionMode()],l=function(){k._getValueAPI(function(){t.forEach(function(q){q.perform.call(k)})})};l();(new MutationObserver(function(q){q.forEach(function(r){b(r.addedNodes).filter("[foundation-autocomplete-value]").each(function(){l()})})})).observe(this,{childList:!0})};d.prototype._handleInputSize=function(){var k=function(l){var q=b(this._input);this.multiple&&"inline"===this.valueDisplayMode?l?(l=b(l).outerWidth(!0),q.css("padding-left",l)):q.css("padding-left",
""):q.css("padding-left","")}.bind(this),t=function(l){k(this)};return{perform:function(){g.commons.addResizeListener(this._value.el,t)},destroy:function(){k();g.commons.removeResizeListener(this._value.el,t)}}};d.prototype._handleSingleSelectionMode=function(){var k=function(){var l=this._value.el.items.getAll()[0];l&&(this._input.value=l.value)}.bind(this),t;return{perform:function(){this.multiple||requestAnimationFrame(function(){k()});t=new MutationObserver(function(l){this.multiple||l.forEach(function(q){b(q.addedNodes).filter("coral-tag").length&&
k()})}.bind(this));t.observe(this._value.el,{childList:!0})},destroy:function(){t.disconnect()}}};d.prototype._onVariantChange=function(){"omnisearch"===this.variant?(this._input.variant="quiet",this._button.variant="quiet",this._inputGroup.classList.add("coral-InputGroup--quiet")):(this._input.variant=g.Textfield.variant.DEFAULT,this._button.variant=g.Button.variant.DEFAULT,this._inputGroup.classList.remove("coral-InputGroup--quiet"))};d.prototype._onUserInput=function(){var k=this;this.multiple||
this._appendValue(this._input.value,!0);var t=function(l){k._input.value=l};this._getSuggestionAPI(function(l){var q=this._getValueAPI(function(r){return r.getValues()},function(){return[]});l.pick(k,q,k._input.value,t).then(function(r){k._suggestion.open=!1;k._input.value="";k._input.focus();k._setSelections(r)},function(){k._suggestion.open=!1});k._suggestion.open=!0})};d.prototype._onValueChangeByUser=function(k){var t=this;k?this._deferChangeEvent||(this._deferChangeEvent=!0,b(this._input).on("focusout",
function r(q){b(t._input).off("focusout",r);t._deferChangeEvent=null;q.relatedTarget&&t.contains(q.relatedTarget)&&q.relatedTarget.hasAttribute("coral-list-item")||(t._validate(),t._triggerChangeEvent())})):(this._triggerChangeEvent(),this._validate())};d.prototype._triggerChangeEvent=function(){var k=h.createEvent("HTMLEvents");k.initEvent("change",!0,!1);this.dispatchEvent(k);b(this).trigger("foundation-field-change")};d.prototype._getSuggestionAPI=function(k,t){if(!this._suggestion.api){var l=
b(this).children("[foundation-autocomplete-suggestion]").first();if(!l.length){if(t)return t.call(this);return}this._suggestion.el=l[0];this._suggestion.api=l.adaptTo("foundation-picker")}return k.call(this,this._suggestion.api)};d.prototype._getValueAPI=function(k,t){if(!this._value.api){var l=b(this).children("[foundation-autocomplete-value]").first();if(!l.length){if(t)return t.call(this);return}this._value.el=l[0];this._value.api=f(l[0])}return k.call(this,this._value.api)};d.prototype._focus=
function(k,t){"focus"in k.api?k.api.focus(t):k.el.focus()};d.prototype._validate=function(){var k=b(this).adaptTo("foundation-validation");k&&(k.checkValidity(),k.updateUI())};d.prototype._setSelections=function(k,t){var l=this;l._getValueAPI(function(q){l.multiple?l.classList.contains("foundation-field-mixed")?q.appendValues(k.map(function(r){var z=l._removedValuesWhenMixed.indexOf(r.value);0<=z?l._removedValuesWhenMixed.splice(z,1):r.value="+"+r.value;return r})):q.appendValues(k):k.length?q.setValues([k[0]]):
q.setValues([]);l._onValueChangeByUser(t)})};d.prototype._cancelSuggestion=function(){var k=this;k._suggestion.open&&this._getSuggestionAPI(function(t){t.cancel();k._suggestion.open=!1})};d.prototype._appendValue=function(k,t){var l=this;if(!this.multiple&&0===k.length)return this._setSelections([],t),b.when();var q=b.Deferred();this._getSuggestionAPI(function(r){r.resolve([k]).then(function(z){null!==z[0]?(l._setSelections(z,t),q.resolve()):l.forceSelection||(l._setSelections([{value:k,text:k,isUserDefined:!0}],
t),q.resolve())})},function(){if(l.forceSelection)return q.reject();l._setSelections([{value:k,text:k,isUserDefined:!0}],t);q.resolve()});return q.promise()};d.prototype._resolvePickerSrc=function(){var k=this._getValueAPI(function(l){return l.getValues()},function(){return[]}),t={value:""};0<k.length&&(t.value=k[k.length-1].value);this._resolvedPickerSrc=a.expand(this.pickerSrc,t)};d.prototype._loadAndShowPicker=function(){var k=this;this._picker.loading=!0;this._resolvePickerSrc();e(this._resolvedPickerSrc).then(function(t){k._picker.loading=
!1;k._picker.el=t;k._picker.api=b(t).adaptTo("foundation-picker");k._showPicker()},function(){k._picker.loading=!1})};d.prototype._togglePicker=function(){this._picker.loading||(this._picker.el?this._picker.open?(this._picker.api.cancel(),this._onCancelPicker()):this._loadAndShowPicker():this._loadAndShowPicker())};d.prototype._showPicker=function(){var k=this,t=this._picker.api;t.attach(this);var l=this._getValueAPI(function(q){return q.getValues()},function(){return[]});t.pick(this,l,this._input.value).then(function(q){k._picker.api.detach();
k._picker.open=!1;k._input.setAttribute("aria-expanded",!1);k._input.focus();k._setSelections(q)},function(){k._onCancelPicker()});this._focus(this._picker);this._picker.open=!0;this._input.setAttribute("aria-expanded",!0)};d.prototype._onCancelPicker=function(){this._picker.api.detach();this._picker.open=!1;this._input.setAttribute("aria-expanded",!1);this._input.focus()};d.observedAttributes="pickersrc variant name placeholder labelledby labelled disabled readonly invalid required".split(" ");n.customElements.define("foundation-autocomplete",
d);p=b(n).adaptTo("foundation-registry");p.register("foundation.adapters",{type:"foundation-overlay-anchor",selector:"foundation-autocomplete",adapter:function(k){return{getElement:function(){return k._inputGroupWrapper}}}});p.register("foundation.validation.selector",{submittable:"foundation-autocomplete",candidate:"foundation-autocomplete:not([readonly]):not([disabled])",exclusion:"foundation-autocomplete *"});p.register("foundation.validation.validator",{selector:"foundation-autocomplete",validate:function(k){if(k.required&&
(k.multiple&&0===k.values.length||!k.multiple&&0===k.value.length))return c.I18n.get("Please fill out this field.")}});p.register("foundation.adapters",{type:"foundation-field",selector:"foundation-autocomplete",adapter:function(k){var t=b(k);return{getName:function(){return k.name},setName:function(l){t.children(".foundation-field-related").each(function(){this.name.startsWith(k.name+"@")&&(this.name=l+this.name.substring(k.name.length))});k.name=l},isDisabled:function(){return k.disabled},setDisabled:function(l){k.disabled=
l;t.children(".foundation-field-related:not(.foundation-field-mixed-patchcontrol)").prop("disabled",l)},isInvalid:function(){return k.invalid},setInvalid:function(l){k.invalid=l},isRequired:function(){return k.required},setRequired:function(l){k.required=l},getValue:function(){return k.value},setValue:function(l){k.value=l},getLabelledBy:function(){return k.labelledBy},setLabelledBy:function(l){k.labelledBy=l},getLabelled:function(){return k.labelled},setLabelled:function(l){k.labelled=l},getValues:function(){return k.values},
setValues:function(l){k.values=l},clear:function(){k.clear()}}}});p.register("foundation.form.submit",{selector:"*",handler:function(k){var t=[];b(k).find("foundation-autocomplete.foundation-field-mixed").each(function(){var l=this;l._removedValuesWhenMixed.forEach(function(q){var r=h.createElement("input");r.type="hidden";r.name=l.name;r.value="-"+q;l.appendChild(r);t.push(function(){l.removeChild(r)})});t.push(function(){l._removedValuesWhenMixed=[]})});return{post:function(){t.forEach(function(l){l()});
return b.when()}}}})})(window,document,Granite.$,Coral,Granite,Granite.URITemplate);(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.form.submit",{selector:"*",handler:function(b){var g=h(b).find("coral-datepicker \x3e input[type\x3d'hidden']");b={post:function(){g.each(function(){this.name.endsWith("@Delete")&&(this.name=this.name.substr(0,this.name.lastIndexOf("@Delete")))})}};b.post();g.each(function(){""===this.value&&(this.name+="@Delete")});return b}})})(window,Granite.$);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection",selector:".foundation-collection",adapter:function(b){var g=h(b);return{append:function(c){g.append(c);g.trigger("foundation-contentloaded")},clear:function(){g.find(".foundation-collection-item").remove()}}}})})(window,Granite.$);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-selections",selector:".foundation-collection",adapter:function(b){var g=h(b);return{count:function(){return g.find(".foundation-selections-item").length},selectAll:function(c){var a=g.find(".foundation-collection-item:not(.foundation-selections-item)").addClass("foundation-selections-item").length;!c&&a&&g.trigger("foundation-selections-change")},clear:function(c){var a=g.find(".foundation-selections-item").removeClass("foundation-selections-item").length;
!c&&a&&g.trigger("foundation-selections-change")},select:function(c){c=h(c);c.is(".foundation-collection-item")&&(c.toggleClass("foundation-selections-item",!0),g.trigger("foundation-selections-change"))},deselect:function(c){c=h(c);c.is(".foundation-collection-item")&&(c.toggleClass("foundation-selections-item",!1),g.trigger("foundation-selections-change"))},isAllSelected:function(){var c=g.find(".foundation-collection-item").length;return 0<c?c===this.count():!1}}}})})(window,Granite.$);
(function(n,h,b){b(h).on("foundation-selections-change",".foundation-collection[role\x3dlistbox]",function(g){var c=b(this);c.find(".foundation-collection-item").each(function(){var a=b(this),d=a.is(".foundation-selections-item");a.attr("aria-selected",d);c.hasClass("aria-skiphandling")||(a=a.find("input.aria-value[type\x3dhidden]"),a.prop("disabled",!d),(d=c.data("aria-name"))&&!a.prop("name")&&a.prop("name",d),a.length&&n.console&&console.log("@deprecated .aria-value, [data-aria-name]; please use .foundation-advancedselect instead."))});
if(g=c.adaptTo("foundation-validation"))g.checkValidity(),g.updateUI()})})(window,document,Granite.$);
(function(n,h,b){function g(l,q){q?l.removeClass("foundation-collection-action-hidden"):l.addClass("foundation-collection-action-hidden")}function c(l,q){return 0===q&&0===l||0<q&&"\x3e0"===l?!0:!1}function a(l,q){return 0===q&&"none"===l||1===q&&"single"===l||1<=q&&("multiple"===l||"bulk"===l)?!0:!1}function d(l,q,r,z){if("none"===z)return!0;if("item"===z)return q=r.toArray().map(function(u){u=h(u).find(".foundation-collection-quickactions").data("foundationCollectionQuickactionsRel")||"";u=u.trim();
return u.length?u.split(/\s+/):[]}),q.every(function(u){return 0===u.length})?!0:q.every(function(u){return!u.every(function(w){return!l.hasClass(w)})});q=q.adaptTo("foundation-collection-meta");if(!q)return!0;q=q.getRelationship()||"";q=q.trim();q=q.length?q.split(/\s+/):[];return 0===q.length?!0:q.some(function(u){return l.hasClass(u)})}function e(l,q,r,z,u){var w=!0;"activeCount"in q&&(w=c(q.activeCount,z.length));w&&"activeSelectionCount"in q&&(w=a(q.activeSelectionCount,u.length));w&&"activeCondition"in
q&&b.UI.Foundation.Utils.everyReverse(t.get("foundation.collection.action.activecondition"),function(A){if(A.name!==q.activeCondition)return!0;A=A.handler.call(l[0],A.name,l[0],q,r[0],u.toArray());return!1===A||!0===A?(w=A,!1):!0});w&&(w=d(l,r,u,q.ignoreRel?"none":q.relScope||"item"));return w}function f(l,q){q=q.target;q||(l=l.closest(".foundation-collection-actionbar"),l.length&&(q=l[0].dataset.foundationCollectionActionbarTarget));return q}function m(l){l=h(l);var q=l.adaptTo("foundation-collection");
return q.isAllLoaded?q.isAllLoaded():(q=q.getPagination())?0<l.find(".foundation-collection-item").find(".is-lazyloaded, .is-pending").length?!1:!1===q.hasNext:!0}function p(l){var q=h(l),r=q.adaptTo("foundation-collection").getPagination(),z=q.adaptTo("foundation-selections").count();if(!r||-1===r.guessTotal||m(l))return z;if(-1!==r.guessTotal)return(r=h("granite-pagingstatus").get().find(function(u){if(l.matches(u.dataset.graniteCollectionPagingstatusTarget))return!0}))?parseInt(r.getAttribute("current")||
z,10):q.find(".foundation-selections-item:not(.is-lazyLoaded):not(.is-pending)").length}var k=new WeakMap,t=h(window).adaptTo("foundation-registry");n.addEventListener("click",function(l){var q=h(l.target).closest(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)");if(0!==q.length){var r=q.data("foundationCollectionAction")||{},z=f(q,r);z&&(z=b.UI.Foundation.Utils.sanitizeHtml(z),z=h(z)[0],k.has(q[0])&&k.get(q[0])||"true"!==z.dataset.foundationSelectionsSelectallMode||
"bulk"===r.activeSelectionCount||m(z)||(l.stopImmediatePropagation(),l=h(window).adaptTo("foundation-ui"),r=b.I18n.get("Bulk Action Not Supported"),z=b.I18n.get("The selected action \x3cb\x3e{0}\x3c/b\x3e will only have effect on the \x3cb\x3e{1}\x3c/b\x3e selected items currently loaded.\x3cbr/\x3eIf you wish to apply it to non-loaded items, please make sure they are explicitly selected.",[q.text(),p(z)]),l.prompt(r,z,"warning",[{id:"cancel",text:b.I18n.get("Cancel")},{id:"continue",text:b.I18n.get("Continue"),
primary:!0,handler:function(){k.set(q[0],!0);q[0].click()}}])))}},!0);h(n).on("foundation-contentloaded",function(l){var q=new Map;h(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)",l.target).each(function(){var r=h(this),z=r.data("foundationCollectionAction")||{},u=f(r,z);if(u){if(q.has(u)){u=q.get(u);var w=u.collection;var A=u.items;var x=u.selections}else w=b.UI.Foundation.Utils.sanitizeHtml(u),w=h(w),A=w.find(".foundation-collection-item"),x=A.filter(".foundation-selections-item"),
q.set(u,{collection:w,items:A,selections:x});w.length&&g(r,e(r,z,w,A,x))}})});h(n).on("foundation-selections-change",".foundation-collection",function(l){var q=h(this),r,z;h(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)").each(function(){var u=h(this),w=u.data("foundationCollectionAction")||{},A=f(u,w);A&&q.is(A)&&(r||(r=q.find(".foundation-collection-item"),z=r.filter(".foundation-selections-item")),g(u,e(u,w,q,r,z)))})});h(n).on("click",".foundation-collection-action",
function(l){k.delete(this);var q=h(this),r=q.data("foundationCollectionAction");if(r&&r.action){var z=h(),u=[],w=q.data("foundationCollectionItem");w?(z=h(w).closest(".foundation-collection"),u=[w]):r.target?(w=b.UI.Foundation.Utils.sanitizeHtml(r.target),z=h(w),u=z.find(".foundation-selections-item").toArray()):(w=q.closest(".foundation-collection-item, .foundation-collection-actionbar"),w.hasClass("foundation-collection-actionbar")?(z=h(w[0].dataset.foundationCollectionActionbarTarget),u=z.find(".foundation-selections-item").toArray()):
w.hasClass("foundation-collection-item")&&(z=w.closest(".foundation-collection"),u=w.toArray()));b.UI.Foundation.Utils.everyReverse(t.get("foundation.collection.action.action"),function(A){if(A.name!==r.action)return!0;(A=!1===A.handler.call(q[0],A.name,q[0],r,z[0],u))||l.preventDefault();return A})}})})(document,Granite.$,Granite);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.link",handler:function(g,c,a,d,e){g=b.expand(a.data.href,{id:d.dataset.foundationCollectionId,item:e.map(function(f){return f.dataset.foundationCollectionItemId})});"null"!==(new URL(g,document.baseURI)).origin&&(a.data.target?n.open(g,a.data.target):n.location=g)}})})(window,Granite.$,Granite.URITemplate);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.pushstate",handler:function(g,c,a,d,e){if(g=h(".foundation-content").adaptTo("foundation-content"))e=e.map(function(f){return h(f).data("foundation-collection-item-id")}),e=b.expand(a.data.href,{item:e}),g.pushState(a.data.data,a.data.title,e)}})})(window,Granite.$,Granite.URITemplate);
(function(n,h,b,g){function c(e,f,m){if(f)return(a.has(f)?b.Deferred().resolve(a.get(f)).promise():b.ajax({url:f,cache:!1})).then(function(p){var k=b(p).on("foundation-toggleable-hide",function(t){var l=b(t.target);requestAnimationFrame(function(){l.detach()})}).appendTo(h.body).trigger("foundation-contentloaded");a.set(f,p);return k});e=m?b(m):e.closest(".foundation-toggleable");return b.Deferred().resolve(e).promise()}var a=new Map,d="."+Date.now();b(n).adaptTo("foundation-registry").register("foundation.collection.action.action",
{name:"foundation.dialog",handler:function(e,f,m,p,k){var t=b(f);e=m.data.target;var l=m.data.nesting,q;m.data.src&&(q=g.expand(m.data.src,{id:p.dataset.foundationCollectionId,item:k.map(function(r){return r.dataset.foundationCollectionItemId})}));c(t,q,e).then(function(r){var z=r.adaptTo("foundation-toggleable");r.off(d).one("foundation-form-submitted"+d,function(u,w,A){w&&(z.hide(),u=b(p).adaptTo("foundation-collection"),"reload"in u&&u.reload())});requestAnimationFrame(function(){if("hide"===l){var u=
t.closest(".foundation-toggleable").adaptTo("foundation-toggleable");u&&u.hide()}z.show(f)})})}})})(window,document,Granite.$,Granite.URITemplate);(function(n,h){h(n).on("click",".foundation-collection-item-activator",function(b){b=h(this).closest(".foundation-collection-item");b.closest(".foundation-collection").adaptTo("foundation-selections").select(b[0])})})(document,Granite.$);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection-item-action",selector:".foundation-collection",adapter:function(b){var g=h(b);return{execute:function(c){var a;if(a=c.classList.contains("foundation-collection-navigator")?c:c.querySelector(".foundation-collection-navigator")){var d=a.dataset.foundationCollectionNavigatorHref,e=a.dataset.foundationCollectionNavigatorTarget||"_self";d?(a.dataset.foundationTrackingPage&&(c=JSON.parse(a.dataset.foundationTrackingPage),
h(n).adaptTo("foundation-tracker").trackPage(c)),setTimeout(function(){n.open(d,e)},0)):g.adaptTo("foundation-collection").load(c.dataset.foundationCollectionItemId)}}}}})})(window,Granite.$);
(function(n,h){h(n).on("foundation-selections-change",".foundation-collection-masterdetail",function(b){var g=h(this);b=h(Granite.UI.Foundation.Utils.sanitizeHtml(this.dataset.foundationCollectionMasterdetailTarget));b.length&&(g=g.find(".foundation-selections-item").first(),g.length&&b.adaptTo("foundation-collection").load(g[0].dataset.foundationCollectionItemId))})})(document,Granite.$);
(function(n,h,b,g){h(n).on("foundation-selections-change",".foundation-collection-previewsupport",function(c){var a=this.dataset.foundationCollectionPreviewsupportTarget,d=this.dataset.foundationCollectionPreviewsupportSrc;c="child"===this.dataset.foundationCollectionPreviewsupportCollection?h(this).children(".foundation-collection"):h(c.target);var e=h(a);if(e.length){var f=c.find(".foundation-selections-item");a=b.expand(d,{item:f.toArray().map(function(p){return p.dataset.foundationCollectionItemId})});
var m=h(window).adaptTo("foundation-ui");m.wait(e[0]);h.ajax({url:a,cache:!1}).then(function(p){return h(window).adaptTo("foundation-util-htmlparser").parse(p).then(function(k){m.clearWait();e.empty().append(k).trigger("foundation-contentloaded")})},function(p,k,t){m.clearWait();if(f.length||"error"!==k||"Not Found"!==t)p=g.I18n.get("Error"),k=g.I18n.get("Fail to load data."),m.alert(p,k,"error")})}})})(document,Granite.$,Granite.URITemplate,Granite);
(function(n,h){h(n).on("click",".foundation-collection-selectall",function(b){if(b=this.dataset.foundationCollectionSelectallTarget)if(b=n.querySelector(b)){var g=h(b).adaptTo("foundation-selections");b.matches("coral-masonry.foundation-collection")&&b.setAttribute("selectionmode","multiple");b.dataset.foundationSelectionsSelectallMode=!0;g.selectAll()}});h(n).on("foundation-selections-change",".foundation-collection",function(b){var g=this,c=h(g),a="single"===g.dataset.foundationSelectionsMode;Array.from(n.querySelectorAll(".foundation-collection-selectall")).forEach(function(d){if(g.matches(d.dataset.foundationCollectionSelectallTarget)){var e=
g.tagName;a?d.hidden=!0:g.querySelector(".foundation-collection-item")?"CORAL-MASONRY"!==e&&"TABLE"!==e||g.querySelector(".foundation-collection-item [coral-table-rowselect],.foundation-collection-item .foundation-collection-item-activator")?(e=c.adaptTo("foundation-selections"),d.hidden=e.isAllSelected(),0===e.count()&&delete g.dataset.foundationSelectionsSelectallMode):d.hidden=!0:d.hidden=!0}})})})(document,Granite.$);
(function(n,h,b,g,c){function a(k,t,l,q,r,z,u){for(var w=l,A=null,x=null;0<=l&&l<t.length;l+=q){var L=t[l],H=k,T=L,D=z;if(!H._isItemAbove(H,T,r)&&!H._isItemBelow(H,T,D))w=l;else if(Math.abs(l-w)>u)break;L.classList.contains("is-lazyLoaded")&&(x=l,A=A||l)}return{first:A,last:x}}function d(k,t){var l=p(t).filter(".is-lazyLoaded,.is-pending").each(function(){this.classList.contains("is-lazyLoaded")&&(this.classList.add("is-pending"),this.classList.remove("is-lazyLoaded"))}).toArray(),q=Infinity,r=-1,
z=[];l.forEach(function(u){u=parseInt(u.dataset.datasourceIndex,10);-1!==r&&60<u-q&&(z.push(e(k,l,q,r)),q=Infinity,r=-1);r=r>u?r:u;q=q<u?q:u});-1!==r&&z.push(e(k,l,q,r));return p.when.apply(null,z).then(function(){var u=[];Array.prototype.forEach.call(arguments,function(w){w.forEach(function(A){u.push(A)})});return p.uniqueSort(u)})}function e(k,t,l,q){return k._load(k,{offset:l,limit:q-l+1,size:q-l+1}).then(function(r){var z=[];r.forEach(function(u){if(!u.classList.contains("is-lazyLoaded")){var w=
u.dataset.graniteCollectionItemId,A=t.find(function(x){return x.dataset.graniteCollectionItemId===w});A&&(A.showRemoveTransition=!1,A.classList.remove("is-pending"),A.replaceWith(u),z.push(u))}});return z})}function f(k,t,l,q){for(var r=Infinity,z=-1,u=[];l<=q;l++){var w=t[l];w.classList.contains("is-lazyLoaded")&&(w.classList.add("is-pending"),w.classList.remove("is-lazyLoaded"),u.push(w),w=parseInt(w.dataset.datasourceIndex,10),z=z>w?z:w,r=r<w?r:w)}e(k,u,r,z).then(function(){k._onReplace(k)})}function m(k){this.scrollSrc=
k.scrollSrc;this._getItems=k.getItems;this._load=k.load;this._onReplace=k.onReplace||p.noop;this._isItemAbove=k.isItemAbove||function(t,l,q){return l.offsetTop+l.offsetHeight<q};this._isItemBelow=k.isItemBelow||function(t,l,q){return l.offsetTop>q};this._setupListeners=k.setupListeners||p.noop;this._stack=[]}var p=g;m.prototype.start=function(){if(this._destroyed)throw Error("Illegal state: this class is already destroyed");var k=this,t=b.UI.Foundation.Utils.debounce(function(){if(h.body.contains(k.scrollSrc)){var l=
k._getItems(k);if(0!==p(l).filter(".is-lazyLoaded").length){var q=k.scrollSrc.scrollTop,r=q+k.scrollSrc.clientHeight;b:{var z=0;var u=l.length-1;for(var w=Math.floor((z+u)/2);z<u;w=Math.floor((z+u)/2)){var A=l[w],x=k,L=A,H=r;if(!x._isItemAbove(x,L,q)&&!x._isItemBelow(x,L,H)){u=w;break b}k._isItemAbove(k,A,q)?z=w:u=w}}z=a(k,l,u,-1,q,r,10);r=a(k,l,u,1,q,r,10);q=null!==z.last?z.last:r.first;r=null!==r.last?r.last:z.first;null!==q&&null!==r&&f(k,l,q,r)}}},200);this.scrollSrc.addEventListener("scroll",
t);this._stack.push(function(){k.scrollSrc.removeEventListener("scroll",t)});n.addEventListener("resize",t);this._stack.push(function(){n.removeEventListener("resize",t)});this._stack.push(this._setupListeners(this,t));t()};m.prototype.destroy=function(){this._destroyed=!0;b.UI.Foundation.Utils.everyReverse(this._stack,function(k){k();return!0})};m.prototype.loadItems=function(k){return d(this,k)};p(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection-lazyloader",
selector:p(n),adapter:function(){return m}})})(window,document,Granite,Granite.$,Granite.URITemplate);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-toggleable",selector:".foundation-toggleable",adapter:function(b){var g=h(b);return{isOpen:function(){return void 0===g.attr("hidden")},show:function(c){g.removeAttr("hidden");g.trigger("foundation-toggleable-show")},hide:function(){g.attr("hidden","");g.trigger("foundation-toggleable-hide")}}}})})(window,Granite.$);
(function(n,h){function b(c){var a=c.data("foundationToggleableControlSrc"),d=c.data("foundationToggleableControlTarget"),e="false"!==c.attr("data-foundation-toggleable-control-cache");if(a)return e&&g.has(a)?(c=g.get(a),c.appendTo(n.body),h.Deferred().resolve(c).promise()):h.ajax({url:a,cache:!1}).then(function(f){f=Granite.UI.Foundation.Utils.sanitizeHtml(f);f=h(f).on("foundation-toggleable-hide",function(m){var p=h(m.target);requestAnimationFrame(function(){p.detach()})}).appendTo(n.body).trigger("foundation-contentloaded");
g.set(a,f);return f});c=d?h(d):c.closest(".foundation-toggleable");return h.Deferred().resolve(c).promise()}var g=new Map;h(n).on("click",".foundation-toggleable-control",function(c){c.preventDefault();var a=h(this);b(a).then(function(d){var e=d.adaptTo("foundation-toggleable"),f=a.data("foundationToggleableControlAction");requestAnimationFrame(function(){void 0===f&&(f=e.isOpen()?"hide":"show");var m=f,p=a[0].getAttribute("data-foundation-tracking-event");p&&(p=JSON.parse(p),m={element:p.element||
"No element defined",feature:p.feature||"No feature defined",type:"toggleable",action:m,widget:{name:p.element||"No widget defined",type:"toggleable"},attributes:{}},h(window).adaptTo("foundation-tracker").trackEvent(m));"show"===f?("hide"===a.data("foundationToggleableControlNesting")&&(p=a.closest(".foundation-toggleable"),m=p.adaptTo("foundation-toggleable"))&&((p=p[0].elementToFocusWhenHidden||p[0].returnFocusToElement)&&d[0].returnFocusTo(p),m.hide()),e.show(a[0])):"hide"===f&&e.hide()})})});
h(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracking-event",selector:".foundation-toggleable-control[data-foundation-tracking-event]",adapter:function(c){return{track:function(a){}}}})})(document,Granite.$);(function(n,h){h(n).on("click",".foundation-mode-change",function(b){b.preventDefault();b=h(this);var g=b.data("foundationModeValue"),c=b.data("foundationModeGroup");b.trigger("foundation-mode-change",[g,c])})})(document,Granite.$);
(function(n,h,b){var g=null;h(n).on("foundation-mode-change",function(c,a,d){h(".foundation-mode-switcher").each(function(){var e=h(this);e.data("foundationModeSwitcherGroup")===d&&(g&&(clearTimeout(g),g=null),e.children(".foundation-mode-switcher-item").each(function(){var f=h(this),m=f.data("foundationModeSwitcherItemMode");f.toggleClass("foundation-mode-switcher-item-active",m===a);var p=f.find(".foundation-mode-switcher-item-liveregion").attr("role","status");p.length||(p=h("\x3cdiv\x3e\x3c/div\x3e").addClass("foundation-mode-switcher-item-liveregion u-coral-screenReaderOnly").attr("role",
"status"),f.append(p));f.find(".foundation-admin-selectionstatus").attr("aria-live","polite");m===a?(p.removeAttr("aria-hidden"),g=setTimeout(function(){p.html(f.find("coral-actionbar[aria-label]").attr("aria-label")+" "+b.I18n.get("expanded"))},200)):p.attr("aria-hidden","true").empty()}))})})})(document,Granite.$,Granite);
(function(n,h,b){function g(m){m=d.normalize(m.toLowerCase());var p=f.get(m);if(p){var k;p=p.reduce(function(t,l){(k=b(l).adaptTo("foundation-command"))&&k.isActive()&&t.push(k);return t},[]);1===p.length?p[0].execute():1<p.length&&console.warn("Multiple shortcuts detected and ignored: "+m)}}function c(m){(m.matchedTarget.offsetParent||m.target===h.body)&&g(m.keys)}function a(m){b("[data-foundation-command]",m).each(function(p,k){if(p=b(k).adaptTo("foundation-command")){var t=d.normalize(p.getShortcut());
if(t)if(-1!==e.indexOf(t))console.warn("Shortcut is a reserved and ignored: "+p.getShortcut());else{var l=f.get(t),q=!0;"undefined"===typeof l?(f.set(t,[k]),Coral.keys.on(t,c)):-1===l.indexOf(k)?l.push(k):q=!1;q&&p.enhanceUI()}}})}n=b(n);var d=n.adaptTo("foundation-util-keyboard");n=n.adaptTo("foundation-preference");var e=["/","esc"],f=new Map;if(n.getBoolean("shortcutsEnabled",!0))b(h).on("foundation-contentloaded",function(m){f.forEach(function(p,k){for(var t=p.length-1;-1<t;t--)h.contains(p[t])||
p.splice(t,1);0===p.length&&(f.delete(k),Coral.keys.off(k,c))});a(m.target)})})(window,document,Granite.$);
(function(n,h,b){function g(a){c.prompt(Granite.I18n.get("Unsaved changes"),Granite.I18n.get("You have unsaved changes! Are you are sure you want to close the page?"),"warning",[{text:Granite.I18n.get("Cancel")},{text:Granite.I18n.get("Yes"),primary:!0,handler:function(){n.location=a.getAttribute("href")}}])}var c=b(n).adaptTo("foundation-ui");b(h).on("click",".foundation-anchor",function(a){a.preventDefault();a=this.dataset.foundationAnchorHref;var d=this.dataset.foundationAnchorTarget;"null"!==
(new URL(a,h.baseURI)).origin&&(d?n.open(a,d):n.location=a)});b(h).on("click",".foundation-backanchor",function(a){var d=this,e=d.dataset.foundationBackanchorForm;e?(e=b("#"+e).adaptTo("foundation-form"))&&e.isDirty()&&(a.preventDefault(),g(d)):b("form.foundation-form").each(function(){if(b(this).adaptTo("foundation-form").isDirty())return a.preventDefault(),g(d),!1})})})(window,document,Granite.$);
(function(n,h,b){function g(){if(!a&&(a=new Map,n===n.parent))try{for(var e=[],f=0,m=sessionStorage.length;f<m;f++){var p=sessionStorage.key(f);if(p&&p.startsWith("foundation-fixedanchor::")){var k=JSON.parse(sessionStorage.getItem(p));k.url===c&&a.set(k.id,k);e.push(p)}}e.forEach(function(t){sessionStorage.removeItem(t)})}catch(t){n.console&&console.warn("Error occur restoring foundation-fixedanchor state",t)}}var c=n.location.href,a,d=new WeakMap;b(h).on("foundation-contentloaded",function(e){g();
b(".foundation-fixedanchor",e.target).each(function(){var f=b(this);if(!d.has(this)){d.set(this,!0);var m=f.prop("id");if(m){var p=f[0].dataset.foundationFixedanchorAttr||"href";if(a.has(m)){var k=a.get(m);f.attr(p,k.href)}try{sessionStorage.setItem("foundation-fixedanchor::"+m,JSON.stringify({url:c,id:m,href:f.attr(p)}))}catch(t){n.console&&console.warn("Error occur saving foundation-fixedanchor state",t)}}}})})})(window,document,Granite.$);
(function(n,h){var b=h(n).adaptTo("foundation-registry");b.register("foundation.adapters",{type:"foundation-editable",selector:".foundation-editable",adapter:function(g){var c=h(g);return{edit:function(){var a;Granite.UI.Foundation.Utils.everyReverse(b.get("foundation.editable.editor"),function(f){if(!c.is(f.selector))return!0;a=f.handler.call(c[0],c[0]);return!1});if(a){var d=c.position(),e=h(document.createElement("div")).css({position:"absolute",top:d.top,left:d.left,width:c.css("width")});e.append(a.el);
e.insertAfter(c);a.renderCallback();c.on("foundation-editable-commit foundation-editable-cancel",function(f){e.remove()})}}}}})})(window,Granite.$);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.editable.editor",{selector:".foundation-editable[data-foundation-editable-editor\x3d'foundation.text']",handler:function(g){var c=h(g),a=h(new b.Textfield).css({display:"block",width:"100%"}),d=function(){c.text(a.val());c.trigger("foundation-editable-commit")};a.on("blur",function(e){d()}).on("keydown",function(e){13===e.which?(e.preventDefault(),d()):27===e.which&&(e.preventDefault(),c.trigger("foundation-editable-cancel"))});
a.val(c.text());return{el:a[0],renderCallback:function(){a.focus()}}}})})(window,Granite.$,Coral);(function(n,h){function b(g){g.adaptTo("foundation-editable").edit()}h(n).on("click",".foundation-editable-control",function(g){g.preventDefault();b(h(this))});h(n).on("keydown",".foundation-editable-control",function(g){13===g.which&&(g.preventDefault(),b(h(this)))})})(document,Granite.$);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-wizard",selector:".foundation-wizard",adapter:function(b){var g=h(b);return{toggleNext:function(c){this.toggle("next",c)},togglePrev:function(c){this.toggle("prev",c)},toggleCancel:function(c){this.toggle("cancel",c)},toggle:function(c,a){var d=g.adaptTo("foundation-layout");d&&"function"===typeof d.toggle?d.toggle(c,a):g.children(".foundation-wizard-step.foundation-wizard-step-active").find(".foundation-wizard-control[data-foundation-wizard-control-action\x3d"+
c+"]").each(function(){h(this).is("button")?h(this).prop("disabled",!a):h(this).toggleClass("disabled",!a)})},next:function(){var c=g.adaptTo("foundation-layout");if(c&&"function"===typeof c.next)c.next();else{c=g.children(".foundation-wizard-step-active");var a=c.nextAll(".foundation-wizard-step").first();a.length&&(c.removeClass("foundation-wizard-step-active"),a.addClass("foundation-wizard-step-active"),g.trigger("foundation-wizard-stepchange",[a[0],c[0]]))}},prev:function(){var c=g.adaptTo("foundation-layout");
if(c&&"function"===typeof c.prev)c.prev();else{c=g.children(".foundation-wizard-step-active");var a=c.prevAll(".foundation-wizard-step").first();a.length&&(c.removeClass("foundation-wizard-step-active"),a.addClass("foundation-wizard-step-active"),g.trigger("foundation-wizard-stepchange",[a[0],c[0]]))}},append:function(c,a){var d=g.adaptTo("foundation-layout");d&&"function"===typeof d.append?d.append(c,a):void 0===a?g.append(c):(g.children(".foundation-wizard-step").eq(a).after(c),g.trigger("foundation-contentloaded"))},
appendAfter:function(c,a){var d=g.adaptTo("foundation-layout");d&&"function"===typeof d.appendAfter?d.appendAfter(c,a):(h(a).after(c),g.trigger("foundation-contentloaded"))},remove:function(c){var a=g.adaptTo("foundation-layout");a&&"function"===typeof a.remove?a.remove(c):h(c).remove()},getPrevSteps:function(c){var a=g.adaptTo("foundation-layout");return a&&"function"===typeof a.getPrevSteps?a.getPrevSteps(c):h(c).prevAll(".foundation-wizard-step").toArray()}}}})})(window,Granite.$);
(function(n,h){function b(c,a){c.closest(".foundation-wizard").adaptTo("foundation-wizard").toggleNext(a)}function g(c){var a=c.adaptTo("foundation-validation-helper").isValid();c.data("foundation-wizard-step.internal.valid",a);b(c,a)}h(n).on("foundation-validation-invalid",".foundation-wizard-step",function(c){var a=h(this);if(!1!==a.data("foundationWizardStepValidation")){b(a,!1);c=c.target;var d=a.data("foundation-wizard.internal.invalids");void 0===d&&(d=[],a.data("foundation-wizard.internal.invalids",
d));0>d.indexOf(c)&&d.push(c)}});h(n).on("foundation-validation-valid",".foundation-wizard-step",function(c){var a=h(this);if(!1!==a.data("foundationWizardStepValidation")){var d=a.data("foundation-wizard.internal.invalids");if(d)if(c=d.indexOf(c.target),0<=c&&d.splice(c,1),0===d.length)g(a);else{c=!1;for(var e=d.length;e--;){if(a.has(d[e]).length){c=!0;break}d.splice(e,1)}c||g(a)}else g(a)}})})(document,Granite.$);
(function(n,h,b){function g(c){var a={};c.find(":input").each(function(){var d=h(this);d.serializeArray().forEach(function(e){var f=e.name;e=e.value;if(a.hasOwnProperty(f)){var m=a[f];Array.isArray(m)||(m=[m]);m.push(e);e=m}a[f]=e;(e=d[0].dataset.foundationUritemplateParent)&&((a[e]=a[e]||{})[f]=a[f])})});return a}h(n).on("foundation-wizard-stepchange",function(c,a,d){var e=h(a);if(e.hasClass("foundation-wizard-lazycontainer")){var f=a.dataset.foundationWizardLazycontainerSrc;if(f&&(c=h(c.target).adaptTo("foundation-wizard"),
a=h(c.getPrevSteps(a)),!a.length||!d||a.is(d))&&(d=g(a),f=b.expand(f,d),e.data("foundation-wizard-lazycontainer.internal.lastURL")!==f)){e.data("foundation-wizard-lazycontainer.internal.lastURL",f);var m=h(window).adaptTo("foundation-ui");m.wait();h.ajax({url:f,cache:!1}).done(function(p){h(window).adaptTo("foundation-util-htmlparser").parse(p).then(function(k){m.clearWait();e.html("").append(k);e.trigger("foundation-contentloaded");e.adaptTo("foundation-validation-helper").getSubmittables().forEach(function(t){t=
h(t).adaptTo("foundation-validation");t.getValidity().isValidated()||t.checkValidity()})})}).fail(function(){m.clearWait();var p=Granite.I18n.get("Error"),k=Granite.I18n.get("Something went wrong.");m.alert(p,k,"error")})}}})})(document,Granite.$,Granite.URITemplate);
(function(n,h,b,g){function c(x,L){return L.done(function(){u.delete(x[0])}).done(d(x)).fail(e(x)).done(function(){x.trigger("foundation-form-submitted",[!0,L])}).fail(function(){x.trigger("foundation-form-submitted",[!1,L])})}function a(x,L){b.when.apply(null,L).done(function(){u.delete(x[0])}).done(function(){var H=x.data("foundationFormResponseUiSuccess")||x.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");if(!H){var T=x.data("foundationFormOutputReplace"),
D=!1;T?D=!0:T=x.data("foundationFormOutputPush");if(!T)return;H={name:"foundation.content",redirect:x.data("foundationFormRedirect"),history:x.data("foundationFormHistory"),target:T,replace:D}}q(r.get("foundation.form.response.ui.success"),function(F){return F.name!==H.name?!0:!1===F.handler.call(x[0],x[0],H)})}).fail(e(x)).done(function(){}).fail(function(){})}function d(x){return function(L,H,T){var D=x.data("foundationFormResponseUiSuccess")||x.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");
if(!D){var F=x.data("foundationFormOutputReplace"),J=!1;F?J=!0:F=x.data("foundationFormOutputPush");if(!F)return;D={name:"foundation.content",redirect:x.data("foundationFormRedirect"),history:x.data("foundationFormHistory"),target:F,replace:J}}var O=b(h).adaptTo("foundation-response-parser").parse(T),S=f(x,T,O)||L;b(x).adaptTo("foundation-form-handle-tracking").trackFormSubmit(x);q(r.get("foundation.form.response.ui.success"),function(P){return P.name!==D.name?!0:!1===P.handler.call(x[0],x[0],D,S,
H,T,O)})}}function e(x){return function(L,H,T){if("none"!==x.data("foundationFormUi")){var D=b(h).adaptTo("foundation-response-parser").parse(L),F=f(x,L,D);q(r.get("foundation.form.response.ui.error"),function(J){return!1===J.handler.call(x[0],x[0],F,L,H,T)})}}}function f(x,L,H){var T=L.getResponseHeader("content-type");if(!T)return L.responseText;var D;q(r.get("foundation.form.response.parser"),function(F){if(!x.is(F.selector)||!T.match(F.contentType))return!0;F=F.handler.call(x[0],x[0],L,H);if(!1===
F)return!0;D=F;return!1});return D}function m(x){if(!0===x.data("foundationFormLoadingmask")){var L=b(),H=x.data("foundationFormOutputReplace")||x.data("foundationFormOutputPush");H&&(L=b(H));H=w;H.show(x[0],L[0]);x.data("foundation-form.internal.currentLoadingMask",{target:L[0],impl:H})}}function p(x,L){x.each(function(){var H=b(this).adaptTo("foundation-field");H&&H.setDisabled(L)})}function k(x){return x.reduce(function(L,H){return H.post?L.concat(H.post()):L},[])}function t(x){if(x.data("foundationFormActions")){var L=
x.attr("action"),H=[];x.data("foundationFormActions").split(" ").forEach(function(D){x.prop("action",D);D=x.adaptTo("foundation-form").submitAsync();D.always(function(){x.attr("action",L)});H.push(D)});return function(){a(x,H)}}var T=x.adaptTo("foundation-form").submitAsync();return function(){return c(x,T)}}function l(x){m(x);var L=[];r.get("foundation.form.submit").forEach(function(T){x.is(T.selector)&&L.push(T.handler.call(x[0],x[0]))});var H=L.reduce(function(T,D){return D.preResult?T.concat(D.preResult):
T},[]);return b.when.apply(null,H).then(function(){var T=t(x);return b.when.apply(null,k(L)).then(T,T)}).always(function(){var T=x.data("foundation-form.internal.currentLoadingMask");T&&(T.impl.hide(x[0],T.target),x.removeData("foundation-form.internal.currentLoadingMask"))})}var q=g.UI.Foundation.Utils.everyReverse,r=b(h).adaptTo("foundation-registry"),z=b(h).adaptTo("foundation-ui"),u=new WeakMap,w={show:function(x,L){z.wait(L)},hide:function(x,L){z.clearWait()}};b(n).on("foundation-form-submit-callback",
"form.foundation-form",function(x,L){c(b(this),L)});b(n).on("reset","form.foundation-form",function(x){b(this).adaptTo("foundation-form").reset(!0)});b(n).on("foundation-field-change","form.foundation-form",function(x){u.set(this,!0)});var A=new WeakMap;b(n).on("submit","form.foundation-form",function(x){var L=b(this);if(L.data("foundationFormAjax")&&(x.preventDefault(),!L.data("foundationFormDisable"))){A.has(L[0])||A.set(L[0],[]);var H=A.get(L[0]);H.push(function(){l(L).always(function(){H.shift();
if(H.length)H[0]()})});if(1===H.length)H[0]()}});r.register("foundation.adapters",{type:"foundation-form",selector:"form.foundation-form",adapter:function(x){var L=b(x),H=function(T){(T=T.adaptTo("foundation-field"))&&T.reset&&T.reset()};return{submitAsync:function(){var T=L.attr("enctype"),D=L.attr("method")||"get",F=L.attr("action");if("post"===D.toLowerCase()&&"multipart/form-data"===T){var J=new FormData(L[0]);return b.ajax({method:D,url:F,contentType:!1,mimeType:T,processData:!1,data:J})}return b.ajax({method:D,
url:F,contentType:T,data:L.serialize(),cache:!1})},reset:function(T){T||x.reset();L.find(".foundation-field-editable").each(function(){var D=b(this);H(D.find(".foundation-field-readonly"));H(D.find(".foundation-field-edit"))})},isDirty:function(){return!0===u.get(x)}}}});r.register("foundation.form.submit",{selector:"*",handler:function(x){var L=b(x).find(".foundation-field-mixed");p(L,!0);return{post:function(){p(L,!1)}}}})})(document,window,Granite.$,Granite);
(function(n,h,b){b(h).adaptTo("foundation-registry").register("foundation.form.response.parser",{name:"foundation.sling",selector:"*",contentType:/text\/html/,handler:function(g,c,a){g=b(a);return g.find("#Status").length?Array.prototype.reduce.call(g.find("[id]"),function(d,e){d[e.id]=e.href?e.href:e.textContent;return d},{}):!1}})})(document,window,Granite.$);
(function(n,h,b){b(h).adaptTo("foundation-registry").register("foundation.form.response.parser",{name:"foundation.form",selector:"*",contentType:/text\/html/,handler:function(g,c,a){g=b(a);return(c=g.find(".foundation-form-response-status-code").next().text())?{statusCode:c,message:g.find(".foundation-form-response-status-message").next().text(),redirect:g.find(".foundation-form-response-redirect").attr("href"),path:g.find(".foundation-form-response-path").next().text(),title:g.find(".foundation-form-response-title").next().text(),
description:g.find(".foundation-form-response-description").next().html()}:!1}})})(document,window,Granite.$);(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.default",handler:function(b,g,c,a,d){b=a||Granite.I18n.get("Error");d=d||Granite.I18n.get("Fail to submit the form.");h(n).adaptTo("foundation-ui").alert(b,d,"error")}})})(window,Granite.$);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.sling",handler:function(g,c,a,d,e){if(!c||!c.Status)return!1;g=b.I18n.get("Error");c=c.Message;h(n).adaptTo("foundation-ui").alert(g,c,"error")}})})(window,Granite.$,Granite);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.html",handler:function(b,g,c,a,d){if(!g||!g.statusCode)return!1;b=g.title||Granite.I18n.get("Error");g=g.description||g.message;h(n).adaptTo("foundation-ui").alert(b,g,"error")}})})(window,Granite.$);
(function(n,h){function b(g,c,a){var d=h(Granite.UI.Foundation.Utils.sanitizeHtml(c.target)),e=d.adaptTo("foundation-content");if(e){if(c.history){if(c.history.url||c.history.useFormUrl){d=g.attr("action");g=g.serialize();var f=0<=d.lastIndexOf("?")?"\x26":"?";g=d+f+g}else g=void 0;f={data:c.history.data,title:c.history.title,url:g}}c.replace?e.replace(a,f):e.push(a,f)}else d.html(Granite.UI.Foundation.Utils.sanitizeHtml(a))}h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.success",
{name:"foundation.content",handler:function(g,c,a,d,e){if(c.target){var f=h(g);c.redirect?h.ajax({url:c.redirect,cache:!1}).done(function(m){b(f,c,m)}):b(f,c,a)}}})})(window,Granite.$);
(function(n,h,b){function g(c,a){c&&"/"===c[0]&&(a?n.open(c):n.location=c)}h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.prompt.open",handler:function(c,a,d,e,f){h(n).adaptTo("foundation-ui").prompt(a.title,a.message,"success",[{text:Granite.I18n.get("Done"),handler:function(){g(b.expand(a.redirect,d))}},{text:Granite.I18n.get("Open"),primary:!0,handler:function(){g(b.expand(a.open,d),!0);g(b.expand(a.redirect,d))}}])}})})(window,Granite.$,Granite.URITemplate);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.redirect",handler:function(g,c,a,d,e){g=b.expand(c.href,a);c="//"+document.location.host;a=document.location.protocol+c;g!==a&&g.slice(0,a.length+1)!==a+"/"&&g!==c&&g.slice(0,c.length+1)!==c+"/"&&/^(\/\/|http:|https:).*/.test(g)||(n.location=g)}})})(window,Granite.$,Granite.URITemplate);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.reload",handler:function(g,c,a,d,e){h(n).adaptTo("foundation-util-messenger").put(null,c.message||b.I18n.get("The form has been submitted successfully"),"success");n.location.reload()}})})(window,Granite.$,Granite);
(function(n,h,b){h(n).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.collection.reload",handler:function(g,c,a,d,e){h(n).adaptTo("foundation-util-messenger").put(null,c.message||b.I18n.get("The form has been submitted successfully"),"success");h(b.UI.Foundation.Utils.sanitizeHtml(c.target)).adaptTo("foundation-collection").reload()}})})(window,Granite.$,Granite);
(function(n,h){h(n).on("foundation-field-change",".foundation-field-autosubmit",function(b){b=h(this).closest("form");if(b.length){var g=n.createEvent("Event");g.initEvent("submit",!0,!0);b[0].dispatchEvent(g)}})})(document,Granite.$);
(function(n,h,b,g,c){function a(f){var m=[f],p=0;return{current:function(){return this.peek(0)},peek:function(k){return m[p+k]},pointToToken:function(k){for(var t=0,l=m.length;t<l;t++){var q=m[t];if(q.token===k)return p=t,q}},forward:function(){if(p<m.length-1)return m[++p]},back:function(){if(0<p)return m[--p]},push:function(k){m.splice(++p,m.length-p,k)}}}function d(f){return(f=f.querySelector("title"))?f.textContent:null}var e=Date.now().toString();g(function(f){g(".foundation-content").length&&
(f=c.getState(),f.data.foundationContent={token:e},c.replaceState(f.data,h.title),g(n).on("statechange",function(m){if(m=c.getState().data.foundationContent){var p=g(".foundation-content");p.length&&p.adaptTo("foundation-content").goToToken(m.token)}}))});g(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-content",selector:".foundation-content",adapter:function(f){var m=g(f),p=a({token:e,el:m.children(".foundation-content-current")}),k=function(l){return l.children(".foundation-content-current").removeClass("foundation-content-current").detach()},
t;return{pushState:function(l,q,r){return this.go(r,!1,{data:l,title:q,url:r})},replaceState:function(l,q,r){return this.go(r,!0,{data:l,title:q,url:r})},go:function(l,q,r){var z=this;t&&"pending"===t.state()&&t.abort();var u=g.ajax(l,{cache:!1});t=u;return u.then(function(w){return q?z.replace(w,r):z.push(w,r)}).fail(function(){m.trigger("foundation-content-loaded",[!1,q,u])})},goToToken:function(l){(l=p.pointToToken(l))&&!l.el.is(".foundation-content-current")&&(g(n).adaptTo("foundation-util-htmlparser").parse(l.el[0]),
k(m),l.el.addClass("foundation-content-current").appendTo(m))},refresh:function(){return this.go(h.location.toString(),!0)},push:function(l,q){var r=Date.now().toString(),z=g(".foundation-content-path").attr("data-foundation-content-path"),u=g(n).adaptTo("foundation-util-htmlparser"),w=u.createFragment(l);l=u.parse(w);var A=g(w.querySelector(".foundation-content-current"));A.length||(A=g(h.createElement("div")).addClass("foundation-content-current").append(w));p.push({token:r,el:A});l.then(function(){k(m);
m.append(A);0===g(".foundation-content-path").length&&g(h.createElement("div")).prop("hidden",!0).attr("data-foundation-content-path",z).prependTo(A);A.trigger("foundation-contentloaded");if(q){var x=q.data||{};x.foundationContent={token:r};c.pushState(x,q.title||d(w),q.url)}m.trigger("foundation-content-loaded",[!0,!1])});return r},replace:function(l,q){var r=p.current(),z=g(n).adaptTo("foundation-util-htmlparser");l=z.createFragment(l);z.parse(l).then(function(u){var w=g(u.querySelector(".foundation-content-current"));
w.length||(w=g(u).children());w.is(".foundation-content-current")?(m.children(".foundation-content-current").remove(),w.appendTo(m).trigger("foundation-contentloaded")):m.children(".foundation-content-current").empty().append(w).trigger("foundation-contentloaded");q&&(w=q.data||{},w.foundationContent={token:r.token},c.replaceState(w,q.title||d(u),q.url));m.trigger("foundation-content-loaded",[!0,!0])});return r.token},back:function(l){if(c.getState().data.foundationContent){if(l){var q=this;g(n).one("statechange",
function(){q.refresh()})}var r=p.peek(-1);c.back();return r?r.token:void 0}if(r=p.back())return g(n).adaptTo("foundation-util-htmlparser").parse(r.el[0]),k(m),r.el.addClass("foundation-content-current").appendTo(m),l&&this.refresh(),(l=g(".foundation-collection",m).data("cardView"))&&l.layout&&l.layout(),r.token},forward:function(l){if(c.getState().data.foundationContent){if(l){var q=this;g(n).one("statechange",function(){q.refresh()})}l=p.peek(1);c.forward();return l?l.token:void 0}var r=p.forward();
if(r)return g(n).adaptTo("foundation-util-htmlparser").parse(r.el[0]),k(m),r.el.addClass("foundation-content-current").appendTo(m),l&&this.refresh(),r.token}}}})})(window,document,Granite,Granite.$,History);
(function(n,h){h(n).on("click",".foundation-content-control",function(b){b.preventDefault();var g=h(this);b=g.data("foundationContentControlAction");var c=g.data("foundationContentControlRefresh");g=g.closest(".foundation-content").adaptTo("foundation-content");"back"===b?g.back(c):"forward"===b&&g.forward(c)})})(document,Granite.$);
(function(n,h){function b(g,c,a,d){var e;(e=g.data(c+"-"+a))||(e=(g=g.data(c))?d&&"object"!==typeof g?g:g[a]:void 0);return e}h(n).on("click","a[data-foundation-content-history]",function(g){g.preventDefault();var c=h(this);var a=h(".foundation-content");if(a.length){var d=b(c,"foundation-content-history","action",!0);g=b(c,"foundation-content-history","title");var e=c.prop("href");d=void 0!==d?"replace"===d:!!b(c,"foundation-content-history","replace");c=b(c,"foundation-content-history","data");
a=a.adaptTo("foundation-content");d?a.replaceState(c,g,e):a.pushState(c,g,e)}})})(document,Granite.$);(function(n,h,b){b(h).on("click",".foundation-history-control",function(g){g.preventDefault();g=b(this).data("foundationHistoryControlAction");"back"===g?n.history.back():"forward"===g&&n.history.forward()})})(window,document,Granite.$);
(function(n,h,b,g,c){function a(e){e.id||(e.id=c.commons.getUID());return e.id}function d(e,f){return e.substring(0,f.length)===f}b(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-picker",selector:"coral-overlay.foundation-picker-buttonlist",adapter:function(e){var f=b(e),m=null,p=null,k=null,t=null,l=!1,q=b(h.createElement("div")).addClass("foundation-picker-buttonlist-loader").attr("role","progressbar").append((new c.Wait).set({centered:!0})),r=new (b(n).adaptTo("foundation-util-paginator"))({el:e,
limit:e.dataset.foundationPickerButtonlistLimit||10,resolveURL:function(u){return g.expand(e.dataset.foundationPickerButtonlistSrc,{offset:u.offset,limit:u.limit,query:t})},wait:function(u){f.append(q);return{clear:function(){q.remove()}}},processResponse:function(u,w){var A=b.Deferred();b(n).adaptTo("foundation-util-htmlparser").parse(w).then(function(x){x=b(x).children();if(x.is("coral-buttonlist")){var L=x.children("button");L.attr("tabindex",-1);var H=f.children("coral-buttonlist");H.append(L);
if(0===u.offset&&(H=H.children("button").first(),H.length)){var T=H.val();0<t.length&&!l&&d(T,t)&&(b(p).is("foundation-autocomplete")&&(p.field.value=T,p.field.setSelectionRange(t.length,T.length)),H.siblings(".is-focused").removeClass("is-focused"),H.addClass("is-focused"))}var D=x[0].dataset.foundationPickerButtonlistHasnext;D="true"===D?!0:"false"===D?!1:L.length>=u.limit;requestAnimationFrame(function(){A.resolve({length:L.length,hasNext:D})})}});return A.promise()}}),z=function(u,w){var A={},
x;for(x in u.dataset)if(u.dataset.hasOwnProperty(x)&&!(x.length<=w.length)&&x.startsWith(w)){var L=x.charAt(w.length);L===L.toUpperCase()&&(L=x.substr(w.length),A[L.toLowerCase()]=u.dataset[x])}return A};r.start();e.tabIndex=-1;e.placement="bottom";e.collision="flip";f.on("coral-overlay:open",function(u){if(u.target===e&&p){e.scrollTop=0;"combobox"===p.field.getAttribute("role")&&p.field.setAttribute("aria-expanded","true");var w=p;u=e.getBoundingClientRect();w=w.getBoundingClientRect();u.top<w.top?
f.addClass("is-above"):f.removeClass("is-above")}});f.on("coral-overlay:close",function(u){u.target===e&&(f.find("\x3e coral-buttonlist \x3e button.is-focused").removeClass("is-focused"),"combobox"===p.field.getAttribute("role")&&(p.field.removeAttribute("aria-activedescendant"),p.field.setAttribute("aria-expanded","false")),k=p=m=null)});f.on("mouseover","coral-buttonlist \x3e button",function(u){u=b(this);u.siblings(".is-focused").removeClass("is-focused");u.addClass("is-focused")});f.on("click",
"coral-buttonlist \x3e button",function(u){u=[{value:this.value,text:this.getAttribute("foundation-picker-buttonlist-text")||this.content.textContent,data:z(this,"foundationPickerButtonlistCustom")}];m.resolve(u);e.open=!1});b(h).on("click",function(u){e.open&&p&&!p.contains(u.target)&&(k&&k(t),m.reject(),e.open=!1)});return{attach:function(u){f.appendTo(u);f.trigger("foundation-contentloaded")},detach:function(){f.detach()},pick:function(u,w,A,x){w=A===t;l=t&&A.length<t.length&&d(t,A);m=b.Deferred();
p=u;t=A;k=x;(A="combobox"===p.field.getAttribute("role"))&&p.field.setAttribute("aria-autocomplete","both");w||(x=f.children("coral-buttonlist"),x.length?x.children("button").remove():(x=(new c.ButtonList).set({interaction:"off"}),x.setAttribute("role","listbox"),f.append(x),A&&(A=u.field.getAttribute("aria-controls"),a(x),A=A?A+" "+x.id:x.id,p.field.setAttribute("aria-controls",A))),r.restart(void 0,void 0,!0));e.open||(u=(A=b(u).adaptTo("foundation-overlay-anchor"))?A.getElement():u,f.outerWidth(b(u).outerWidth()),
e.target=u,e.focusOnShow="off",e.open=!0);return m.promise()},cancel:function(){k&&k(t);e.open=!1},resolve:function(u){var w=b.Deferred();u=u.map(function(A){var x=f.find("\x3e coral-buttonlist \x3e button").filter(function(){return this.value===A}).first();return x.length?{value:x[0].value,text:x[0].getAttribute("foundation-picker-buttonlist-text")||x[0].content.textContent,data:z(x[0],"foundationPickerButtonlistCustom")}:null});w.resolve(u);return w.promise()},focus:function(u){if(k){var w=f.children("coral-buttonlist"),
A=w.children(".is-focused"),x=function(L){if(L){L.classList.add("is-focused");var H=L.getBoundingClientRect(),T=e.getBoundingClientRect();H.top<T.top?L.scrollIntoView():H.top+H.height>T.bottom&&L.scrollIntoView(!1);a(L);"combobox"===p.field.getAttribute("role")?p.field.setAttribute("aria-activedescendant",L.id):p.setAttribute("aria-activedescendant",L.id);k(L.value)}};u?A.length?(A.removeClass("is-focused"),u=A.prev("button"),u.length?x(u[0]):k&&k(t)):x(w.children("button:last-of-type")[0]):A.length?
(A.removeClass("is-focused"),u=A.next("button"),u.length?x(u[0]):k&&k(t)):x(w.children("button:first-of-type")[0])}}}}})})(window,document,Granite.$,Granite.URITemplate,Coral);
(function(n,h,b){function g(c,a){if(c&&c.field&&"combobox"===c.field.getAttribute("role")){var d=c.field.getAttribute("aria-controls")||"";-1!==d.indexOf(a)?(d=d.replace(a,""),d=d.replace(" ",""),c.field.setAttribute("aria-controls",d)):(c.field.setAttribute("aria-controls",d?d+" "+a:a),c.field.setAttribute("aria-autocomplete","none"))}}h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-picker",selector:"coral-popover.foundation-picker-collection, coral-dialog.foundation-picker-collection",
adapter:function(c){var a=h(c),d=null,e=null;c.id||(c.id=b.commons.getUID());a.on("coral-overlay:open",function(f){f.target===c&&(f.target.target=null)});a.on("coral-overlay:close",function(f){f.target===c&&d&&d.reject()});a.on("click",".granite-pickerdialog-submit",function(f){f.preventDefault();f=a.find(".foundation-collection .foundation-selections-item").toArray().map(function(p){return{value:p.dataset.foundationPickerCollectionItemValue||p.dataset.foundationCollectionItemId,text:p.dataset.foundationPickerCollectionItemText||
h(p).find(".foundation-collection-item-title").text()}});var m=d;d=null;c.open=!1;m.resolve(f)});a.on("foundation-selections-change",".foundation-collection",function(f){f=h(this).adaptTo("foundation-selections");a.find(".granite-pickerdialog-submit").prop("disabled",0===f.count())});return{attach:function(f){a.is("coral-dialog")?a.appendTo(document.body):a.appendTo(f);e=f;g(e,c.id);a.trigger("foundation-contentloaded")},detach:function(){g(e,c.id);a.detach()},pick:function(f){d=h.Deferred();requestAnimationFrame(function(){var m=
a.find(".foundation-collection").adaptTo("foundation-selections");m&&m.clear();c.target=f;c.open=!0});return d.promise()},cancel:function(){d=e=null;c.open=!1}}}})})(window,Granite.$,Coral);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-picker",selector:"coral-popover.foundation-picker-form, coral-dialog.foundation-picker-form",adapter:function(b){var g=h(b),c=g.adaptTo("foundation-picker-form"),a=null;g.on("coral-overlay:open",function(d){d.target===b&&(d.target.target=null)});g.on("coral-overlay:close",function(d){d.target===b&&a&&a.reject()});g.on("submit",b.dataset.foundationPickerFormTarget||"form",function(d){d.preventDefault();
d=a;a=null;b.open=!1;d.resolve(c.getSelections())});return{attach:function(d){g.is("coral-dialog")?g.appendTo(document.body):g.appendTo(d);g.trigger("foundation-contentloaded")},detach:function(){g.detach()},pick:function(d,e,f){a=h.Deferred();requestAnimationFrame(function(){c.setup(d,e,f).then(function(){b.target=d;b.open=!0})});return a.promise()},cancel:function(){a=null;b.open=!1}}}})})(window,Granite.$);
(function(n,h,b,g){function c(m,p,k){var t=m.data("foundationPickerControlAction");g.UI.Foundation.Utils.everyReverse(f.get("foundation.picker.control.action"),function(l){return l.name!==t.name?!0:!1===l.handler.call(m[0],l.name,m[0],t,k)})}function a(m,p){p.api.attach(this);p.api.pick(m[0],[]).then(function(k){p.api.detach();p.open=!1;c(m,p,k)},function(){d(m,p)});"focus"in p.api?p.api.focus():p.el.focus();p.open=!0}function d(m,p){p.api.detach();p.open=!1}function e(m){var p=m.data("foundation-picker-control.internal.state");
p||(p={el:null,open:!1,loading:!1},m.data("foundation-picker-control.internal.state",p));return p}var f=b(n).adaptTo("foundation-registry");b(h).on("click",".foundation-picker-control",function(m){m.preventDefault();var p=b(this),k=e(p);if(!k.loading)if(k.el)k.open?(k.api.cancel(),d(p,k)):a(p,k);else if(m=p[0].dataset.foundationPickerControlSrc)k.loading=!0,b.ajax({url:m,cache:!1}).then(function(t){return b(n).adaptTo("foundation-util-htmlparser").parse(t)}).then(function(t){return b(t).children()[0]}).then(function(t){k.loading=
!1;k.el=t;k.api=b(t).adaptTo("foundation-picker");a(p,k)},function(){k.loading=!1})})})(window,document,Granite.$,Granite);
(function(n,h,b){h.UI.Foundation.Layouts=h.UI.Foundation.Layouts||function(){var g=b(window).adaptTo("foundation-registry"),c=function(a){return g.get("foundation.layouts").find(function(d){return d.name===a})};return{register:function(a,d,e){g.register("foundation.layouts",{name:a,doLayout:d,clean:e})},layout:function(a){var d=b(a),e=d.data("foundationLayout"),f=c(e.name);f&&(e.stateId&&b.cookie(e.stateId+".layoutId",e.layoutId,{expires:7,path:"/"}),f.doLayout(a,e),d.trigger("foundation-layout-perform"))},
switchLayout:function(a,d){var e=b(a),f=e.data("foundationLayout");f&&f.name===d.name||(f&&(c(f.name).clean||this.clean)(a,f),e.addClass(d.name),e.data("foundationLayout",d),this.layout(a))},clean:function(a){a=b(a);var d=a.data("foundationLayout");a.removeClass(d.name);a.data("foundationLayout",null);d.stateId&&b.removeCookie(d.stateId+".layoutId",{path:"/"})},cleanAll:function(a){var d=b(a).data("foundationLayout");d&&(c(d.name).clean||this.clean)(a,d)}}}();b(n).on("foundation-contentloaded",function(g){b(g.target).filter("[data-foundation-layout]").add(b("[data-foundation-layout]",
g.target)).each(function(){h.UI.Foundation.Layouts.layout(this)})})})(document,Granite,Granite.$);
(function(n,h,b){b(n).on("click",".foundation-layout-control",function(g){var c=b(this),a=c.data("foundationLayoutControl");if("switch"===a.action){var d=a.target?b(h.UI.Foundation.Utils.sanitizeHtml(a.target)):c.closest("[data-foundation-layout]");h.UI.Foundation.Layouts.switchLayout(d[0],a.config);b(".foundation-layout-control").each(function(){var e=b(this);if(!e.is(c)){var f=e.data("foundationLayoutControl");"switch"===f.action&&a.config.name===f.config.name&&(f.target?d.is(f.target):d.is(e.closest("[data-foundation-layout]")))&&
(e.parent(".coral-CycleButton").length?(e.addClass("is-active"),e.siblings(".foundation-layout-control").removeClass("is-active")):e.parent("coral-cyclebutton").length&&e.prop("selected",!0))}})}})})(document,Granite,Granite.$);
(function(n,h,b){function g(c){var a=c?n.localStorage:n.sessionStorage;return{get:function(d){return JSON.parse(a.getItem(d))},set:function(d,e){a.setItem(d,JSON.stringify(e))},remove:function(d){a.removeItem(d)}}}h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-clipboard",selector:h(n),adapter:function(c){var a=h(c),d=g();return{get:function(e){return d.get(e)},set:function(e,f){d.set(e,f);a.trigger("foundation-clipboard-change",{key:e,data:f,timestamp:(new Date).getTime()})},
remove:function(e){d.remove(e);a.trigger("foundation-clipboard-change",{key:e,data:null,timestamp:(new Date).getTime()})}}}})})(window,Granite.$);
(function(n,h,b,g){var c=function(){var a=[];return{register:function(d,e){a.push({varname:d,provider:e})},expandURITemplate:function(d){if(!d)return d;var e=a.reduce(function(f,m){f[m.varname]=m.provider(m.varname);return f},{});return g.expand(d,e)},resolveVar:function(d){var e=a.find(function(f){return f.varname===d});return e?e.provider(d):void 0}}}();c.register("window.location",function(){return n.location.href});b(h).on("click","a.foundation-setter",function(a){a.preventDefault();n.location=
c.expandURITemplate(this.href)});b(h).on("foundation-contentloaded",function(a){b("input.foundation-setter",a.target).each(function(){this.value=c.resolveVar(b(this).data("foundationSetterVar"))})})})(window,document,Granite.$,Granite.URITemplate);
(function(n,h,b){function g(f,m){return f.querySelector(".shell-collection-sortby").items.getAll().find(function(p){return p.getAttribute("value")===m})}function c(f,m){return f.querySelector(".shell-collection-sortorder").items.getAll().find(function(p){return p.getAttribute("value")===m})}function a(f){var m=f.querySelector(".shell-collection-sortby"),p=f.querySelector(".shell-collection-sortorder"),k=p.querySelector(".shell-collection-sortorder \x3e button");return{getValues:function(){return{sortBy:m.selectedItem.getAttribute("value")||
null,sortOrder:p.selectedItem.getAttribute("value")||null}},setValues:function(t,l,q){var r=g(f,t),z=c(f,l);if(t&&l)if(r&&z)k.disabled=!1;else{k.disabled=!1;return}else r=g(f,null),z=c(f,"asc"),k.disabled=!0;r.selected||r.set("selected",!0,q);z.selected||z.set("selected",!0,q)}}}function d(f){if(e.has(f))return e.get(f);var m=Array.from(n.querySelectorAll(".shell-collection-sortcontainer")).find(function(p){return f.matches(p.dataset.shellCollectionTarget)});return m?(e.set(f,m),m):null}var e=new WeakMap;
h(n).on("coral-cyclebutton:change",".shell-collection-sortby, .shell-collection-sortorder",function(f){var m=this,p=m.closest(".shell-collection-sortcontainer");f=p.dataset.shellCollectionTarget;var k=n.querySelector(f);if(f&&k){f=h(k);k=a(p).getValues();var t=k.sortBy,l=k.sortOrder,q=f.adaptTo("foundation-collection-sort");p.sortTimeoutId&&clearTimeout(p.sortTimeoutId);p.sortTimeoutId=setTimeout(function(){delete p.sortTimeoutId;if(q.doSort(t,l)){var r={sortBy:t,sortOrder:l},z=m.matches(".shell-collection-sortby")?
"sortBy":"sortOrder";r={element:z,feature:"No feature defined",type:"sort",action:"click",widget:{name:z,type:"shell-sort"},attributes:r||{}};h(window).adaptTo("foundation-tracker").trackEvent(r)}},50)}});h(n).on("foundation-collection-sort:changed",".foundation-collection",function(){var f=d(this);if(f){if(this&&f){var m=h(this).adaptTo("foundation-collection-sort"),p=a(f);m=m.getSortValues();p.setValues(m.sortBy,m.sortOrder)}if(this&&f){var k=f.dataset.shellConsoleId;p=h(this).adaptTo("foundation-collection-sort").getSortValues();
k&&(m=k+"-sortName",k+="-sortDir",p.sortBy&&p.sortOrder?(h.cookie(m,p.sortBy,{expires:7,path:"/"}),h.cookie(k,p.sortOrder,{expires:7,path:"/"})):(h.removeCookie(m,{path:"/"}),h.removeCookie(k,{path:"/"})))}f[this.matches(".foundation-layout-table.foundation-collection")?"setAttribute":"removeAttribute"]("hidden","")}});h(n).on("foundation-collection-sort:beforeChange",".foundation-collection",function(){var f=h(this).adaptTo("shell-collection-sort");f&&f.clearCookie()});h(n).on("foundation-contentloaded",
function(f){f.target.querySelectorAll(".shell-collection-sortcontainer").forEach(function(m){var p=n.querySelector(m.dataset.shellCollectionTarget);p&&(e.set(p,m),m[p.matches(".foundation-layout-table.foundation-collection")?"setAttribute":"removeAttribute"]("hidden",""))})});h(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"shell-collection-sort",selector:".foundation-collection",adapter:function(f){var m=d(f);return m?{clearCookie:function(){if(f&&m){var p=m.dataset.shellConsoleId;
if(p){var k=p+"-sortDir";h.removeCookie(p+"-sortName",{path:"/"});h.removeCookie(k,{path:"/"})}}}}:null}})})(document,Granite.$,Coral);
(function(n,h,b){n=b(n);var g=n.adaptTo("foundation-util-keyboard");n.adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-command",selector:"button[data-foundation-command],a[data-foundation-command]",adapter:function(c){var a=b(c),d;return{enhanceUI:function(){if(!c.dataset.foundationCommandLabel){var e=c.textContent.trim();c.dataset.foundationCommandLabel=e}d||(e=g.normalize(this.getShortcut()),d=h.createElement("span"),d.classList.add("granite-command-inline"),d.textContent=
"("+e+")",c.label?c.label.appendChild(d):c.appendChild(d))},execute:function(){a.click()},getLabel:function(){return c.dataset.foundationCommandLabel||c.textContent.trim()},getShortcut:function(){return c.dataset.foundationCommand},isActive:function(){return a.is(":visible")}}}})})(window,document,Granite.$);
(function(n,h,b,g){function c(){a||(a=g.I18n.get("Error: Please fill out this field."));return a}var a;h.addEventListener("invalid",function(e){e.isJqueryValidator||(e.preventDefault(),e=b(e.target).closest(":-foundation-submittable").adaptTo("foundation-validation"),e.checkValidity(),e.updateUI())},!0);n=b(n).adaptTo("foundation-registry");n.register("foundation.validation.selector",{submittable:"input, textarea, select, button, object",candidate:"input:not([readonly]):not([disabled]):not([type\x3dhidden]):not([type\x3dreset]):not([type\x3dbutton]), select:not([disabled]), textarea:not([readonly]):not([disabled]), button:not([disabled]):not([type\x3dreset]):not([type\x3dbutton])"});
n.register("foundation.validation.selector",{submittable:"[role\x3dcheckbox], [role\x3dradio], [role\x3dcombobox], [role\x3dlistbox], [role\x3dradiogroup], [role\x3dtree], [role\x3dslider], [role\x3dspinbutton], [role\x3dtextbox]",candidate:"[role\x3dcheckbox]:not([aria-disabled\x3dtrue]), [role\x3dradio]:not([aria-disabled\x3dtrue]), [role\x3dcombobox]:not([aria-disabled\x3dtrue]), [role\x3dlistbox]:not([aria-disabled\x3dtrue]), [role\x3dradiogroup]:not([aria-disabled\x3dtrue]), [role\x3dtree]:not([aria-disabled\x3dtrue]), [role\x3dslider]:not([aria-disabled\x3dtrue]), [role\x3dspinbutton]:not([aria-disabled\x3dtrue]), [role\x3dtextbox]:not([aria-disabled\x3dtrue]):not([aria-readonly\x3dtrue])"});
n.register("foundation.validation.validator",{selector:"input, textarea, select",validate:function(e){var f=b(e);if((!0===e.required||void 0===e.required&&void 0!==f.attr("required")||"true"===f.attr("aria-required"))&&!(f.is("[type\x3dcheckbox], [type\x3dradio]")?e.checked:0<e.value.length))return c()}});var d=function(){var e=b(this).adaptTo("foundation-validation");e&&(e.checkValidity(),e.updateUI())};b(h).on("change","input, textarea",d);b(h).on("input","input, textarea",g.UI.Foundation.Utils.debounce(d,
500));n.register("foundation.validation.validator",{selector:"[role\x3dlistbox]",validate:function(e){e=b(e);if("true"===e.attr("aria-required")){var f=!1;e.find("[role\x3doption]").each(function(){if("true"===b(this).attr("aria-selected"))return f=!0,!1});if(!f)return c()}}})})(window,document,Granite.$,Granite);
(function(n,h){h(n).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-field",selector:"input, textarea, select",adapter:function(b){return{getName:function(){return b.name},setName:function(g){b.name=g},isDisabled:function(){return b.disabled},setDisabled:function(g){b.disabled=g},isInvalid:function(){return"true"===b.getAttribute("aria-invalid")},setInvalid:function(g){b.setAttribute("aria-invalid",g?"true":"false")},isRequired:function(){return"true"===b.getAttribute("aria-required")},
setRequired:function(g){b.setAttribute("aria-required",g?"true":"false")},getValue:function(){return"checkbox"===b.type||"radio"===b.type?b.checked?b.value:null:b.value},setValue:function(g){"checkbox"===b.type||"radio"===b.type?b.checked=b.value===g:b.value=g},getLabelledBy:function(){return b.getAttribute("aria-labelledby")},setLabelledBy:function(g){g?b.setAttribute("aria-labelledby",g):b.removeAttribute("aria-labelledby")},getValues:function(){return"SELECT"===b.tagName?Array.prototype.map.call(b.selectedOptions,
function(g){return g.value}):[this.getValue()]},setValues:function(g){"SELECT"===b.tagName?(Array.prototype.forEach.call(b.selectedOptions,function(c){c.selected=!1}),g.forEach(function(c){var a=Array.prototype.find.call(b.options,function(d){return d.value===c});a&&(a.selected=!0)})):"checkbox"===b.type||"radio"===b.type?b.checked=g.some(function(c){return b.value===c}):b.value=g[0]}}}});h(document).on("change","input, textarea, select",function(b){h(this).trigger("foundation-field-change")})})(window,
Granite.$);
(function(n,h,b){var g;h(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-field-mixed",selector:"input, textarea",adapter:function(c){var a=h(c);return{setMixed:function(d){d?(a.addClass("foundation-field-mixed"),d=a.attr,g||(g=b.I18n.get("\x3cMixed entries\x3e")),d.call(a,"placeholder",g)):(a.removeClass("foundation-field-mixed"),a.removeAttr("placeholder"))}}}});h(n).on("change",".foundation-field-mixed",function(){var c=h(this).adaptTo("foundation-field-mixed");c&&
c.setMixed(!1)})})(document,Granite.$,Granite);
(function(n,h,b){h(n).on("foundation-contentloaded",function(g){h("[data-datepicker-format]",g.target).each(function(){var e=h(this),f=e.data("datepicker-format");if(f){var m=e.text();m&&(m=b(m,["YYYY-MM-DD[T]HH:mm:ss.SSSZ","YYYY-MM-DD[T]HH:mm:ssZ",f]))&&e.replaceWith(m.format(f))}});var c=b().locale(n.documentElement.lang),a=c.utcOffset(),d=c.format("Z");h(".granite-datepicker-timezone",g.target).each(function(){var e=h(this);parseInt(e.attr("data-granite-datepicker-timezone-server"),10)===a?e.attr("hidden",
""):e.find(".granite-datepicker-timezone-client").text(d)})})})(document,Granite.$,moment);
(function(n,h,b){h(n).on("cui-contentloaded",function(d,e){e&&e._foundationcontentloaded||h(d.target).trigger("foundation-contentloaded",{_cuicontentloaded:!0})});h(n).on("foundation-contentloaded",function(d,e){e&&e._cuicontentloaded||h(d.target).trigger("cui-contentloaded",{_foundationcontentloaded:!0})});for(var g=["folder","hierarchy","hierarchyNotFile","nosystem"],c=function(d){return{name:"granite.ui.pathBrowser.pages."+d,handler:function(e,f){h.get(e+".pages.json",{predicate:d},function(m){m=
m.pages;for(var p=[],k=0;k<m.length;k++)p.push(m[k].label);f&&f(p)},"json");return!1}}},a=0;a<g.length;a++)CUI.PathBrowser.register("optionLoader",c(g[a]));h(n).on("foundation-contentloaded",function(d){h(".granite-autocomplete.coral-Autocomplete",d.target).each(function(){void 0===h(this).data("autocomplete")&&new CUI.Autocomplete({element:this,selectlistConfig:{loadData:function(e,f){var m=this.$element.attr("data-granite-autocomplete-src");if(m){e=b.expand(m,h.extend({},this.options.dataadditional,
{start:e,end:f}));var p=this,k=h.get(e);e=k.then(function(t){t=h(t);var l=t.filter("li").length;p.$element.append(t);return l<p.options.datapagesize});e.abort=function(){k.abort()};return e}}}})})});g=h(window).adaptTo("foundation-registry");g.register("foundation.adapters",{type:"foundation-field",selector:".coral-PathBrowser",adapter:function(d){d=h(d);var e=d.find(".js-coral-pathbrowser-input").adaptTo("foundation-field"),f=d.data("pathBrowser");return{getName:e.getName,setName:e.setName,isDisabled:function(){return!!f.get("disabled")},
setDisabled:function(m){f.set("disabled",m)},isInvalid:e.isInvalid,setInvalid:e.setInvalid,isRequired:e.isRequired,setRequired:e.setRequired,getValue:e.getValue,setValue:e.setValue,getLabelledBy:e.getLabelledBy,setLabelledBy:e.setLabelledBy,getValues:e.getValues,setValues:e.setValues}}});h(n).on("change",".js-coral-pathbrowser-input",function(d){h(this).closest(".coral-PathBrowser").trigger("foundation-field-change")});g.register("foundation.adapters",{type:"foundation-field",selector:".coral-Autocomplete:not(coral-autocomplete)",
adapter:function(d){var e=h(d),f=e.find(".js-coral-Autocomplete-textfield").adaptTo("foundation-field"),m=e.data("autocomplete");return{getName:f.getName,setName:function(p){var k=f.getName();e.children(".foundation-field-related").each(function(){this.name.startsWith(k+"@")&&(this.name=p+this.name.substring(k.length))});f.setName(p)},isDisabled:function(){return!!m.get("disabled")},setDisabled:function(p){m.set("disabled",p);e.children(".foundation-field-related").prop("disabled",p)},isInvalid:f.isInvalid,
setInvalid:f.setInvalid,getLabelledBy:f.getLabelledBy,setLabelledBy:f.setLabelledBy,isRequired:function(){return"true"===d.getAttribute("aria-required")},setRequired:function(p){d.setAttribute("aria-required",p?"true":"false")},getValue:function(){return m.options.multiple?m.getValue()[0]:m.getValue()},setValue:function(p){m.options.multiple?(m.clear(),m._tagListWidget.addItem({value:p,display:p})):f.setValue(p)},getValues:function(){return m.options.multiple?m.getValue():[m.getValue()]},setValues:function(p){m.options.multiple?
(m.clear(),m._tagListWidget.addItem(p.map(function(k){return{value:k,display:k}}))):f.setValues(p)}}}});h(n).on("change:value",".coral-Autocomplete:not(coral-autocomplete)",function(d){h(this).trigger("foundation-field-change")});h(n).on("change",".js-coral-Autocomplete-textfield",function(d){h(this).closest(".coral-Autocomplete").trigger("foundation-field-change")})})(document,Granite.$,Granite.URITemplate);
(function(n,h,b){n=b(n);var g=n.adaptTo("foundation-util-keyboard");n.adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-command",selector:"coral-cyclebutton-item[data-foundation-command]",adapter:function(c){var a=b(c),d=a.closest("coral-cyclebutton"),e;return{enhanceUI:function(){if(!c.dataset.foundationCommandLabel){var f=c.textContent.trim();c.dataset.foundationCommandLabel=f}e||(f=g.normalize(this.getShortcut()),e=h.createElement("span"),e.classList.add("granite-command-alignRight"),
e.textContent=f,c.content?c.content.insertBefore(e,c.content.firstChild):c.insertBefore(e,c.firstChild))},execute:function(){c.hasAttribute("selected")?d[0].items.first().setAttribute("selected",!0):c.setAttribute("selected",!0)},getLabel:function(){return c.dataset.foundationCommandLabel||c.textContent.trim()},getShortcut:function(){return c.dataset.foundationCommand},isActive:function(){return d.is(":visible")&&!a.prop("hidden")&&!a.prop("disabled")}}}})})(window,document,Granite.$);
(function(n,h){n=h(n).adaptTo("foundation-registry");n.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-dialog.foundation-toggleable",adapter:function(b){var g=h(b);g.on("coral-overlay:beforeopen",function(c){c.target===b&&g.trigger("foundation-toggleable-beforeshow")});g.on("coral-overlay:open",function(c){c.target===b&&g.trigger("foundation-toggleable-show")});g.on("coral-overlay:close",function(c){c.target===b&&g.trigger("foundation-toggleable-hide")});return{isOpen:function(){return b.open},
show:function(c){b.show()},hide:function(){b.hide()}}}});n.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-popover.foundation-toggleable, coral-overlay.foundation-toggleable",adapter:function(b){var g=h(b),c="coral-popover"===b.tagName.toLowerCase(),a=function(e){27===(e.which||e.keyCode)&&b.open&&b._isTopOverlay()&&(e.preventDefault(),b.hide())},d=function(e){var f=b._getTarget();!f||f.contains(e.target)||b.contains(e.target)||b.hide()};g.on("coral-overlay:open",function(e){e.target===
b&&g.trigger("foundation-toggleable-show")});g.on("coral-overlay:close",function(e){e.target===b&&(c&&(document.removeEventListener("click",d,!0),b.removeEventListener("keydown",a)),g.trigger("foundation-toggleable-hide"))});return{isOpen:function(){return b.open},show:function(e){e instanceof Element&&(b.target=e,c&&(b.interaction="off",document.addEventListener("click",d,!0),b.addEventListener("keydown",a)),b.show())},hide:function(){b.hide()}}}});n.register("foundation.adapters",{type:"foundation-toggleable",
selector:"coral-panel.foundation-toggleable",adapter:function(b){var g=h(b);return{isOpen:function(){return b.selected},show:function(c){b.selected=!0;g.trigger("foundation-toggleable-show")},hide:function(){b.selected=!1;g.trigger("foundation-toggleable-hide")}}}})})(window,Granite.$);
(function(n,h,b,g){function c(){k||(k=Granite.I18n.get("Error: Please fill out this field."));return k}function a(l){if(l=l.adaptTo("foundation-validation"))l.checkValidity(),l.updateUI()}function d(l){var q=h(l);l=q.closest(".coral-Form-field");(q=q.adaptTo("foundation-field"))&&q.setInvalid&&q.setInvalid(!1);var r=l.data("foundation-validation.internal.error");if(r){var z=h(r).data("foundation-validation.internal.error.tooltip"),u=h(r).data("foundation-validation.internal.error.label");z&&(z.hide(),
z.remove());u&&u.remove();r.remove();r=f(q);var w=z?z.id:u.id;r&&-1!==r.indexOf(w)&&(z=r.split(" ").filter(function(A){return A!==w}).join(" "),q&&q.setLabelledBy&&q.setLabelledBy(z))}e(l,!0)}function e(l,q){q?(l.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly"),l.nextAll(".coral-Form-fieldinfo").map(function(r,z){z.setAttribute("tabindex",0)})):(l.nextAll(".coral-Form-fieldinfo").addClass("u-coral-screenReaderOnly"),l.nextAll(".coral-Form-fieldinfo").map(function(r,z){z.setAttribute("tabindex",
1)}))}function f(l){if(l&&l.getLabelledBy)return l.getLabelledBy()}function m(l,q){if(null!==l.valueAsDate&&null!==q.valueAsDate&&l.valueAsDate.getTime()>=q.valueAsDate.getTime())return Granite.I18n.get("The date is not before {0}.",g(q.valueAsDate).format(q.displayFormat))}function p(l,q){if(null!==q.valueAsDate&&null!==l.valueAsDate&&q.valueAsDate.getTime()>=l.valueAsDate.getTime())return Granite.I18n.get("The date is not after {0}.",g(q.valueAsDate).format(q.displayFormat))}var k,t=Granite.UI.Foundation.Utils.debounce;
n=h(n).adaptTo("foundation-registry");n.register("foundation.validation.validator",{selector:".coral-Form-fieldwrapper .coral-Form-field, .coral-Form-fieldwrapper .coral-Form-field.coral-InputGroup .coral-InputGroup-input, .coral-Form-fieldwrapper .coral-Form-field.coral-DecoratedTextfield .coral-DecoratedTextfield-input, .coral-Form-fieldwrapper .coral-Form-field.coral-PathBrowser .js-coral-pathbrowser-input, .coral-Form-fieldwrapper .coral-Form-field.coral-Checkbox .coral-Checkbox-input, .coral-Form-fieldwrapper .coral-Form-field.coral-Switch .coral-Switch-input, .coral-Form-fieldwrapper .coral-Form-field.coral-Select .coral-Select-select, .coral-Form-fieldwrapper .coral-Form-field.coral-FileUpload .coral-FileUpload-input",
show:function(l,q){var r=h(l);l=r.closest(".coral-Form-field");var z=l.closest(".foundation-form, .coral-Form").hasClass("coral-Form--vertical");(r=r.adaptTo("foundation-field"))&&r.setInvalid&&r.setInvalid(!0);e(l,!1);var u=l.data("foundation-validation.internal.error");if(!u){u=new b.Icon;u.icon="alert";u.classList.add("coral-Form-fielderror");var w=document.createElement("label");w.classList.add("coral-Form-errorlabel");w.id=b.commons.getUID();w.setAttribute("tabindex",0);h(u).data("foundation-validation.internal.error.label",
w);w=new b.Tooltip;w.variant="error";w.placement="bottom";w.target=u;w.id=b.commons.getUID();w.setAttribute("aria-hidden","true");h(u).data("foundation-validation.internal.error.tooltip",w);l.data("foundation-validation.internal.error",u)}if(z){if(z=h(u).data("foundation-validation.internal.error.label")){z.innerHTML=q;var A=z}}else if(z=h(u).data("foundation-validation.internal.error.tooltip"))z.content.innerHTML=q,A=z;!u.parentNode&&A&&(z=f(r),w=A.id,r&&r.setLabelledBy&&r.setLabelledBy(z?z+" "+
w:w),l.after(u,A),u.setAttribute("aria-describedby",A.id),u.setAttribute("tabindex",0),u.alt=q)},clear:function(l){d(l)}});n.register("foundation.validation.validator",{selector:"input[type\x3dpassword]",validate:function(l){var q=h(l);if(l.value){var r=l.getAttribute("data-granite-password-retype");if(r)q=q.closest("form").find("input[type\x3dpassword]").filter(function(){return this.name===r}),q.val()&&a(q);else{var z=!0;q.closest("form").find("input[type\x3dpassword][data-granite-password-retype]").each(function(){if((r=
this.getAttribute("data-granite-password-retype"))&&r===l.name&&this.value&&this.value!==l.value)return z=!1});if(!z)return Granite.I18n.get("Passwords do not match!")}}}});n.register("foundation.validation.selector",{submittable:"coral-checkbox, coral-radio, coral-switch",candidate:"coral-checkbox:not([readonly]):not([disabled]), coral-radio:not([readonly]):not([disabled]), coral-switch:not([readonly]):not([disabled])",exclusion:"coral-checkbox *, coral-radio *, coral-switch *"});n.register("foundation.validation.validator",
{selector:"coral-checkbox, coral-radio, coral-switch",validate:function(l){if(l.required&&!l.checked)return c()}});n.register("foundation.validation.selector",{submittable:"coral-datepicker, coral-numberinput, coral-slider, coral-colorinput",candidate:"coral-datepicker:not([readonly]):not([disabled]), coral-numberinput:not([readonly]):not([disabled]), coral-slider:not([readonly]):not([disabled]), coral-colorinput:not([readonly]):not([disabled])",exclusion:"coral-datepicker *, coral-numberinput *, coral-slider *, coral-colorinput *"});
n.register("foundation.validation.validator",{selector:"coral-slider, coral-colorinput",validate:function(l){if(l.required&&0===l.value.length)return c()}});n.register("foundation.validation.validator",{selector:"coral-numberinput",validate:function(l){if(l.required&&!l.value)return c();if(null!==l.max&&l.valueAsNumber>l.max)return Granite.I18n.get("Please enter a value that is no more than {0}.",[l.max],"{0}\x3dmax number");if(null!==l.min&&l.valueAsNumber<l.min)return Granite.I18n.get("Please enter a value that is no less than {0}.",
[l.min],"{0}\x3dmin number");var q;if(q=!isNaN(l.step)&&!isNaN(l.valueAsNumber)){q=l.valueAsNumber;var r=l.step;if(r){var z=q.toString().split("."),u=r.toString().split(".");z=z[1]&&z[1].length||0;u=u[1]&&u[1].length||0;0===z&&0===u?q=0===q%r:(u=z>u?z+1:u+1,q=0===Math.round(q*Math.pow(10,u+1))%Math.round(r*Math.pow(10,u+1)))}else q=!0;q=!q}if(q)return Granite.I18n.get("Please enter a value that is a multiple of {0}.",[l.step],"{0}\x3dstep")}});n.register("foundation.validation.validator",{selector:"coral-datepicker",
validate:function(l){if(l.required&&0===l.value.length)return c();var q=h(l),r,z=l.getAttribute("data-granite-datepicker-before");if(z&&(h(z).each(function(){if(r=p(l,this))return!1}),r))return r;if(z=l.getAttribute("data-granite-datepicker-after"))if(h(z).each(function(){if(r=m(l,this))return!1}),r)return r;h("coral-datepicker[data-granite-datepicker-before]").each(function(){q.is(this.getAttribute("data-granite-datepicker-before"))&&(r=m(l,this))&&a(h(this))});h("coral-datepicker[data-granite-datepicker-after]").each(function(){q.is(this.getAttribute("data-granite-datepicker-after"))&&
(r=p(l,this))&&a(h(this))})}});n.register("foundation.validation.selector",{submittable:"coral-autocomplete, coral-select, coral-taglist, coral-fileupload, coral-buttongroup",candidate:"coral-autocomplete:not([readonly]):not([disabled]), coral-select:not([readonly]):not([disabled]), coral-taglist:not([readonly]):not([disabled]), coral-fileupload:not([readonly]):not([disabled]), coral-buttongroup:not([readonly]):not([disabled])",exclusion:"coral-autocomplete *, coral-select *, coral-taglist *, coral-fileupload *, coral-buttongroup *"});
n.register("foundation.validation.validator",{selector:"coral-autocomplete, coral-select, coral-taglist, coral-fileupload, coral-buttongroup",validate:function(l){if(l.required&&(0===l.values.length||1===l.values.length&&""===l.value))return c()}});n.register("foundation.validation.selector",{submittable:"coral-multifield",candidate:"coral-multifield",exclusion:"[coral-multifield-template], [coral-multifield-template] *"});n.register("foundation.validation.validator",{selector:"coral-multifield",
validate:function(l){if("true"===l.getAttribute("aria-required")&&0===l.items.getAll().length)return c()}});h(document).on("change","coral-autocomplete, coral-checkbox, coral-switch, coral-datepicker, coral-numberinput, coral-colorinput, coral-radio, coral-select, coral-slider, coral-taglist, coral-multifield, coral-fileupload, coral-buttongroup",function(l){a(h(this))});h(document).on("input","coral-datepicker input[handle], coral-numberinput input[handle], coral-colorinput input[handle]",t(function(l){a(h(this).closest("coral-datepicker, coral-numberinput, coral-colorinput"))},
500));n.register("foundation.validation.selector",{submittable:".coral-RadioGroup",candidate:".coral-RadioGroup",exclusion:".coral-RadioGroup *"});n.register("foundation.validation.validator",{selector:".coral-RadioGroup",validate:function(l){l=h(l);if("true"===l.attr("aria-required")){var q=l.find("coral-radio");if(q.length){if(0===q.filter("[checked]").length)return c()}else if(0===l.find("\x3e * \x3e :checked").length)return c()}}});h(document).on("change",".coral-RadioGroup",function(l){a(h(this))});
n.register("foundation.validation.selector",{submittable:".coral-Autocomplete:not(coral-autocomplete)",candidate:".coral-Autocomplete:not(coral-autocomplete)",exclusion:".coral-Autocomplete:not(coral-autocomplete) *"});n.register("foundation.validation.validator",{selector:".coral-Autocomplete:not(coral-autocomplete)",validate:function(l){l=h(l);if("true"===l.attr("aria-required")&&0===l.data("autocomplete").getValue().length)return c()}});h(document).on("change:value",".coral-Autocomplete:not(coral-autocomplete)",
function(l){a(h(this))});n=function(l){l=h(this).closest(".coral-Autocomplete");l.data("autocomplete").options.multiple||a(l)};h(document).on("change",".js-coral-Autocomplete-textfield",n);h(document).on("input",".js-coral-Autocomplete-textfield",t(n,500));h(document).on("foundation-validation-invalid","coral-panel",function(l){var q=h(this),r=q.parent().parent("coral-tabview")[0];r&&requestAnimationFrame(function(){var z=r.tabList.items.getAll()[q.index()];z&&(z.invalid=!0);z=l.target;var u=q.data("coral-tabview.internal.invalids");
void 0===u&&(u=[],q.data("coral-tabview.internal.invalids",u));0>u.indexOf(z)&&u.push(z)})});h(document).on("foundation-validation-valid","coral-panel",function(l){var q=h(this),r=q.parent().parent("coral-tabview")[0];r&&requestAnimationFrame(function(){var z=r.tabList.items.getAll()[q.index()],u=function(){z&&q.adaptTo("foundation-validation-helper").isValid()&&(z.invalid=!1)},w=q.data("coral-tabview.internal.invalids");if(w){var A=w.indexOf(l.target);0<=A&&w.splice(A,1);if(0===w.length)u();else{A=
!1;for(var x=w.length;x--;){if(q.has(w[x]).length){A=!0;break}w.splice(x,1)}A||u()}}else u()})})})(window,Granite.$,Coral,moment);
(function(n,h,b){var g=b(n).adaptTo("foundation-registry");h=b(h);var c="input[is\x3d'coral-textfield'] textarea[is\x3d'coral-textarea'] coral-checkbox coral-radio coral-switch coral-datepicker coral-numberinput coral-slider coral-colorinput coral-calendar coral-autocomplete coral-select coral-taglist coral-fileupload coral-buttongroup".split(" ");g.register("foundation.adapters",{type:"foundation-field",selector:c.join(","),adapter:function(a){var d=b(a);return{getName:function(){return a.name},
setName:function(e){d.nextAll(".foundation-field-related").add(d.children(".foundation-field-related")).each(function(){var f=a.name;this.name.startsWith(f+"@")&&(this.name=e+this.name.substring(f.length))});a.name=e},isDisabled:function(){return a.disabled},setDisabled:function(e){a.disabled=e;d.nextAll(".foundation-field-related").add(d.children(".foundation-field-related")).prop("disabled",e)},isReadOnly:function(){return a.readOnly},setReadOnly:function(e){a.readOnly=e;d.nextAll(".foundation-field-related").add(d.children(".foundation-field-related")).prop("readOnly",
e)},isInvalid:function(){return a.hasAttribute("invalid")},setInvalid:function(e){e?a.setAttribute("invalid",""):a.removeAttribute("invalid")},isRequired:function(){return b(a).is("input, textarea")?"true"===a.getAttribute("aria-required"):a.required},setRequired:function(e){b(a).is("input, textarea")?a.setAttribute("aria-required",e?"true":"false"):a.required=e},getValue:function(){return b(a).is("coral-checkbox, coral-radio, coral-switch")?a.checked?a.value:null:a.value},setValue:function(e){if(b(a).is("coral-checkbox, coral-radio, coral-switch"))a.checked=
a.value===e;else if(b(a).is("coral-fileupload"))try{a.value=e}catch(f){console.error(f)}else a.value=e},getLabelledBy:function(){return a.labelledBy},setLabelledBy:function(e){a.labelledBy=e},getValues:function(){return b(a).is("coral-checkbox, coral-radio, coral-switch")?[this.getValue()]:"values"in a?a.values:[a.value]},setValues:function(e){b(a).is("coral-checkbox, coral-radio, coral-switch")?a.checked=e.some(function(f){return a.value===f}):"values"in a?a.values=e:a.value=e[0]}}}});g.register("foundation.adapters",
{type:"foundation-field",selector:"coral-multifield",adapter:function(a){var d=b(a);return{getName:function(){return a.getAttribute("data-granite-coral-multifield-name")||""},setName:function(e){a.setAttribute("data-granite-coral-multifield-name",e)},isDisabled:function(){return d.children("[coral-multifield-add]").prop("disabled")||!1},setDisabled:function(e){d.find("\x3e coral-multifield-item \x3e coral-multifield-item-content").each(function(){b(this.parentNode).children("[handle\x3d'remove'], [handle\x3d'move']").prop("disabled",
e);var f=b(this.firstElementChild).adaptTo("foundation-field");f&&"setDisabled"in f&&f.setDisabled(e)});d.children("[coral-multifield-add], .foundation-field-related").prop("disabled",e)},isInvalid:function(){return"true"===a.getAttribute("aria-invalid")},setInvalid:function(e){a.setAttribute("aria-invalid",e?"true":"false")},isRequired:function(){return"true"===a.getAttribute("aria-required")},setRequired:function(e){a.setAttribute("aria-required",e?"true":"false")},getValue:function(){var e=d.find("\x3e coral-multifield-item \x3e coral-multifield-item-content \x3e :first-child").first().adaptTo("foundation-field");
return e&&"getValue"in e?e.getValue():null},setValue:function(e){this.setValues([e])},getLabelledBy:function(){return a.getAttribute("aria-labelledby")},setLabelledBy:function(e){e?a.setAttribute("aria-labelledby",e):a.removeAttribute("aria-labelledby")},getValues:function(){return Array.prototype.map.call(d.find("\x3e coral-multifield-item \x3e coral-multifield-item-content"),function(e){return(e=b(e.firstElementChild).adaptTo("foundation-field"))&&"getValue"in e?e.getValue():null})},setValues:function(e){for(var f,
m=a.items.getAll(),p=m.length,k=e.length,t=0;t<k;t++)f=m[t],"undefined"===typeof f&&(f=a.items.add(new Coral.Multifield.Item)),n.CustomElements.upgrade(f),f.content.firstChild||a._renderTemplate(f),(f=b(f.content.firstElementChild).adaptTo("foundation-field"))&&"setValue"in f&&f.setValue(e[t]);for(e=k;e<p;e++)a.items.remove(m[e])}}}});h.on("change",c.concat("coral-multifield").join(","),function(a){b(this).trigger("foundation-field-change")});g.register("foundation.adapters",{type:"foundation-field",
selector:".coral-RadioGroup",adapter:function(a){var d=b(a);return{getName:function(){return d.children("coral-radio").first().prop("name")||""},setName:function(e){var f=d.children("coral-radio"),m=f.first().prop("name");f.prop("name",e);"undefined"!==typeof m&&d.children(".foundation-field-related").each(function(){this.name.startsWith(m+"@")&&(this.name=e+this.name.substring(m.length))})},isDisabled:function(){var e=d.children("coral-radio");return 0===e.length?!1:Array.prototype.every.call(e,
function(f){return f.disabled})},setDisabled:function(e){d.children("coral-radio, .foundation-field-related").prop("disabled",e)},isInvalid:function(){return"true"===a.getAttribute("aria-invalid")},setInvalid:function(e){a.setAttribute("aria-invalid",e?"true":"false")},isRequired:function(){return"true"===a.getAttribute("aria-required")},setRequired:function(e){a.setAttribute("aria-required",e?"true":"false")},getValue:function(){var e=Array.prototype.reduce.call(d.children("coral-radio"),function(f,
m){m.checked&&f.push(m.value);return f},[]);return e.length?e[0]:null},setValue:function(e){d.children("coral-radio").each(function(){return this.value===e?this.checked=!0:!1})},getLabelledBy:function(){var e=d.children("coral-radio");return 0<e.length?e[0].labelledBy:null},setLabelledBy:function(e){d.children("coral-radio").each(function(){this.labelledBy=e})},getValues:function(){return Array.prototype.reduce.call(d.children("coral-radio"),function(e,f){f.checked&&e.push(f.value);return e},[])},
setValues:function(e){var f=d.children("coral-radio");e.forEach(function(m){f.each(function(){if(this.value===m)return f=f.not(this),this.checked=!0,!1})})}}}});h.on("change","coral-radio",function(a){b(this).parent(".coral-RadioGroup").trigger("foundation-field-change")})})(window,document,Granite.$);
(function(n,h,b){function g(){c||(c=b.I18n.get("\x3cMixed entries\x3e"));return c}var c;n=h(window).adaptTo("foundation-registry");n.register("foundation.adapters",{type:"foundation-field-mixed",selector:"coral-datepicker",adapter:function(a){return{setMixed:function(d){d?(a.classList.add("foundation-field-mixed"),a.placeholder=g()):(a.classList.remove("foundation-field-mixed"),a.placeholder="")}}}});n.register("foundation.adapters",{type:"foundation-field-mixed",selector:"[data-init\x3d'pathbrowser']",
adapter:function(a){var d=h(a).data("pathBrowser");return{setMixed:function(e){e?(d.$element.addClass("foundation-field-mixed"),d.$element.attr("placeholder",g())):(d.$element.removeClass("foundation-field-mixed"),d.$element.removeAttr("placeholder"))}}}});n.register("foundation.adapters",{type:"foundation-field-mixed",selector:"coral-checkbox",adapter:function(a){return{setMixed:function(d){d?a.classList.add("foundation-field-mixed"):a.classList.remove("foundation-field-mixed")}}}});n.register("foundation.adapters",
{type:"foundation-field-mixed",selector:".js-cq-TagsPickerField[data-init\x3d'pathbrowser']",adapter:function(a){return{setMixed:function(d){}}}})})(document,Granite.$,Granite);
(function(n,h){function b(a,d){Array.from(a.children).forEach(function(e){h(e).is(":-foundation-submittable")?d(e):b(e,d)})}function g(a,d){var e=h(a),f=a.matches("coral-multifield[data-granite-coral-multifield-composite]"),m=e.adaptTo("foundation-field").getName(),p=d||m;p&&a.items.getAll().forEach(function(k,t){p=d||m;p=f?p+"/item"+t+"/":p;b(k,function(l){var q=h(l),r=q.adaptTo("foundation-field");if(r){if(!r.setName)throw Error("The field doesn't support FoundationField#setName");var z=q.data("cachedName");
z||(z=r.getName(),q.data("cachedName",z));z&&(q=p+z,r.setName(q),l.matches("coral-multifield")&&(l.matches("coral-multifield[data-granite-coral-multifield-composite]")?g(l,q):g(l,p)))}})})}function c(a){var d=h(a).adaptTo("foundation-field"),e=Coral.transform.string(d.getLabelledBy());a.items.getAll().forEach(function(f,m){b(f,function(p){var k=h(p).adaptTo("foundation-field");k&&k.setLabelledBy&&k.getLabelledBy&&!k.getLabelledBy()&&(p.id=p.id||Coral.commons.getUID(),k.setLabelledBy(e+" "+f.id+" "+
p.id),p.matches("coral-multifield")&&c(p))})})}h(document).on("coral-collection:change","coral-multifield",function(a){0<(a.detail.addedItems||[]).length&&this===a.target&&Coral.commons.nextFrame(function(){h(this).trigger("foundation-contentloaded")}.bind(this))});h(document).on("coral-collection:change coral-multifield:itemorder","coral-multifield[data-granite-coral-multifield-composite]",function(a){"coral-multifield:itemorder"===a.type&&(a=Coral.commons.getUID(),g(this,a));g(this,"")});h(document).on("foundation-contentloaded",
function(a){var d=Array.from(a.target.querySelectorAll("coral-multifield"));"function"===typeof a.target.matches&&a.target.matches("coral-multifield")&&d.push(a.target);for(a=0;a<d.length;a++)Coral.commons.ready(d[a],function(e){e.matches("coral-multifield[data-granite-coral-multifield-composite]")&&g(e,"");c(e)})})})(window,Granite.$);
(function(n,h,b){b(n).on("foundation-mode-change",function(g,c,a){"default"!==c&&"edit"!==c||b(".foundation-layout-form").each(function(){var d=b(this);if(a===d.data("foundationModeGroup")){var e="edit"===c;d.toggleClass("foundation-layout-form-mode-edit",e).toggleClass("foundation-layout-form-mode-default",!e)}})})})(document,window,Granite.$);
(function(n,h,b,g,c,a){function d(E){return E.matches(".foundation-collection-item.is-lazyLoaded, .foundation-collection-item.is-pending")}function e(E){return E.classList.contains("foundation-collection-item")}function f(E){return"true"===E.dataset.foundationSelectionsSelectallMode}function m(E){return E===ia.SELECTION?!0:!1}function p(E){return Array.prototype.filter.call(E,function(M){return!(M.removing||M.hasAttribute("_removing")||M.classList.contains("is-removing")||!M.parentNode)})}function k(E){E=
E.querySelectorAll(".foundation-collection \x3e .foundation-collection-item");return p(E)}function t(E){return k(E).filter(function(M){return M.matches(".foundation-selections-item")})}function l(E){return k(E).filter(function(M){return M.matches(":not(.foundation-selections-item)")})}function q(E){return l(E).filter(function(M){return!d(M)})}function r(E){return k(E).filter(function(M){return M.matches(".is-lazyLoaded, .is-pending")})}function z(E,M){E=q(E);w(E,M)}function u(E,M){var N=r(E);if(N.length){var I=
U(h.createElement("div")).addClass("foundation-ui-mask").append('\x3ccoral-wait size\x3d"L" centered\x3e\x3c/coral-wait\x3e').appendTo(h.body);N=x(E,N).then(function(Q){w(Q,M)}).always(function(){I.remove()});z(E,M);return N}z(E,M);return U.Deferred().resolve().promise()}function w(E,M){0!==E.length&&Array.prototype.forEach.call(E,function(N,I,Q){I!==Q.length-1||M?N.set("selected",!0,!0):N.selected=!0;N.classList.add("foundation-selections-item")})}function A(E,M){0!==E.length&&Array.prototype.forEach.call(E,
function(N,I,Q){I!==Q.length-1||M?N.set("selected",!1,!0):N.selected=!1;N.classList.remove("foundation-selections-item")})}function x(E,M){return(E=(E=aa.get(E))&&E.lazyLoader?E.lazyLoader:null)?E.loadItems(M):U.Deferred().resolve().promise()}function L(E,M){var N=(new DOMParser).parseFromString(E,"text/html"),I=N.body.querySelector(".foundation-layout-masonry.foundation-collection");I&&M&&(E=k(I).filter(function(Q){return!d(Q)}).reduce(function(Q,R){return Q+R.outerHTML},""),I.innerHTML=E,E=N.head.innerHTML+
N.body.innerHTML);return E}function H(E,M,N,I,Q){M=N.trackingElement;I&&I.dataset.foundationCollectionItemId&&(M=N.trackingElement||I.dataset.foundationCollectionItemId);E={element:M||"No element defined",type:"change"===E?"masonry-item":"masonry",action:E,widget:{name:N.trackingElement||N.name||"foundation-layout-masonry",type:"masonry"},feature:N.trackingFeature||"No feature defined",attributes:Q||{}};U(n).adaptTo("foundation-tracker").trackEvent(E)}function T(E){var M=function(N,I,Q){N._foundationLayoutMasonry||
(N=I===ia.SELECTION||I===ia.DEFAULT?!0:!1,N&&E.collectionEl.dataset.foundationModeGroup===Q&&O(E,I))};U(h).on("foundation-mode-change",M);return function(){U(h).off("foundation-mode-change",M)}}function D(E){var M=E.collection,N=function(I){var Q=I.originalEvent.detail,R=Q.item,ea=R.dragAction.dropZone;I=Q.before;var da=Q.oldBefore;if(Q=E.config.itemReorderAction){var W=I?I.dataset.foundationCollectionItemId:void 0;I=W?W.substring(W.lastIndexOf("/")+1):void 0;Q=I=a.expand(Q,{item:R.dataset.foundationCollectionItemId,
before:W,beforeName:I});var v=I.indexOf("?");if(0<=v){Q=I.substring(0,v);var y=I.substring(v+1)}var G=U(n).adaptTo("foundation-ui");G.wait();U.ajax({url:Q,method:"POST",data:y}).always(function(){G.clearWait();H("order",M,E.config,R,{before:W})}).fail(function(C,B,K){C=b.I18n.get("Error");B=b.I18n.get("Fail to reorder.");H("order-error",M,E.config,R,{before:W,errorMsg:K});G.alert(C,B,"error");da?U(R).insertBefore(da.nextSibling):U(R).insertBefore(ea.firstChild)})}};M.on("coral-masonry:order",N);return function(){M.off("coral-masonry:order",
N)}}function F(E){var M=E.collectionEl,N=function(I){I.preventDefault();I.stopImmediatePropagation()};M.addEventListener("coral-dragaction:dragend",N,!0);return function(){M.removeEventListener("coral-dragaction:dragend",N,!0)}}function J(E){var M=E.collection,N=E.collectionEl,I=function(W){var v=W[0],y=!W.hasClass("foundation-selections-item");W=M.adaptTo("foundation-selections");y?("single"===N.dataset.foundationSelectionsMode&&(y=t(N),A(y,void 0)),W.select(v)):W.deselect(v)},Q=function(W){var v=
U(W.target).closest(".foundation-collection, .foundation-collection-item, coral-quickactions");v.hasClass("foundation-collection-item")&&m(E.mode)&&(W.preventDefault(),W.stopPropagation(),v.data("foundation-layout-collection-item.internal.avoidSelection")?v.removeData("foundation-layout-collection-item.internal.avoidSelection"):I(v))},R=function(W){var v=c.Keys.keyToCode("space");W.keyCode===v&&(v=U(W.target),v.is("coral-masonry-item")&&(W.preventDefault(),I(v)))},ea=function(){(h.activeElement===
N||N.contains(h.activeElement))&&M.adaptTo("foundation-selections").clear()},da=new (U(n).adaptTo("foundation-util-gesture-longpress"))({el:N,selector:"coral-masonry-item",validate:function(){return!m(E.mode)},perform:function(W){M.adaptTo("foundation-selections").select(W);U(W).data("foundation-layout-collection-item.internal.avoidSelection",!0)}});N.addEventListener("click",Q,!0);M.on("keydown","coral-masonry-item.foundation-collection-item",R);c.keys.on("escape",ea);da.start();return function(){N.removeEventListener("click",
Q,!0);M.off("keydown","coral-masonry-item.foundation-collection-item",R);c.keys.off("escape",ea);da.destroy()}}function O(E,M,N){var I=E.collection,Q=m(M);E.mode!==M&&(N||Q||I.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",!1),E.mode=M,M===ia.SELECTION?I.addClass("is-selectable"):I.removeClass("is-selectable"),c.commons.nextFrame(function(){I.parent("[role\x3d'grid']").attr("aria-multiselectable","multiple"===I.context.selectionMode)}),N&&(E=E.collectionEl.dataset.foundationModeGroup))&&
(N=U.Event("foundation-mode-change"),N._foundationLayoutMasonry=!0,I.trigger(N,[M,E]))}function S(E){var M,N=E.collection,I=E.collectionEl,Q=I.dataset.foundationCollectionSrc;if(Q){var R=k(I).length,ea="false"!==I.dataset.foundationLayoutMasonryHasmore,da=E.config.scrollSrc?N.closest(E.config.scrollSrc):N.parent(),W=U(n).adaptTo("foundation-util-paginator"),v=E.paginator=new W({el:da[0],limit:E.config.limit||20,size:E.config.size,wait:function(){I.dataset.graniteCollectionIsLoading="true";return{clear:function(){v.isLoading||
(I.dataset.graniteCollectionIsLoading="false")}}},resolveURL:function(y){var G=N.adaptTo("foundation-collection-sort").getSortValues(),C=f(I)?y.limit:y.size;return a.expand(Q,{offset:y.offset,limit:y.limit,size:C,id:I.dataset.foundationCollectionId,sortName:G.sortBy,sortDir:G.sortOrder})},processResponse:function(y,G){var C=U.Deferred();U(n).adaptTo("foundation-util-htmlparser").parse(G).then(function(B){var K=B.querySelector(".foundation-collection");K&&(B=k(K),M=U.Deferred(),V(E,B,M.promise()),
K=K.dataset.foundationLayoutMasonryHasmore,K="true"===K?!0:"false"===K?!1:B.length>=y.limit,I.dataset.graniteCollectionIsLoading="false",C.resolve({length:B.length,hasNext:K}))});return C.promise()},onNewPage:function(){N.trigger("foundation-collection-newpage");H("newpage",N,E.config);M.resolve()}});I.scrollContainer=da[0];v.start(R,ea,!1,500);return function(){v.destroy()}}}function P(E){var M=E.collection,N=E.collectionEl,I=N.dataset.foundationCollectionSrc;if(I){var Q=U(n).adaptTo("foundation-collection-lazyloader"),
R=E.config.scrollSrc?M.closest(E.config.scrollSrc):M.parent(),ea=E.lazyLoader=new Q({scrollSrc:R[0],getItems:function(){return k(N)},load:function(da,W){da=M.adaptTo("foundation-collection-sort").getSortValues();W=a.expand(I,{offset:W.offset,limit:W.limit,size:W.size,id:N.dataset.foundationCollectionId,sortName:da.sortBy,sortDir:da.sortOrder});return U.ajax(W).then(function(v){return U(n).adaptTo("foundation-util-htmlparser").parse(L(v,!0)).then(function(y){if(y=y.querySelector(".foundation-collection"))return k(y)})})},
onReplace:function(){Z(M);M.trigger("foundation-contentloaded")},isItemAbove:function(da,W,v){return W._layoutData?W._layoutData.top+W._layoutData.height<v:!1},isItemBelow:function(da,W,v){return W._layoutData?W._layoutData.top>v:!0},setupListeners:function(da,W){var v=function(y){U(y.target).is(".foundation-collection-item.is-lazyLoaded")&&W()};N.addEventListener("transitionend",v);M.on("foundation-collection-navigate",W);return function(){N.removeEventListener("transitionend",v);M.off("foundation-collection-navigate",
W)}}});N.scrollContainer=N.scrollContainer||R[0];ea.start();return function(){ea.destroy()}}}function V(E,M,N){var I=E.collection,Q=E.collectionEl;I.append(M);f(Q)&&(M=u(Q).then(function(){Z(I)}),U.when(M,N).then(function(){I.trigger("foundation-selections-change");H("change",I,E.config,null,{method:"append"})}));Z(I);I.trigger("foundation-contentloaded")}function Y(E){var M=E.collection,N=function(R){M.adaptTo("foundation-collection-item-action").execute(R)},I=function(R){var ea=U(R.target).closest("button, a, coral-quickactions-item, .foundation-collection-item");
ea.hasClass("foundation-layout-masonry-cardwrapper")?1!==R.which||R.metaKey||R.shiftKey||R.altKey||(R.preventDefault(),N(ea.closest(".foundation-collection-item")[0])):ea.hasClass("foundation-collection-item")&&(R.preventDefault(),N(ea[0]))},Q=function(R){var ea=c.Keys.keyToCode("enter");R.keyCode===ea&&U(R.target).is("coral-masonry-item")&&(m(E.mode)||N(R.target))};M.on("click",".foundation-collection-item",I);M.on("keydown","coral-masonry-item",Q);return function(){M.off("click",".foundation-collection-item",
I);M.off("keydown","coral-masonry-item",Q)}}function fa(E,M){var N=E.collection,I=E.collectionEl,Q=E.config,R=M.sortBy;M=M.sortOrder;I=a.expand(I.dataset.foundationCollectionSrc,{offset:0,limit:Q.limit,size:f(I)?Q.limit:Q.size,id:I.dataset.foundationCollectionId,sortName:R,sortDir:M});var ea=U(n).adaptTo("foundation-ui");ea.wait();H("sort",N,E.config,null,{sortBy:R,sortOrder:M});return U.ajax({url:I,cache:!1}).then(function(da){U(n).adaptTo("foundation-util-htmlparser").parse(da).then(function(W){var v=
W.querySelector(".foundation-collection");if(v){W=E.paginator;var y=k(v),G=N.adaptTo("foundation-collection");v=v.dataset.foundationLayoutMasonryHasmore;G.clear();G.append(y);v="true"===v?!0:"false"===v?!1:y.length>=W.limit;W.restart(y.length,v)}})},function(){var da=b.I18n.get("Error"),W=b.I18n.get("Fail to load data.");ea.alert(da,W,"error")}).always(function(){ea.clearWait()})}function ha(E){var M=E.collectionEl,N=E.collection,I=function(C){m(E.mode)&&C.preventDefault();C.target.setAttribute("role",
"menubar");C.target.returnFocusTo(C.target.closest(".foundation-collection-item"))},Q=function(C){var B=C.explicitOriginalTarget;"CORAL-QUICKACTIONS"===B.parentNode.nodeName&&(B.matches("button[is\x3d'coral-button']")||B.matches("a[is\x3d'coral-anchorbutton']"))&&(C.preventDefault(),C.stopImmediatePropagation());C=U(C.target).closest(".foundation-collection-item").find("coral-quickactions");C.length&&(C[0].open=!C[0].open)},R=function(C){(C.shiftKey&&121===C.keyCode||C.ctrlKey&&32===C.keyCode)&&C.preventDefault()},
ea=function(C){C=C.currentTarget;var B=C.querySelector("coral-quickactions");C.removeEventListener("coral-overlay:close",ea,!0);c.commons.nextFrame(function(){B.dataset.previousTrapFocus&&(B.trapFocus=B.dataset.previousTrapFocus,"on"!==B.trapFocus&&B.removeAttribute("tabindex"),delete B.dataset.previousTrapFocus);B.dataset.previousReturnFocus&&(B.returnFocus=B.dataset.previousReturnFocus,delete B.dataset.previousReturnFocus);B.dataset.previousFocusOnShow&&(B.focusOnShow=B.dataset.previousFocusOnShow,
delete B.dataset.previousFocusOnShow)})},da=function(C){var B=C.currentTarget,K=B.querySelector("coral-quickactions");(C.shiftKey&&121===C.keyCode||C.ctrlKey&&32===C.keyCode)&&!K.open&&("on"===K.interaction&&(K.dataset.previousTrapFocus=K.trapFocus,K.dataset.previousReturnFocus=K.returnFocus,K.dataset.previousFocusOnShow=K.focusOnShow,K.trapFocus="on",K.returnFocus="on",K.focusOnShow="on",B.addEventListener("coral-overlay:close",ea,!0)),K.show())},W=function(C){var B=C.currentTarget,K=B.querySelector("coral-quickactions");
K.returnFocusTo(B);K.contains(h.activeElement)&&C.target===K&&(B.removeEventListener("coral-overlay:beforeclose",W,!0),B.dataset.justClosed=!0,n.requestAnimationFrame(function(){B.focus()}))},v,y=function(C){var B=C.currentTarget,K=B.querySelector("coral-quickactions");v&&clearTimeout(v);B.removeEventListener("keydown",R);B.removeEventListener("keyup",da);c.commons.nextFrame(function(){!K.open||B.contains(h.activeElement)||K.overlay.contains(h.activeElement)||(K.open=!1,B.removeEventListener("blur",
y,!0),B.removeEventListener("coral-overlay:beforeclose",W,!0),delete B.dataset.justClosed)})},G=function(C){if(C.target.matches(".foundation-collection-item")){C=C.target;var B=C.querySelector("coral-quickactions");B&&(v&&clearTimeout(v),B.open||C.dataset.justClosed?delete C.dataset.justClosed:(v=setTimeout(function(){B.open=!0},300),C.addEventListener("blur",y,!0),C.addEventListener("coral-overlay:beforeclose",W,!0)),C.addEventListener("keydown",R),C.addEventListener("keyup",da))}};N.on("coral-overlay:beforeopen",
"coral-quickactions",I);M.addEventListener("focus",G,!0);M.addEventListener("coral-dragaction:dragstart",Q,!0);M.addEventListener("coral-dragaction:dragend",Q,!0);return function(){N.off("coral-overlay:beforeopen","coral-quickactions",I);M.removeEventListener("focus",G,!0);M.removeEventListener("coral-dragaction:dragstart",Q,!0);M.removeEventListener("coral-dragaction:dragend",Q,!0)}}function Z(E){var M=h.querySelector(".granite-collection-pagetitle");E.find("coral-card.foundation-collection-navigator").wrap(function(){var N=
U(this);if(!N.parent("a").length){var I=h.createElement("a");I.className="foundation-layout-masonry-cardwrapper";I.tabIndex=-1;var Q=N[0].dataset.foundationCollectionNavigatorHref;if(Q)I.target=N[0].dataset.foundationCollectionNavigatorTarget;else{if(!M||!E.is(M.dataset.graniteCollectionPagetitleTarget))return;Q=a.expand(M.dataset.graniteCollectionPagetitleSrc,{id:N.closest(".foundation-collection-item")[0].dataset.foundationCollectionItemId})}I.href=Q;return U(I)}})}function ba(E,M,N,I){var Q=E.config,
R=E.collection,ea=E.collectionEl,da=ea.dataset.foundationCollectionSrc,W=M===ea.dataset.foundationCollectionId;if(!da)return U.Deferred().reject().promise();N=N?N:Q.limit||20;var v=R.adaptTo("foundation-collection-sort").getSortValues();M=a.expand(da,{offset:0,limit:N,size:Q.size,id:M,sortName:v.sortBy,sortDir:v.sortOrder});E._lastLoadRequest&&E._lastLoadRequest.abort();E._lastLoadRequest=U.ajax({url:M,cache:!1});return E._lastLoadRequest.then(function(y){var G=U.Deferred();U(n).adaptTo("foundation-util-htmlparser").parse(y).then(function(C){var B=
U(C).children();C.querySelector(".foundation-collection")?(I&&(C=R.children(".foundation-selections-item").map(function(){return this.dataset.foundationCollectionItemId}).toArray(),B.data("foundation-layout-collection-switcher.internal.selectionIds",C)),W&&(R.trigger("foundation-collection-reload"),H("reload",R,Q)),b.UI.Foundation.Layouts.cleanAll(ea),B.replaceAll(R),requestAnimationFrame(function(){B.trigger("foundation-collection-navigate");H("navigate",R,Q)}),B.trigger("foundation-contentloaded"),
I&&B.removeData("foundation-layout-collection-switcher.internal.selectionIds"),G.resolve(B[0])):G.reject(Error("Invalid content"))});return G.promise()},function(y,G){if("abort"!==G){y=U(n).adaptTo("foundation-ui");G=b.I18n.get("Error");var C=b.I18n.get("Fail to load data.");y.alert(G,C,"error")}})}var U=g,ia={SELECTION:"selection",DEFAULT:"default"},aa=new WeakMap;g=U(n).adaptTo("foundation-registry");g.register("foundation.layouts",{name:"foundation-layout-masonry",doLayout:function(E,M){var N=
U(E);if(E.classList.contains("foundation-collection")&&!aa.has(E)){var I={collectionEl:E,collection:N,config:M,stack:[]};aa.set(E,I);H("init",N,M);I.stack.push(T(I));I.stack.push(J(I));I.stack.push(S(I));I.stack.push(P(I));I.stack.push(Y(I));I.stack.push(ha(I));I.stack.push(F(I));I.stack.push(D(I));N.attr("role","row").attr("ariaGrid","on");Z(N);var Q=N.data("foundation-layout-collection-switcher.internal.selectionIds");E=U();Q&&(E=N.children(".foundation-collection-item").filter(function(){return 0<=
Q.indexOf(this.dataset.foundationCollectionItemId)}),E.each(function(){U(this).attr("selected","").addClass("foundation-selections-item")}));var R=M.selectionMode||E.length?ia.SELECTION:ia.DEFAULT;requestAnimationFrame(function(){O(I,R,!0);N.trigger("foundation-collection-newpage");H("newpage",N,M);N.trigger("foundation-selections-change");H("change",N,M,null,{method:"init"});N.trigger("foundation-collection-sort:changed")})}},clearItems:function(E){U(E).adaptTo("foundation-collection").clear();E.layoutInstance.layout()},
clean:function(E,M){U(E).siblings(".granite-collection-loading-title-wrapper").remove();if(M=aa.get(E))aa.delete(E),b.UI.Foundation.Utils.everyReverse(M.stack,function(N){N&&N();return!0});b.UI.Foundation.Layouts.clean(E)}});g.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-masonry.foundation-collection",adapter:function(E){var M=aa.get(E),N=M.collection;return{append:function(I){V(M,I)},clear:function(){k(E).forEach(function(I){I.showRemoveTransition=!1;
I.remove()});E.layoutInstance.layout()},getPagination:function(){var I=M.paginator;if(!I)return null;var Q=parseInt(N.attr("data-foundation-layout-masonry-guesstotal")||"-1",10);var R=-1===Q?I.hasNext:I.offset>=Q||b.Toggles.isEnabled("CT_GRANITE-46012")&&I.offset<Q&&I.hasNext||1E3<=Q?I.hasNext:null;return{offset:I.offset,limit:I.limit,guessTotal:-1===Q?Q:Math.max(I.offset,Q),hasNext:R}},isAllLoaded:function(){var I=this.getPagination();if(!I)return!0;if(0<r(E).length)return!1;if(null===I.hasNext&&
-1!==I.guessTotal){var Q=k(E);return!(I.guessTotal>Q.length)}return!1===I.hasNext},load:function(I){return ba(M,I)},reload:function(){var I=this.getPagination();return ba(M,E.dataset.foundationCollectionId,I?I.offset:null,!0)}}}});g.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-masonry.foundation-collection",adapter:function(E){var M=U(E).children(".foundation-collection-meta"),N=M[0];return N?{getElement:function(){return N},getTitle:function(){return N.dataset.foundationCollectionMetaTitle},
getThumbnail:function(){return M.children(".foundation-collection-meta-thumbnail")[0]},isFolder:function(){return"true"===N.dataset.foundationCollectionMetaFolder},getRelationship:function(){return N.dataset.foundationCollectionMetaRel}}:null}});g.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-masonry.foundation-collection",adapter:function(E){var M=aa.get(E),N=M.collection,I=M.config;return{count:function(){if(f(E)){var Q=N.adaptTo("foundation-collection").getPagination();
if(Q&&-1!==Q.guessTotal){var R=l(E);return Q.guessTotal-R.length}}return t(E).length},selectAll:function(Q){u(E).then(function(){Q||(N.trigger("foundation-selections-change"),H("change",N,I,null,{method:"selectAll"}))});O(M,ia.SELECTION,!0)},clear:function(Q){var R=t(E);A(R,void 0);Q||(N.trigger("foundation-selections-change"),H("change",N,I,null,{method:"clear"}));I.autoDefaultMode&&O(M,ia.DEFAULT,!0)},select:function(Q){e(Q)&&(O(M,ia.SELECTION,!0),Q.selected=!0,Q.classList.toggle("foundation-selections-item",
!0),N.trigger("foundation-selections-change"),H("change",N,I,Q,{method:"select"}))},deselect:function(Q){e(Q)&&(Q.selected=!1,Q.classList.toggle("foundation-selections-item",!1),N.trigger("foundation-selections-change"),I.autoDefaultMode&&!t(E).length&&O(M,ia.DEFAULT,!0),H("change",N,I,Q,{method:"deselect"}))},isAllSelected:function(){var Q=k(E).length,R=t(E).length;return 0<Q&&Q===R?(Q=(Q=N.adaptTo("foundation-collection").getPagination())?Q.hasNext:!1,f(E)?!0:!Q):!1}}}});g.register("foundation.adapters",
{type:"foundation-collection-sort",selector:".foundation-layout-masonry.foundation-collection",adapter:function(E){var M=U(E),N=aa.get(E);return{isSorted:function(I,Q){var R=this.getSortValues();return R.sortBy===I&&R.sortOrder===Q?!0:!1},getSortValues:function(){return{sortBy:E.dataset.foundationCollectionSortby||null,sortOrder:E.dataset.foundationCollectionSortorder||null}},doSort:function(I,Q){I&&Q||(I=Q=null);if(!this.isSorted(I,Q)){null===I&&null===Q?(delete E.dataset.foundationCollectionSortby,
delete E.dataset.foundationCollectionSortorder):(E.dataset.foundationCollectionSortby=I,E.dataset.foundationCollectionSortorder=Q);var R=U.Event("foundation-collection-sort:beforeChange",{sortName:I,sortDir:Q});M.trigger(R);fa(N,{sortBy:I,sortOrder:Q}).then(function(){M.trigger("foundation-collection-sort:changed")});return!0}return!1}}}})})(window,document,Granite,Granite.$,Coral,Granite.URITemplate);
(function(n,h,b,g,c){function a(u){var w={};u.find(":input").each(function(){var A=b(this);A.serializeArray().forEach(function(x){var L=x.name;x=x.value;if(w.hasOwnProperty(L)){var H=w[L];Array.isArray(H)||(H=[H]);H.push(x);x=H}w[L]=x;(x=b(A).attr("data-foundation-uritemplate-parent"))&&((w[x]=w[x]||{})[L]=w[L])})});return w}function d(u){if(!1===u.data("foundationWizardStepValidation"))return!0;var w=u.data("foundation-wizard-step.internal.valid");if(void 0!==w)return w;var A=!0;u.adaptTo("foundation-validation-helper").getSubmittables().forEach(function(x){x=
b(x).adaptTo("foundation-validation");x.checkValidity()||(A=!1);x.updateUI()});return A}function e(u){var w=[];(u=u.data("foundation-wizard-step.internal.children"))&&u.each(function(){var A=b(this),x=A.data("foundation-layout-wizard2.internal.actualStep");x||(x=A);w.push(x);b.merge(w,e(A))});return w}function f(u,w,A){if(d(w)){var x=u.adaptTo("foundation-wizard");if(u=A.data("foundationWizardControlSrc")){var L=b(x.getPrevSteps(w[0])).add(w);L=a(L);u=g.expand(u,L);if(A.data("foundation-wizard-control.internal.lastURL")===
u)x.next();else{A.data("foundation-wizard-control.internal.lastURL",u);var H=b(n).adaptTo("foundation-ui");H.wait();b.ajax({url:u,cache:!1}).done(function(T){b(n).adaptTo("foundation-util-htmlparser").parse(T).then(function(D){D=b(D.querySelectorAll(".foundation-wizard-step"));x.remove(e(w));w.data("foundation-wizard-step.internal.children",D);x.appendAfter(D.toArray(),w[0]);x.next();H.clearWait()})}).fail(function(){H.clearWait();var T=h.I18n.get("Error"),D=h.I18n.get("Something went wrong.");H.alert(T,
D,"error")})}}else x.next()}}function m(u){var w=function(A){var x=b(this),L=x.data("foundationWizardControlAction");if(x.closest("coral-panel").prop("selected")){var H=u.find(".foundation-wizard-step-active");"next"===L?("button"===x.prop("type")&&A.preventDefault(),f(u,H,x)):"prev"===L&&(A.preventDefault(),u.adaptTo("foundation-wizard").prev())}else A.preventDefault()};u.on("click",".foundation-wizard-control",w);return function(){u.off("click",".foundation-wizard-control",w)}}function p(u){var w=
b(u),A=w.data("foundation-layout-wizard2.internal.resizeController");if(!A){var x=w.find(".foundation-layout-wizard2-header \x3e .foundation-layout-wizard2-steplist"),L=w.find(".foundation-layout-wizard2-header \x3e .foundation-layout-wizard2-title"),H=w.find(".foundation-layout-wizard2-header \x3e .foundation-layout-wizard2-controls");A=new q({elements:[new l({element:x[0],states:[new t({fn:function(T){(T||this.element).setAttribute("size","L")}}),new t({fn:function(T){(T||this.element).setAttribute("size",
"S")}})]}),new l({element:L[0]}),new l({element:H[0]})],container:x[0].parentElement});A.measureElements().then(function(){var T=function(D){requestAnimationFrame(function(){A.checkResize()})};c.commons.addResizeListener(u,T);r.set(u,T);A.checkResize()});w.data("foundation-layout-wizard2.internal.resizeController",A)}}function k(u){r.get(u)&&(c.commons.removeResizeListener(u,r.get(u)),r.delete(u));u=b(u);var w=u.data("foundation-layout-wizard2.internal.resizeController");w&&(w.clean(),b.removeData(u,
"foundation-layout-wizard2.internal.resizeController"))}function t(u){this.fn=u.fn}function l(u){this.element=u.element;this.currentState=0;this.measuredWidth=-1;this.states=u.states}function q(u){this.config=u;this.totalWidth=0;this.elementsMap=new WeakMap;for(u=0;u<this.config.elements.length;++u)this.elementsMap.set(this.config.elements[u].element,this.config.elements[u])}var r=new WeakMap,z=b(n).adaptTo("foundation-registry");z.register("foundation.layouts",{name:"foundation-layout-wizard2",doLayout:function(u,
w){p(u);var A=b(u);if(A.hasClass("foundation-wizard")&&!0!==A.data("foundation-layout-wizard2.internal.init")){var x=[];x.push(function(){A.data("foundation-layout-wizard2.internal.stack",x);return function(){A.removeData("foundation-layout-wizard2.internal.stack")}}());x.push(function(){A.data("foundation-layout-wizard2.internal.init",!0);return function(){A.removeData("foundation-layout-wizard2.internal.init")}}());x.push(m(A));var L=A.find(".foundation-wizard-step").first();L.length&&requestAnimationFrame(function(){L.addClass("foundation-wizard-step-active");
A.trigger("foundation-wizard-stepchange",[L[0]])})}},clean:function(u,w){k(u);(w=b(u).data("foundation-layout-wizard2.internal.stack"))&&h.UI.Foundation.Utils.everyReverse(w,function(A){A&&A();return!0});h.UI.Foundation.Layouts.clean(u)}});z.register("foundation.adapters",{type:"foundation-wizard",selector:".foundation-layout-wizard2.foundation-wizard",adapter:function(u){var w=b(u);return{toggleNext:function(A){this.toggle("next",A)},togglePrev:function(A){this.toggle("prev",A)},toggleCancel:function(A){this.toggle("cancel",
A)},toggle:function(A,x){w.find(".foundation-layout-wizard2-controls \x3e coral-panel[selected] .foundation-wizard-control[data-foundation-wizard-control-action\x3d"+A+"]").prop("disabled",!x)},next:function(){var A=w.find(".foundation-layout-wizard2-contents \x3e coral-panel[selected]"),x=A.next("coral-panel");if(x.length){var L=x.index();w.find(".foundation-layout-wizard2-steplist \x3e coral-step").eq(L).attr("selected","");x.attr("selected","");w.find(".foundation-layout-wizard2-controls \x3e coral-panel").eq(L).attr("selected",
"");A=A.find(".foundation-wizard-step").removeClass("foundation-wizard-step-active");x=x.find(".foundation-wizard-step").addClass("foundation-wizard-step-active");w.trigger("foundation-wizard-stepchange",[x[0],A[0]])}},prev:function(){var A=w.find(".foundation-layout-wizard2-contents \x3e coral-panel[selected]"),x=A.prev("coral-panel");if(x.length){var L=x.index();w.find(".foundation-layout-wizard2-steplist \x3e coral-step").eq(L).attr("selected","");x.attr("selected","");w.find(".foundation-layout-wizard2-controls \x3e coral-panel").eq(L).attr("selected",
"");A=A.find(".foundation-wizard-step").removeClass("foundation-wizard-step-active");x=x.find(".foundation-wizard-step").addClass("foundation-wizard-step-active");w.trigger("foundation-wizard-stepchange",[x[0],A[0]])}},append:function(A,x){var L=w.find(".foundation-layout-wizard2-contents \x3e coral-panel");this.appendAfter(A,(void 0===x?L[L.length-1]:L[x]).querySelector(".foundation-wizard-step"))},appendAfter:function(A,x){var L=[],H=[],T=[];A.forEach(function(D){var F=b(D);D=F.attr("data-foundation-wizard-step-title");
var J=F.children(".foundation-wizard-control").detach().addClass("foundation-layout-inline2-item"),O=F.children(".foundation-wizard-step-content").removeClass("foundation-wizard-step-content").addClass("foundation-wizard-step");0===O.length?O=F:F.data("foundation-layout-wizard2.internal.actualStep",O);F=new c.Panel;O.appendTo(F.content);var S=document.createElement("div");S.className="foundation-layout-inline2 foundation-layout-inline2-gap";O=new c.Panel;O.content.appendChild(S);J.appendTo(S);D=(new c.Step).set({label:{textContent:D}});
L.push(D);H.push(F);T.push(O)});A=b(x).closest("coral-panel");x=A.index();w.find(".foundation-layout-wizard2-steplist \x3e coral-step").eq(x).after(L);A.after(H);w.find(".foundation-layout-wizard2-controls \x3e coral-panel").eq(x).after(T);w.trigger("foundation-contentloaded");(A=w.data("foundation-layout-wizard2.internal.resizeController"))&&A.updateElement(w.find(".foundation-layout-wizard2-steplist")[0])},remove:function(A){var x=w.find(".foundation-layout-wizard2-steplist \x3e coral-step"),L=
w.find(".foundation-layout-wizard2-controls \x3e coral-panel"),H=[];b(A).each(function(){var T=b(this).closest("coral-panel"),D=T.index();H.push(T[0],x[D],L[D])});b(H).detach();(A=w.data("foundation-layout-wizard2.internal.resizeController"))&&A.updateElement(w.find(".foundation-layout-wizard2-steplist")[0])},getPrevSteps:function(A){return b(A).closest("coral-panel").prevAll("coral-panel").find(".foundation-wizard-step").toArray()}}}});t.prototype.clean=function(){this.fn=null};l.prototype.measure=
function(u){var w=b.Deferred(),A=b(this.element).clone().css({display:"inline-block",width:"auto",visibility:"hidden"}).appendTo("body");u&&this.states&&this.states.length&&this.states[0].fn.call(this,A[0]);var x=this;c.commons.ready(this.element,function(){x.previousMeasuredWidth=x.measuredWidth;x.measuredWidth=A.outerWidth(!0);w.resolve(x.measuredWidth);A.remove()});return w.promise()};l.prototype.goToNextState=function(){return this.states&&this.states.length&&this.currentState<this.states.length-
1?(this.states[++this.currentState].fn.call(this),!0):!1};l.prototype.goToPreviousState=function(){return this.states&&this.states.length&&0<this.currentState?(this.states[--this.currentState].fn.call(this),!0):!1};l.prototype.overflows=function(){return this.element.offsetWidth<this.measuredWidth};l.prototype.clean=function(){this.config=this.element=null;this.states.forEach(function(u){u.clean()});this.states=null};q.prototype.measureElements=function(){var u=b.Deferred(),w=this,A=this.config.elements.map(function(x){return x.measure()});
b.when.apply(b,A).then(function(){for(var x=0;x<arguments.length;++x)w.totalWidth+=arguments[x]||0;u.resolve(w.totalWidth)});return u.promise()};q.prototype.elementsOverflow=function(){return b(this.config.container).width()<this.totalWidth};q.prototype.checkResize=function(){var u;if(this.elementsOverflow()){if(!this.hasOverflow)for(u=0;u<this.config.elements.length;++u){var w=this.config.elements[u];if(w.goToNextState()){this.hasOverflow=!0;break}}}else if(this.hasOverflow)for(u=0;u<this.config.elements.length;++u)if(w=
this.config.elements[u],w.goToPreviousState()){this.hasOverflow=!1;break}};q.prototype.updateElement=function(u){u=this.elementsMap.get(u);var w=this;if(u){var A=u.measuredWidth;u.measure(!0).then(function(x){w.totalWidth-=A;w.totalWidth+=x;w.checkResize()})}};q.prototype.clean=function(){this.config.elements.forEach(function(u){u.clean()});this.elementsMap=this.config=null}})(window,Granite,Granite.$,Granite.URITemplate,Coral);
(function(n,h,b){function g(v){return v.matches(".foundation-collection-item.is-lazyLoaded, .foundation-collection-item.is-pending")}function c(v){return v.classList.contains("foundation-collection-item")}function a(v){return"true"===v.dataset.foundationSelectionsSelectallMode}function d(v){v=v.querySelectorAll(".foundation-collection-item");return Array.from(v)}function e(v,y){var G="coral-columnview-column";y&&(G+=", coral-columnview-preview");v=v.querySelectorAll(G);return Array.from(v)}function f(v){return e(v,
!0).filter(function(y){return"true"===y.dataset.foundationLayoutColumnviewLazy})}function m(v){return d(v).filter(function(y){return y.classList.contains("foundation-selections-item")})}function p(v){return d(v).filter(function(y){return!y.classList.contains("foundation-selections-item")})}function k(v){return p(v).filter(function(y){return!g(y)})}function t(v){return d(v).filter(function(y){return y.matches(".is-lazyLoaded, .is-pending")})}function l(v,y){0!==v.length&&Array.prototype.forEach.call(v,
function(G,C,B){C!==B.length-1||y?G.set("selected",!0,!0):G.selected=!0;G.classList.add("foundation-selections-item")})}function q(v,y){0!==v.length&&Array.prototype.forEach.call(v,function(G,C,B){C!==B.length-1||y?G.set("selected",!1,!0):G.selected=!1;G.classList.remove("foundation-selections-item")})}function r(v,y,G){y=k(y);v.bulkSelection=!0;l(y,G);v.bulkSelection=!1}function z(v,y,G){var C=t(y),B=R.Deferred().resolve().promise();if(0<C.length){var K=R(document.createElement("div")).addClass("foundation-ui-mask").append('\x3ccoral-wait size\x3d"L" centered\x3e\x3c/coral-wait\x3e').appendTo(document.body);
B=J(y,C).then(function(X){v.bulkSelection=!0;l(X,G);v.bulkSelection=!1}).always(function(){K.remove()})}r(v,y,G);return B}function u(v,y){return d(v).find(function(G){return G.dataset.foundationCollectionItemId===y})}function w(v,y,G){return e(v,G).find(function(C){return C.dataset.foundationLayoutColumnviewColumnid===y})}function A(v,y){return w(v,v.dataset.foundationCollectionId,y)}function x(v){(v=v.querySelector("coral-columnview-preview"))&&v.remove()}function L(v,y){v.dataset.foundationCollectionId=
y;R(v).removeData("foundationCollectionId")}function H(v,y){return R(n).adaptTo("foundation-util-htmlparser").parse(v).then(function(G){var C=Array.from(G.children).find(function(B){return B.matches(y)});if(C)return C;G=Array.from(G.querySelectorAll(y));return 0<G.length?G[G.length-1]:null})}function T(v,y){var G=(new DOMParser).parseFromString(v,"text/html"),C=G.body.querySelector(".foundation-layout-columnview.foundation-collection");if(C){var B=C.querySelectorAll("coral-columnview-column");if(B=
0<B.length?B[B.length-1]:null)y&&(v=d(B).filter(function(K){return!g(K)}).reduce(function(K,X){return K+X.outerHTML},""),B.innerHTML=v),C.outerHTML=B.outerHTML,v=G.head.innerHTML+G.body.innerHTML}return v}function D(v,y){return R(n).adaptTo("foundation-util-htmlparser").parse(T(v,y)).then(function(G){var C=Array.from(G.children).find(function(K){return K.matches("coral-columnview-column")});C||(C=G.querySelectorAll("coral-columnview-column"),C=C[C.length-1]);G=null;var B=C.dataset.foundationLayoutColumnviewHasmore;
"true"===B?G=!0:"false"===B&&(G=!1);return{items:d(C),hasMore:G,meta:C.querySelector(".foundation-collection-meta")}})}function F(v){var y=v.collectionEl,G=v.collection;!1===v.initialLoadEventTriggered&&0===f(y).length&&(G.trigger("granite-columnview:initial-load-completed"),v.initialLoadEventTriggered=!0)}function J(v,y){return(v=O(v))?v.loadItems(y):R.Deferred().resolve([]).promise()}function O(v){return(v=W.get(v))&&v.lazyLoader?v.lazyLoader:null}function S(v,y){var G=O(y);if(!G){var C=v.collection,
B=v.collectionEl.dataset.foundationCollectionSrc;G=new (R(n).adaptTo("foundation-collection-lazyloader"))({scrollSrc:y.querySelector("coral-columnview-column-content"),getItems:function(){return d(y)},load:function(K,X){K=C.adaptTo("foundation-collection-sort").getSortValues();X=b.expand(B,{offset:X.offset,limit:X.limit,size:X.size,id:y.dataset.foundationLayoutColumnviewColumnid,sortName:K.sortBy,sortDir:K.sortOrder});return R.ajax(X).then(function(ca){return D(ca,!0)}).then(function(ca){return ca.items})},
onReplace:function(){R(y).trigger("foundation-contentloaded")}})}return G}function P(v,y,G){var C=v.config;v.collectionEl.dataset.foundationCollectionSrc&&("boolean"!==typeof G&&(G="false"!==y.dataset.foundationLayoutColumnviewHasmore),v=S(v,y),G={offset:d(y).length,limit:C.limit,size:C.size,hasNext:G,lazyLoader:v},W.set(y,G))}function V(v,y,G,C){var B=R(v);if(v=v.dataset.foundationModeGroup){G=G?G.length:B.adaptTo("foundation-selections").count();C=C?C.length:0;var K=R.Event("foundation-mode-change");
K._foundationLayoutColumnview=!0;(0===C||y)&&0<G?B.trigger(K,[ea.SELECTION,v]):(0<C||y)&&0===G&&B.trigger(K,[ea.DEFAULT,v])}}function Y(v,y,G){var C=v.config,B=v.collection,K=v.collectionEl,X=K.dataset.foundationCollectionSrc;if(X&&"false"!==y.dataset.foundationLayoutColumnviewHasmore&&!y.hasAttribute("is-loading")){G=G||0;var ca=C.size,na=C.limit||20,ka=B.adaptTo("foundation-collection-sort").getSortValues();G=b.expand(X,{offset:G,limit:na,size:ca,id:y.dataset.foundationLayoutColumnviewColumnid,
sortName:ka.sortBy,sortDir:ka.sortOrder});y.setAttribute("is-loading","");y.classList.add("foundation-layout-columnview-isloading");return R.ajax({url:G,cache:!1}).then(function(la){return D(la).then(function(ja){var ma=null,oa=ja.items;if(y.dataset.foundationLayoutColumnviewLazy){for(;y.content.firstChild;)y.content.removeChild(y.content.firstChild);delete y.dataset.foundationLayoutColumnviewLazy;ja.meta&&y.content.appendChild(ja.meta);y.dataset.foundationLayoutColumnviewLoadActiveItemEl="true"}"true"===
y.dataset.foundationLayoutColumnviewLoadActiveItemEl&&(ma=oa.find(function(pa){return y.dataset.foundationLayoutColumnviewActiveitem===pa.dataset.foundationCollectionItemId}));oa.forEach(function(pa){y.items.add(pa)});ja=null===ja.hasMore?oa.length>=na:ja.hasMore;y.dataset.foundationLayoutColumnviewHasmore=""+ja;oa=O(y);P(v,y,ja);oa||(oa=O(y),oa.start());if(ma){delete y.dataset.foundationLayoutColumnviewActiveitem;delete y.dataset.foundationLayoutColumnviewLoadActiveItemEl;var qa=function(pa){CustomElements.upgrade(pa);
"drilldown"===pa.variant?(pa.set("active",!0,!0),y._oldActiveItem=pa):pa.active=!0;pa.scrollIntoView();F(v)};g(ma)?J(y,[ma]).then(function(pa){qa(pa[0])}):qa(ma)}a(K)&&A(K)===y&&z(v,y).then(function(){B.trigger("foundation-selections-change");aa("change",B,C,null,{method:"handlePagination"})});!0===v.reloaded&&0===f(K).length&&requestAnimationFrame(function(){B.trigger("foundation-collection-navigate");aa("navigate",B,C)});"true"===y.dataset.foundationLayoutColumnviewLoadActiveItemEl&&("false"===
y.dataset.foundationLayoutColumnviewHasmore?(delete y.dataset.foundationLayoutColumnviewActiveitem,delete y.dataset.foundationLayoutColumnviewLoadActiveItemEl,F(v)):requestAnimationFrame(function(){y.querySelector(".foundation-collection-item:last-of-type").scrollIntoView()}))})},function(){var la=Granite.I18n.get("Error"),ja=Granite.I18n.get("Fail to load data.");R(n).adaptTo("foundation-ui").alert(la,ja,"error")}).always(function(){y.classList.remove("foundation-layout-columnview-isloading");y.removeAttribute("is-loading")})}}
function fa(v,y,G){var C=v.config,B=C.previewSrc,K=v.collection,X=v.collectionEl;v=X.dataset.foundationCollectionSrc;var ca=y.closest("coral-columnview-column");if(v){if(B){var na=y.dataset.foundationCollectionItemId;y=b.expand(B,{id:na});X.classList.add("foundation-layout-columnview-isloading");return R.ajax({url:y,cache:!1}).then(function(ka){return H(ka,"coral-columnview-preview").then(function(la){la.dataset.foundationLayoutColumnviewColumnid=na;C.previewMaximized&&la.classList.add("foundation-layout-columnview-preview-maximized");
G?K.children("coral-columnview-preview").replaceWith(la):X.setNextColumn(la,ca);return la})},function(){var ka=Granite.I18n.get("Error"),la=Granite.I18n.get("Fail to load data.");R(n).adaptTo("foundation-ui").alert(ka,la,"error")}).always(function(){X.classList.remove("foundation-layout-columnview-isloading")})}y=e(X);B=y.indexOf(ca);for(v=y.length-1;0<=B&&v>B;v--)X.columns.remove(y[v]);return R.Deferred().resolve().promise()}}function ha(v,y){var G=v.config,C=v.collection,B=v.collectionEl;return fa(v,
y).then(function(K){K&&!0===v.reloaded&&0===f(B).length&&requestAnimationFrame(function(){C.trigger("foundation-collection-navigate");aa("navigate",C,G,null)});return K})}function Z(v,y){return v.config.previewSrc?fa(v,y):R.Deferred().reject(Error("previewSrc not available")).promise()}function ba(v,y){var G=v.config,C=v.collection,B=v.collectionEl,K=B.dataset.foundationCollectionSrc,X=y.closest("coral-columnview-column");if(K){var ca=G.size,na=G.limit||20;y=y.dataset.foundationCollectionItemId;var ka=
C.adaptTo("foundation-collection-sort").getSortValues();K=b.expand(K,{offset:0,limit:na,size:ca,id:y,sortName:ka.sortBy,sortDir:ka.sortOrder});B.classList.add("foundation-layout-columnview-isloading");return R.ajax({url:K,cache:!1}).then(function(la){return H(T(la),"coral-columnview-column").then(function(ja){var ma=d(ja),oa=ja.dataset.foundationLayoutColumnviewHasmore;P(v,ja,"true"===oa?!0:"false"===oa?!1:ma.length>=na);ma=O(ja);B.setNextColumn(ja,X);ma.start();!0===v.reloaded&&0===f(B).length&&
requestAnimationFrame(function(){C.trigger("foundation-collection-navigate");aa("navigate",C,G)})})},function(){var la=Granite.I18n.get("Error"),ja=Granite.I18n.get("Fail to load data.");R(n).adaptTo("foundation-ui").alert(la,ja,"error")}).always(function(){B.classList.remove("foundation-layout-columnview-isloading");B.removeAttribute("is-loading")})}}function U(v,y){var G=v.config,C=v.collection,B=v.collectionEl,K=C.adaptTo("foundation-collection-sort").getSortValues(),X=w(B,y,!0),ca=null,na=null;
if(X&&X.previousElementSibling){var ka=X.previousElementSibling;ca=ka.dataset.foundationLayoutColumnviewColumnid;ka.activeItem&&(na=ka.activeItem.dataset.foundationCollectionItemId)}var la;(ka=W.get(X))?ka=la=ka.offset:(la=G.limit||20,ka=G.size);y=b.expand(B.dataset.foundationCollectionSrc,{offset:0,limit:la,size:ka,id:y,sortName:K.sortBy,sortDir:K.sortOrder});K=[];ka=m(B);1===ka.length&&"single"!==B.dataset.foundationSelectionsMode&&K.push(v.config.previewSrc?fa(v,ka[0],!0):R.Deferred().reject(Error("previewSrc not available")).promise());
K.push(R.ajax({url:y,cache:!1}).then(function(ja){return H(T(ja),"coral-columnview-column").then(function(ma){var oa=d(ma),qa=m(B),pa=qa.map(function(ra){return ra.dataset.foundationCollectionItemId});oa=oa.filter(function(ra){return 0<=pa.indexOf(ra.dataset.foundationCollectionItemId)});l(oa);var sa=C.adaptTo("foundation-collection");if(null===ca||null===na||X.nodeName===ma.nodeName&&ma.querySelector("coral-columnview-item"))X.replaceWith(ma);else return U(v,ca).then(function(){C.data("foundation-layout-collection.internal.columnviewLoaded",
!1);sa.load(na);C.trigger("foundation-collection-reload");aa("reload",C,G);C.trigger("foundation-selections-change");aa("change",C,G,null,{method:"reloadParentColumn",parentColumnId:ca})});P(v,ma);O(ma).start();C.trigger("foundation-collection-reload");aa("reload",C,G);C.trigger("foundation-selections-change");aa("change",C,G,null,{method:"reloadColumn",parentColumnId:na});V(B,!1,oa,qa)})},function(){var ja=R(n).adaptTo("foundation-ui"),ma=Granite.I18n.get("Error"),oa=Granite.I18n.get("Fail to load data.");
ja.alert(ma,oa,"error")}));return R.when.apply(null,K).then(function(){return B})}function ia(v,y){var G=v.collection,C=v.collectionEl,B=C.dataset.foundationCollectionSrc,K=G.adaptTo("foundation-collection-sort").getSortValues();v=b.expand(B,{offset:0,limit:v.config.limit||20,size:v.config.size,id:y,sortName:K.sortBy,sortDir:K.sortOrder});return R.ajax({url:v,cache:!1}).then(function(X){Granite.UI.Foundation.Layouts.cleanAll(C);return R(n).adaptTo("foundation-util-htmlparser").parse(X).then(function(ca){ca=
R(ca).children();var na=ca[0];ca.data("foundation-layout-collection.internal.columnviewLoaded",G.data("foundation-layout-collection.internal.columnviewLoaded"));ca.data("foundation-layout-collection.internal.reloaded",!0);ca.replaceAll(G);ca.trigger("foundation-contentloaded");return na})},function(){var X=R(n).adaptTo("foundation-ui"),ca=Granite.I18n.get("Error"),na=Granite.I18n.get("Fail to load data.");X.alert(ca,na,"error")})}function aa(v,y,G,C,B){y=G.trackingElement;"navigate"===v&&B&&B.columnId?
y=B.columnId:"change"===v&&B&&B.parentColumnId&&(y=B.parentColumnId);v={element:y||"No element defined",type:"columnview",action:v,widget:{name:G.trackingElement||G.name||"foundation-layout-columnview",type:"columnview"},feature:G.trackingFeature||"No feature defined",attributes:B||{}};R(n).adaptTo("foundation-tracker").trackEvent(v)}function E(v){var y=v.collection,G=v.collectionEl,C=function(B,K,X){B._foundationLayoutColumnview||K!==ea.DEFAULT||G.dataset.foundationModeGroup!==X||(B=m(G),v.bulkSelection=
!0,q(B,void 0),v.bulkSelection=!1,x(G),y.trigger("foundation-selections-change"),aa("change",y,v.config,null,{method:"modeChange"}))};R(document).on("foundation-mode-change",C);return function(){R(document).off("foundation-mode-change",C)}}function M(v){var y=v.collection,G=v.collectionEl,C=function(K){var X=K.originalEvent.detail.selection?K.originalEvent.detail.selection:[];K=K.originalEvent.detail.oldSelection?K.originalEvent.detail.oldSelection:[];q(K,!0);l(X,!0);if(!v.bulkSelection){if(0<X.length){var ca=
G.dataset.foundationCollectionId;(G.activeItem?G.activeItem.dataset.foundationCollectionItemId:e(G)[0].dataset.foundationLayoutColumnviewColumnid)!==ca?v.delaySelectionEvent={newSelectedItems:X,oldSelectedItems:K}:(V(G,!1,X,K),y.trigger("foundation-selections-change"),aa("change",y,v.config,null,{method:"handleSelection"}))}else V(G,!1,X,K),y.trigger("foundation-selections-change"),aa("change",y,v.config,null,{method:"handleSelection"});1===X.length&&"single"!==G.dataset.foundationSelectionsMode?
Z(v,X[0]):x(G)}},B=function(){(document.activeElement===G||G.contains(document.activeElement))&&y.adaptTo("foundation-selections").clear()};y.on("coral-columnview:change",C);Coral.keys.on("escape",B);return function(){y.off("coral-columnview:change",C);Coral.keys.off("escape",B)}}function N(v){var y=v.collection,G=v.collectionEl,C=function(B){L(G,B.originalEvent.detail.column.dataset.foundationLayoutColumnviewColumnid);y.trigger("foundation-collection-navigate");aa("navigate",y,v.config);y.trigger("foundation-selections-change");
aa("change",y,v.config,null,{method:"handleNavigation"});if(B=v.delaySelectionEvent)v.delaySelectionEvent=null,V(G,!1,B.newSelectedItems,B.oldSelectedItems)};y.on("coral-columnview:navigate",C);return function(){y.off("coral-columnview:navigate",C)}}function I(v){var y=v.collection,G=v.collectionEl,C=G.dataset.foundationCollectionSrc;F(v);var B=function(K){K=K.originalEvent.detail;var X=K.column,ca=K.item;ca?"drilldown"!==ca.variant?ha(v,ca):ba(v,ca):Y(v,X,K.start)};C&&(G=A(G),P(v,G),O(G).start());
y.on("coral-columnview:loaditems",B);return function(){y.off("coral-columnview:loaditems",B)}}function Q(v,y){var G=v.collection,C=y.sortBy,B=y.sortOrder;y=v.collectionEl.dataset.foundationCollectionId;var K=R(n).adaptTo("foundation-ui");K.wait();return ia(v,y).always(function(){K.clearWait();aa("sort",G,v.config,null,{sortBy:C,sortOrder:B})})}var R=h,ea={SELECTION:"selection",DEFAULT:"default"},da=new WeakMap,W=new WeakMap;h=R(n).adaptTo("foundation-registry");h.register("foundation.layouts",{name:"foundation-layout-columnview",
doLayout:function(v,y){var G=R(v);if(v.classList.contains("foundation-collection")&&!da.has(v)){var C=!1;G.data("foundation-layout-collection.internal.reloaded")&&(C=G.data("foundation-layout-collection.internal.reloaded"));C={collectionEl:v,collection:G,config:y,bulkSelection:!1,reloaded:C,initialLoadEventTriggered:!1,stack:[]};da.set(v,C);aa("init",G,y);var B=G.data("foundation-layout-collection-switcher.internal.selectionIds");if(B){var K=d(v).filter(function(X){return 0<=B.indexOf(X.dataset.foundationCollectionItemId)});
l(K)}C.stack.push(E(C));C.stack.push(N(C));C.stack.push(M(C));C.stack.push(I(C));requestAnimationFrame(function(){V(v,!0);G.trigger("foundation-selections-change");aa("change",G,y,null,{method:"init"});G.trigger("foundation-collection-sort:changed")})}},clean:function(v,y){R(v).siblings(".granite-collection-loading-title-wrapper").remove();if(y=da.get(v))da.delete(v),Granite.UI.Foundation.Utils.everyReverse(y.stack,function(G){G&&G();return!0});Granite.UI.Foundation.Layouts.clean(v)}});h.register("foundation.adapters",
{type:"foundation-collection",selector:".foundation-layout-columnview.foundation-collection",adapter:function(v){var y=da.get(v),G=y.config,C=y.collection;C.data("foundation-layout-collection.internal.columnviewLoaded",!0);return{append:function(B){var K=A(v),X=R(K);K&&(Array.prototype.forEach.call(B,function(ca){K.items.add(ca)}),X.trigger("foundation-contentloaded"),0<B.length&&a(v)&&z(y,K).then(function(){C.trigger("foundation-selections-change");aa("change",C,G,null,{method:"append"})}))},clear:function(){var B=
A(v);B&&B.items.clear()},getPagination:function(){var B=A(v);return(B=W.get(B))?{offset:B.offset,limit:B.limit,hasNext:B.hasNext,guessTotal:-1}:null},load:function(B){var K=u(v,B);if(K)C.data("foundation-layout-collection.internal.columnviewLoaded")?(C.trigger("foundation-collection-reload"),aa("reload",C,G)):C.data("foundation-layout-collection.internal.columnviewLoaded",!0),K.click();else{K=w(v,B);if(!K)return ia(y,B);y.bulkSelection=!0;K=d(K);var X=m(v);K.forEach(function(ca){ca.selected=!1;ca.active=
!1});y.bulkSelection=!1;C.data("foundation-layout-collection.internal.columnviewLoaded")?(C.trigger("foundation-collection-reload"),aa("reload",C,G)):C.data("foundation-layout-collection.internal.columnviewLoaded",!0);L(v,B);C.trigger("foundation-collection-navigate");aa("navigate",C,G,null,{columnId:B});C.trigger("foundation-selections-change");aa("change",C,G,null,{method:"load"});V(v,!1,[],X)}return R.when(v)},isAllLoaded:function(){var B=this.getPagination();return B?0<t(v).length?!1:!1===B.hasNext:
!0},reload:function(){C.data("foundation-layout-collection.internal.columnviewLoaded",!0);return U(y,v.dataset.foundationCollectionId)}}}});h.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-columnview.foundation-collection",adapter:function(v){return{getElement:function(){var y=A(v,!0);return y?y.querySelector(".foundation-collection-meta"):null},getTitle:function(){var y=this.getElement();return y?y.dataset.foundationCollectionMetaTitle:null},getThumbnail:function(){var y=
this.getElement();return y?y.querySelector(".foundation-collection-meta \x3e .foundation-collection-meta-thumbnail"):null},isFolder:function(){var y=this.getElement();return y?"true"===y.dataset.foundationCollectionMetaFolder:!1},getRelationship:function(){var y=this.getElement();return y?y.dataset.foundationCollectionMetaRel:null}}}});h.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-columnview.foundation-collection",adapter:function(v){var y=da.get(v),G=
y.config,C=y.collection;return{count:function(){if(a(v)){var B=C.adaptTo("foundation-collection").getPagination();if(B&&-1!==B.guessTotal){var K=A(v);K=K?p(K):0;return B.guessTotal-K}}return m(v).length},selectAll:function(B){var K=A(v);if(K){var X=d(K);r(y,K);1===X.length&&"single"!==v.dataset.foundationSelectionsMode?Z(y,X[0]):x(v);z(y,K).then(function(){V(v,!1,m(K),[]);B||(C.trigger("foundation-selections-change"),aa("change",C,G,null,{method:"selectAll"}))})}},isAllSelected:function(){var B=A(v);
if(B){var K=d(B).length,X=m(v).length;if(0<K&&K===X)return B="false"!==B.dataset.foundationLayoutColumnviewHasmore,a(v)?!0:!B}return!1},clear:function(B){var K=m(v),X=m(v);y.bulkSelection=!0;q(X,void 0);y.bulkSelection=!1;x(v);V(v,!1,[],K);B||(C.trigger("foundation-selections-change"),aa("change",C,G,null,{method:"clear"}))},select:function(B){c(B)&&(B.selected=!0)},deselect:function(B){c(B)&&(B.selected=!1)}}}});h.register("foundation.adapters",{type:"foundation-collection-sort",selector:".foundation-layout-columnview.foundation-collection",
adapter:function(v){var y=da.get(v),G=y.collection;return{isSorted:function(C,B){var K=this.getSortValues();return K.sortBy===C&&K.sortOrder===B?!0:!1},getSortValues:function(){return{sortBy:v.dataset.foundationCollectionSortby||null,sortOrder:v.dataset.foundationCollectionSortorder||null}},doSort:function(C,B){C&&B||(C=B=null);if(!this.isSorted(C,B)){null===C&&null===B?(delete v.dataset.foundationCollectionSortby,delete v.dataset.foundationCollectionSortorder):(v.dataset.foundationCollectionSortby=
C,v.dataset.foundationCollectionSortorder=B);var K=R.Event("foundation-collection-sort:beforeChange",{sortName:C,sortDir:B});G.trigger(K);Q(y,{sortBy:C,sortOrder:B}).then(function(){G.trigger("foundation-collection-sort:changed")});return!0}return!1}}}})})(window,Granite.$,Granite.URITemplate);
(function(n,h,b,g,c){function a(D){var F=D.collection,J=function(O,S,P){O._foundationLayoutTable||"default"!==S||D.collectionEl.dataset.foundationModeGroup!==P||(D.bulkSelection=!0,F.find(".foundation-selections-item").each(function(V,Y){Y.selected=!1}),D.bulkSelection=!1,F.trigger("foundation-selections-change"),u("change",F,D.config,null,{method:"modeChange"}))};H(h).on("foundation-mode-change",J);return function(){H(h).off("foundation-mode-change",J)}}function d(D){var F=D.collection,J=D.collectionEl,
O=H(h.createElement("div")).addClass("foundation-ui-mask"),S=function(Y){if(!D.bulkLoading){Y=Y.originalEvent.detail;var fa=J.dataset.foundationSelectionsMode,ha=H(),Z=H();"single"===fa?(Y.oldSelection&&(Z=H(Y.oldSelection)),Y.selection&&(ha=H(Y.selection))):(Z=H(Y.oldSelection),ha=H(Y.selection));Z.removeClass("foundation-selections-item");ha.addClass("foundation-selections-item");Y="true"===J.dataset.foundationSelectionsSelectallMode;var ba=function(){e(F,!1,ha,Z);F.trigger("foundation-selections-change");
u("change",F,D.config,null,{method:"handleSelection"})};D.bulkSelection||Y?Y&&ba():D.lazyLoader&&0<F.has(".foundation-collection-item.is-lazyLoaded,.foundation-collection-item.is-pending").length?(D.bulkLoading=!0,O.appendTo(h.body),D.lazyLoader.loadItems(ha.toArray()).then(function(U){var ia=U.length-1;U.forEach(function(aa,E){aa.set("selected",!0,E!==ia);aa.classList.add("foundation-selections-item")});q(F);D.bulkLoading=!1;ba();O.detach()})):ba()}},P=function(){(h.activeElement===J||J.contains(h.activeElement))&&
F.adaptTo("foundation-selections").clear()};F.on("coral-table:change",S);Coral.keys.on("escape",P);var V=F.find("[coral-table-select]").on("change.foundation-layout-table",function(Y){Y.stopPropagation();Y=F.adaptTo("foundation-selections");this.checked?(J.dataset.foundationSelectionsSelectallMode="true",Y.selectAll()):Y.clear()});return function(){F.off("coral-table:change",S);Coral.keys.off("escape",P);V.off("change.foundation-layout-table")}}function e(D,F,J,O){var S=D[0].dataset.foundationModeGroup;
if(S){J=J?J.length:D.adaptTo("foundation-selections").count();O=O?O.length:0;var P=function(V){var Y=H.Event("foundation-mode-change");Y._foundationLayoutTable=!0;D.trigger(Y,[V,S])};(0===O||F)&&0<J?P("selection"):(0<O||F)&&0===J&&P("default")}}function f(D){var F=D.collection,J=D.collectionEl,O=function(S){if(J===S.target){var P=S.originalEvent.detail,V=P.column.dataset.foundationLayoutTableColumnName;a:{switch(P.direction||P.sortableDirection){case Coral.Table.Column.sortableDirection.DESCENDING:P=
"desc";break a;case Coral.Table.Column.sortableDirection.ASCENDING:P="asc";break a;case Coral.Table.Column.sortableDirection.DEFAULT:P=null;break a}P=void 0}F.adaptTo("foundation-collection-sort").doSort(V,P)&&S.preventDefault()}};J.dataset.foundationCollectionSortby&&J.dataset.foundationCollectionSortorder&&requestAnimationFrame(function(){x(J,J.dataset.foundationCollectionSortby,J.dataset.foundationCollectionSortorder)});F.on("coral-table:beforecolumnsort",O);return function(){F.off("coral-table:beforecolumnsort",
O)}}function m(D){var F=D.collection,J=D.collectionEl,O=J.dataset.foundationCollectionSrc;if(O){var S=function(V){var Y=H(n).adaptTo("foundation-util-paginator"),fa;D.paginator=new Y({el:V[0],limit:D.config.limit||20,size:D.config.size,wait:function(){J.dataset.graniteCollectionIsLoading="true";return{clear:function(){J.dataset.graniteCollectionIsLoading="false"}}},resolveURL:function(Z){var ba=F.adaptTo("foundation-collection-sort").getSortValues();return c.expand(O,{offset:Z.offset,limit:Z.limit,
size:Z.size,id:J.dataset.foundationCollectionId,sortName:ba.sortBy,sortDir:ba.sortOrder})},processResponse:function(Z,ba){var U=H.Deferred();J.dataset.graniteCollectionIsLoading="true";p(ba).then(function(ia){var aa=ia.items;fa=H.Deferred();k(D,F,D.config,aa,fa.promise());ia=ia.hasMore;void 0===ia&&(ia=aa.length>=Z.limit);J.dataset.graniteCollectionIsLoading="false";U.resolve({length:aa.length,hasNext:ia})});return U.promise()},onNewPage:function(){F.trigger("foundation-collection-newpage");u("newpage",
F,D.config);fa.resolve()}});Y=F.find(".foundation-collection-item").length;var ha="false"!==J.dataset.foundationLayoutTableHasmore;J.resetLayout(!0);D.paginator.start(Y,ha,!1,500);Y=H(n).adaptTo("foundation-collection-lazyloader");D.lazyLoader=new Y({scrollSrc:V[0],getItems:function(){return J.items.getAll()},load:function(Z,ba){Z=F.adaptTo("foundation-collection-sort").getSortValues();ba=c.expand(O,{offset:ba.offset,limit:ba.limit,size:ba.size,id:J.dataset.foundationCollectionId,sortName:Z.sortBy,
sortDir:Z.sortOrder});return H.ajax(ba).then(function(U){return p(U)}).then(function(U){return U.items})},onReplace:function(){z(F);F.trigger("foundation-contentloaded")},setupListeners:function(Z,ba){F.on("foundation-collection-navigate",ba);F.on("coral-table:columnsort",ba);return function(){F.off("foundation-collection-navigate",ba);F.off("coral-table:columnsort",ba)}}});D.lazyLoader.start()},P=F.children("[coral-table-scroll]");J.scrollContainer=P[0];P.length?S(P):requestAnimationFrame(function(){S(F.children("[coral-table-scroll]"))});
return function(){D.paginator&&D.paginator.destroy();D.lazyLoader&&D.lazyLoader.destroy()}}}function p(D){return H(n).adaptTo("foundation-util-htmlparser").parse(D).then(function(F){var J=H(F).children();if(J.hasClass("foundation-collection"))return F=J.find(".foundation-collection-item").toArray(),J=J[0].dataset.foundationLayoutTableHasmore,"true"===J?J=!0:"false"===J&&(J=!1),{items:F,hasMore:J}})}function k(D,F,J,O,S){F.find("tbody").append(O);Promise.resolve().then(function(){if(O.length&&"true"===
F[0].dataset.foundationSelectionsSelectallMode){O.forEach(function(V){V.classList.contains("is-lazyLoaded")||V.classList.contains("is-pending")||(V.set("selected",!0,!0),V.classList.add("foundation-selections-item"))});var P=H.when();D.lazyLoader&&(P=D.lazyLoader.loadItems(O).then(function(V){var Y=H.Deferred();Promise.resolve().then(function(){z(F);q(F);r(F);V.forEach(function(fa){fa.set("selected",!0,!0);fa.classList.add("foundation-selections-item")});Y.resolve()});return Y.promise()}));H.when(P,
S).then(function(){F.trigger("foundation-selections-change");u("change",F,J,null,{method:"append"})})}z(F);q(F);r(F);F.trigger("foundation-contentloaded")})}function t(D){var F=D.collection,J=function(S){F.adaptTo("foundation-collection-item-action").execute(S)},O=function(S){var P=H(S.target).closest("[coral-table-rowselect], button, a, .foundation-collection-item");P.hasClass("foundation-layout-table-cellwrapper")?1!==S.which||S.metaKey||S.shiftKey||S.altKey||(S.preventDefault(),J(P.closest(".foundation-collection-item")[0])):
P.hasClass("foundation-collection-item")&&(S.preventDefault(),J(P[0]))};F.on("click",".foundation-collection-item",O);return function(){F.off("click",".foundation-collection-item",O)}}function l(D){var F=D.collection,J=function(O){var S=O.originalEvent.detail,P=S.row;O=S.before;var V=S.oldBefore;if(S=D.config.rowReorderAction){var Y=(O=O?O.dataset.foundationCollectionItemId:void 0)?O.substring(O.lastIndexOf("/")+1):void 0;Y=S=c.expand(S,{item:P.dataset.foundationCollectionItemId,before:O,beforeName:Y});
var fa=S.indexOf("?");if(0<=fa){Y=S.substring(0,fa);var ha=S.substring(fa+1)}u("roworder",F,D.config,null,{before:O});var Z=H(n).adaptTo("foundation-ui");Z.wait();H.ajax({url:Y,method:"POST",data:ha}).always(function(){Z.clearWait();F.trigger("foundation-collection-reload");u("reload",F,D.config)}).fail(function(){var ba=b.I18n.get("Error"),U=b.I18n.get("Fail to reorder.");Z.alert(ba,U,"error");V?H(P).insertBefore(V):P.parentElement.appendChild(P)})}};F.on("coral-table:roworder",J);return function(){F.off("coral-table:roworder",
J)}}function q(D){D.find("col[is\x3dcoral-table-column]").each(function(F,J){F+=1;var O=J.getAttribute("alignment");D.find("th[is\x3dcoral-table-headercell]:nth-child("+F+"), td[is\x3dcoral-table-cell]:nth-child("+F+")").each(function(){var S=this.getAttribute("alignment");S&&"column"!==S||this.setAttribute("alignment",O)})})}function r(D){D.find("td[is\x3dcoral-table-cell][coral-table-rowselect]").length&&D.attr("variant","list")}function z(D){var F=h.querySelector(".granite-collection-pagetitle");
D.find("tr.foundation-collection-navigator").each(function(){var J=H(this);J.children("td:not([coral-table-rowselect]):not(:has([coral-table-rowselect]))").first().wrapInner(function(){if(!H(this).find("a").length){var O=h.createElement("a");O.className="foundation-layout-table-cellwrapper";var S=J[0].dataset.foundationCollectionNavigatorHref;if(S)O.target=J[0].dataset.foundationCollectionNavigatorTarget;else{if(!F||!D.is(F.dataset.graniteCollectionPagetitleTarget))return;S=c.expand(F.dataset.graniteCollectionPagetitleSrc,
{id:J.closest(".foundation-collection-item")[0].dataset.foundationCollectionItemId})}O.href=S;return H(O)}})})}function u(D,F,J,O,S){F="table";O=J.trackingElement;"change"===D?F="table-row":"roworder"===D?F="table-row":"sort"===D&&(F="table-column",O=S.sortBy);D={element:O||"No element defined",type:F,action:D,widget:{name:J.trackingElement||J.name||"foundation-layout-table",type:"table"},feature:J.trackingFeature||"No feature defined",attributes:S||{}};H(n).adaptTo("foundation-tracker").trackEvent(D)}
function w(D){switch(D){case "desc":return Coral.Table.Column.sortableDirection.DESCENDING;case "asc":return Coral.Table.Column.sortableDirection.ASCENDING;case "default":case null:return Coral.Table.Column.sortableDirection.DEFAULT}}function A(D,F,J){var O=D.collectionEl,S=D.collection,P=F.sortBy;F=F.sortOrder;if(J){D=w(F);P=O.querySelector("colgroup \x3e col[is\x3d'coral-table-column'][data-foundation-layout-table-column-name\x3d'"+P+"']");if(!P||!h.body.contains(P)||P.sortableDirection===D)return H.Deferred().reject();
P.sortableDirection=D;return H.Deferred().resolve()}var V=D.paginator;J=O.dataset.foundationCollectionSrc;var Y=H(n).adaptTo("foundation-ui");J=c.expand(J,{offset:0,limit:V.limit,size:V.size,id:O.dataset.foundationCollectionId,sortName:P,sortDir:F});fa&&fa.abort();var fa=H.ajax({url:J,cache:!1});Y.wait();u("sort",S,D.config,null,{sortBy:P,sortOrder:F});return fa.then(function(ha){p(ha).then(function(Z){var ba=Z.items,U=S.adaptTo("foundation-collection");Z=Z.hasMore;U.clear();U.append(ba);void 0===
Z&&(Z=ba.length>=V.limit);O.resetLayout(!0);V.restart(ba.length,Z)})},function(ha,Z){"abort"!==Z&&(ha=b.I18n.get("Error"),Z=b.I18n.get("Fail to load data."),Y.alert(ha,Z,"error"))}).always(function(){Y.clearWait()})}function x(D,F,J){J=w(J);(D=D.querySelector("colgroup \x3e col[is\x3d'coral-table-column'][data-foundation-layout-table-column-name\x3d'"+F+"']"))&&h.body.contains(D)&&D.sortableDirection!==J&&(F=D.sortableType,D.sortableType="custom",D.sortableDirection=J,D.sortableType=F)}function L(D,
F,J,O){var S=D.config,P=D.collection,V=D.collectionEl;D=V.dataset.foundationCollectionSrc;var Y=S.size;if(!D)return H.Deferred().reject().promise();J||(J=S&&S.limit||20);var fa=P.adaptTo("foundation-collection-sort").getSortValues();F=c.expand(D,{offset:0,limit:J,size:Y,id:F,sortName:fa.sortBy,sortDir:fa.sortOrder});return H.ajax({url:F,cache:!1}).then(function(ha){var Z=H.Deferred();H(n).adaptTo("foundation-util-htmlparser").parse(ha).then(function(ba){var U=H(ba).children();U.hasClass("foundation-collection")?
(O&&(ba=P.find(".foundation-selections-item").map(function(){return this.dataset.foundationCollectionItemId}).toArray(),U.data("foundation-layout-collection-switcher.internal.selectionIds",ba)),P.trigger("foundation-collection-reload"),u("reload",P,S),U.data("foundation-layout-collection.internal.columnviewLoaded",!0),b.UI.Foundation.Layouts.cleanAll(V),U.replaceAll(P),requestAnimationFrame(function(){U.trigger("foundation-collection-navigate");u("navigate",P,S)}),U.trigger("foundation-contentloaded"),
O&&U.removeData("foundation-layout-collection-switcher.internal.selectionIds"),Z.resolve(U[0])):Z.reject(Error("Invalid content"))});return Z.promise()},function(){var ha=b.I18n.get("Error"),Z=b.I18n.get("Fail to load data.");H(n).adaptTo("foundation-ui").alert(ha,Z,"error")})}var H=g,T=new WeakMap;g=H(n).adaptTo("foundation-registry");g.register("foundation.layouts",{name:"foundation-layout-table",doLayout:function(D,F){var J=H(D);if(J.hasClass("foundation-collection")&&!T.has(D)){var O={collectionEl:D,
collection:J,config:F,stack:[],bulkSelection:!1,bulkLoading:!1};T.set(D,O);if(O.collectionEl.hasAttribute("selectable")){var S=J.data("foundation-layout-collection-switcher.internal.selectionIds");S&&J.find(".foundation-collection-item").filter(function(){return 0<=S.indexOf(this.dataset.foundationCollectionItemId)}).each(function(){H(this).attr("selected","").addClass("foundation-selections-item")})}var P=J.find("[data-foundation-layout-table-column-name]").toArray();D=P.map(function(V){return V.dataset.foundationLayoutTableColumnName}).join(",");
P=P.filter(function(V){return V.hidden}).map(function(V){return V.dataset.foundationLayoutTableColumnName}).join(",");u("init",J,F,null,{columns:D,hiddenColumns:P});O.stack.push(a(O));O.stack.push(d(O));O.stack.push(f(O));O.stack.push(m(O));O.stack.push(t(O));O.stack.push(l(O));z(J);r(J);q(J);requestAnimationFrame(function(){e(J,!0);J.trigger("foundation-collection-newpage");u("newpage",J,F);J.trigger("foundation-selections-change");u("change",J,F,null,{method:"init"});J.trigger("foundation-collection-sort:changed")})}},
clearItems:function(D){D.items.clear()},clean:function(D,F){if(F=T.get(D))T.delete(D),b.UI.Foundation.Utils.everyReverse(F.stack,function(J){J&&J();return!0});b.UI.Foundation.Layouts.clean(D)}});g.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-table.foundation-collection",adapter:function(D){var F=T.get(D),J=F.collection,O=F.collectionEl,S=F.config;return{append:function(P){k(F,J,S,P)},clear:function(){J.find(".foundation-collection-item").remove()},getPagination:function(){var P=
F.paginator;if(!P)return null;var V=parseInt(J.attr("data-foundation-layout-table-guesstotal")||"-1",10);return{offset:P.offset,limit:P.limit,guessTotal:-1===V?V:Math.max(P.offset,V),hasNext:-1===V?P.hasNext:P.offset>=V?P.hasNext:null}},isAllLoaded:function(){var P;var V=H(D);(P=V.adaptTo("foundation-collection").getPagination())?(V=V.find(".foundation-collection-item"),P=V.is(".is-lazyLoaded, .is-pending")?!1:null===P.hasNext&&-1!==P.guessTotal?!(P.guessTotal>V.length):!1===P.hasNext):P=!0;return P},
load:function(P){return L(F,P)},reload:function(){var P=this.getPagination();if(P)var V=P.offset;return L(F,O.dataset.foundationCollectionId,V,!0)}}}});g.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-table.foundation-collection",adapter:function(D){var F=H(D).find("\x3e caption \x3e .foundation-collection-meta"),J=F[0];return J?{getElement:function(){return J},getTitle:function(){return J.dataset.foundationCollectionMetaTitle},getThumbnail:function(){return F.children(".foundation-collection-meta-thumbnail")[0]},
isFolder:function(){return"true"===J.dataset.foundationCollectionMetaFolder},getRelationship:function(){return J.dataset.foundationCollectionMetaRel}}:null}});g.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-table.foundation-collection",adapter:function(D){var F=T.get(D),J=F.collection,O=F.collectionEl,S=F.config;return{count:function(){if("true"===O.dataset.foundationSelectionsSelectallMode){var P=J.adaptTo("foundation-collection").getPagination();if(P&&
-1!==P.guessTotal){var V=J.find(".foundation-collection-item:not(.foundation-selections-item)").length;return P.guessTotal-V}}return J.find(".foundation-selections-item").length},selectAll:function(P){F.bulkSelection=!0;var V=J.find(".foundation-selections-item"),Y=J.find(".foundation-collection-item:not(.foundation-selections-item):not(.is-lazyLoaded):not(.is-pending)").each(function(ba){0<ba&&this.set("selected",!0,!0)}),fa=V.add(Y),ha=J.find(".foundation-collection-item.is-lazyLoaded,.foundation-collection-item.is-pending");
if(ha.length){var Z=H(h.createElement("div")).addClass("foundation-ui-mask").append('\x3ccoral-wait size\x3d"L" centered\x3e\x3c/coral-wait\x3e');Z.appendTo(h.body);F.lazyLoader.loadItems(ha.toArray()).then(function(ba){Promise.resolve().then(function(){ba.forEach(function(U){U.set("selected",!0,!0);U.classList.add("foundation-selections-item")});Y.first().prop("selected",!0);F.bulkSelection=!1;e(J,!1,J.find(".foundation-selections-item"),V);P||(J.trigger("foundation-selections-change"),u("change",
J,S,null,{method:"selectAll"}));Z.detach()})})}else Y.first().prop("selected",!0),F.bulkSelection=!1,e(J,!1,fa,V),P||(J.trigger("foundation-selections-change"),u("change",J,S,null,{method:"selectAll"}))},isAllSelected:function(){var P="true"===O.dataset.foundationSelectionsSelectallMode,V=J.adaptTo("foundation-collection").getPagination();V=V?V.hasNext:!1;var Y=J.find(".foundation-collection-item").length,fa=J.find(".foundation-selections-item").length;return 0<Y&&Y===fa?P?!0:!V:!1},clear:function(P){F.bulkSelection=
!0;var V=J.find(".foundation-selections-item").each(function(Y){0<Y&&this.set("selected",!1,!0)});V.first().prop("selected",!1);F.bulkSelection=!1;e(J,!1,H(),V);P||(J.trigger("foundation-selections-change"),u("change",J,S,null,{method:"selectAll"}))},select:function(P){H(P).hasClass("foundation-collection-item")&&(P.selected=!0)},deselect:function(P){H(P).hasClass("foundation-collection-item")&&(P.selected=!1)}}}});g.register("foundation.adapters",{type:"foundation-collection-sort",selector:".foundation-layout-table.foundation-collection",
adapter:function(D){var F=H(D),J=T.get(D);return{isSorted:function(O,S){var P=this.getSortValues();return P.sortBy===O&&P.sortOrder===S?!0:!1},getSortValues:function(){return{sortBy:D.dataset.foundationCollectionSortby||null,sortOrder:D.dataset.foundationCollectionSortorder||null}},doSort:function(O,S,P){P=P?P:O;O&&S||(O=S=null);if(!this.isSorted(O,S)&&"remote"===J.config.sortMode){null===O&&null===S?(delete D.dataset.foundationCollectionSortby,delete D.dataset.foundationCollectionSortorder):(D.dataset.foundationCollectionSortby=
O,D.dataset.foundationCollectionSortorder=S);var V={sortBy:O,sortOrder:S};O=H.Event("foundation-collection-sort:beforeChange",{sortName:O,sortDir:S});F.trigger(O);A(J,V,!1).fail(function(){}).then(function(){F.trigger("foundation-collection-sort:changed")});x(D,P,S);return!0}return!1}}}})})(window,document,Granite,Granite.$,Granite.URITemplate);
(function(n,h,b){function g(c){if(c&&c.getLabelledBy)return c.getLabelledBy()}h(n).adaptTo("foundation-registry").register("foundation.validation.validator",{selector:".foundation-layout-actionfield-field",show:function(c,a){var d=h(c),e=d.closest(".coral-Form-field");(c=d.adaptTo("foundation-field"))&&c.setInvalid&&c.setInvalid(!0);e.nextAll(".coral-Form-fieldinfo").addClass("u-coral-screenReaderOnly");var f=d.data("foundation-validation.internal.error");if(f){var m=h(f).data("foundation-validation.internal.error.tooltip");
m.content.innerHTML=a;f.parentNode||(d.after(f,m),a=g(c),m=m.id,c&&c.setLabelledBy&&c.setLabelledBy(a?a+" "+m:m))}else f=new b.Icon,f.icon="alert",f.classList.add("coral-Form-fielderror"),m=new b.Tooltip,m.variant="error",m.placement=e.closest("form").hasClass("coral-Form--vertical")?"left":"bottom",m.target=f,m.content.innerHTML=a,m.id=b.commons.getUID(),h(f).data("foundation-validation.internal.error.tooltip",m),f.setAttribute("aria-labelledby",m.id),f.setAttribute("tabindex",0),d.data("foundation-validation.internal.error",
f),d.after(f,m),a=g(c),m=m.id,c&&c.setLabelledBy&&c.setLabelledBy(a?a+" "+m:m)},clear:function(c){var a=h(c);c=a.closest(".coral-Form-field");var d=a.adaptTo("foundation-field");d&&d.setInvalid&&d.setInvalid(!1);if(a=a.data("foundation-validation.internal.error")){var e=h(a).data("foundation-validation.internal.error.tooltip");e.hide();e.remove();a.remove();(a=g(d))&&-1!==a.indexOf(e.id)&&(a=a.split(" ").filter(function(f){return f!==e.id}).join(" "),d&&d.setLabelledBy&&d.setLabelledBy(a))}c.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly")}})})(window,
Granite.$,Coral);
(function(n,h,b){var g=b(n).adaptTo("foundation-registry"),c=Granite.UI.Foundation.Utils.debounce;b(h).on("foundation-contentloaded",function(a){b(".foundation-layout-panel-rail-activate-panel").each(function(){b(this).removeClass("foundation-layout-panel-rail-activate-panel").find("coral-panel[selected]").trigger("foundation-toggleable-show")});b(".foundation-container-resizable").each(function(){var d=b(this),e=this.parentElement,f=d.adaptTo("foundation-container-resizable"),m=d.next(".foundation-layout-panel-content"),
p=new Number(m[0].dataset.graniteLayoutContentMinWidth);isNaN(p)||f.initialize();f.registerEvent(this,"foundation-toggleable-show",function(){d.css("margin-left",0)},!0);f.registerEvent(this,"foundation-toggleable-hide",function(){d.css("margin-left",-f.width)},!0);var k=this.dataset.graniteLayoutPanelSaveKey;k&&f.registerEvent(this,"foundation-resize-end",function(){b.cookie(k,f.width,{expires:7,path:"/"})});var t=c(function(){b.cookie(k,f.width,{expires:7,path:"/"})},200),l=function(){n.requestAnimationFrame(function(){var q=
m.width();q<=p&&(f.setWidth(q-p),t());f.maxWidth=Math.max(f.minWidth,e.offsetWidth-p)})};l();Coral.commons.addResizeListener(m[0],l)})});g.register("foundation.adapters",{type:"foundation-toggleable",selector:".foundation-layout-panel-rail.foundation-toggleable",adapter:function(a){var d=b(a);return{isOpen:function(){return a.classList.contains("foundation-layout-panel-rail-active")},show:function(e){a.classList.add("foundation-layout-panel-rail-active");d.trigger("foundation-toggleable-show")},hide:function(){a.classList.remove("foundation-layout-panel-rail-active");
d.find("\x3e coral-panelstack \x3e coral-panel.foundation-layout-panel-rail-panel[selected]").prop("selected",!1).trigger("foundation-toggleable-hide");d.trigger("foundation-toggleable-hide")}}}});g.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-panel.foundation-layout-panel-rail-panel.foundation-toggleable",adapter:function(a){var d=b(a);return{isOpen:function(){return a.selected&&d.closest(".foundation-layout-panel-rail").adaptTo("foundation-toggleable").isOpen()},
show:function(e){e=d.parent("coral-panelstack")[0].selectedItem;a.selected=!0;var f=d.closest(".foundation-layout-panel-rail");f.addClass("foundation-layout-panel-rail-active");e&&b(e).trigger("foundation-toggleable-hide");d.trigger("foundation-toggleable-show");f.trigger("foundation-toggleable-show")},hide:function(){a.selected=!1;var e=d.closest(".foundation-layout-panel-rail");e.removeClass("foundation-layout-panel-rail-active");d.trigger("foundation-toggleable-hide");e.trigger("foundation-toggleable-hide")}}}});
b(h).on("foundation-toggleable-show","coral-panel.foundation-layout-panel-rail-panel",function(a){if(a=this.dataset.foundationLayoutPanelRailPanelSrc){var d=b(this);d.data("foundation-layout-panel-rail-panel.internal.loaded")||(d.data("foundation-layout-panel-rail-panel.internal.loaded",!0),b.ajax({url:a,cache:!1}).done(function(e){b(n).adaptTo("foundation-util-htmlparser").parse(e).then(function(f){b(d[0].content).html("").append(f);d.trigger("foundation-contentloaded")})}).fail(function(){var e=
Granite.I18n.get("Error"),f=Granite.I18n.get("Something went wrong.");b(n).adaptTo("foundation-ui").alert(e,f,"error")}))}})})(window,document,Granite.$);
(function(n,h,b){function g(a,d,e,f){this.container=a;this.active=!0;this.width=a.offsetWidth;this.minWidth=e||-1;this.maxWidth=f||Number.MAX_VALUE;this.listeners=[];this.resizeHandle=d;this._dragFn=this.drag.bind(this);this._endDragFn=this.endDrag.bind(this)}var c=b(n).adaptTo("foundation-registry");g.prototype.setWidth=function(a){this.width=Math.min(Math.max(this.minWidth,this.width+a),this.maxWidth);this.container.style.width=this.width+"px"};g.prototype.getEventPageX=function(a){if(a.pageX)return a.pageX;
if(a.touches&&a.touches.length)return a.touches[0].pageX};g.prototype.startDrag=function(a){this.active&&(a.stopPropagation(),this.addMoveListeners(),this.lastX=this.getEventPageX(a),h.body.classList.add("u-coral-closedHand"),this.container.classList.add("is-dragging"))};g.prototype.endDrag=function(a){this.drag(a);this.container.dispatchEvent(new CustomEvent("foundation-resize-end",{bubbles:!0}));this.removeMoveListeners();h.body.classList.remove("u-coral-closedHand");this.container.classList.remove("is-dragging")};
g.prototype.drag=function(a){this.active&&(a.stopPropagation(),requestAnimationFrame(function(){var d=Math.min(this.getEventPageX(a),n.outerWidth);this.setWidth(d-this.lastX);this.lastX=d}.bind(this)))};g.prototype.initialize=function(){this._initialized||(this.resizeHandle&&(this.registerEvent(this.resizeHandle,"mousedown",this.startDrag.bind(this)),this.registerEvent(this.resizeHandle,"touchstart",this.startDrag.bind(this))),this._initialized=!0)};g.prototype.addMoveListeners=function(){n.addEventListener("mouseup",
this._endDragFn);n.addEventListener("mousemove",this._dragFn);n.addEventListener("touchup",this._endDragFn);n.addEventListener("touchmove",this._dragFn)};g.prototype.removeMoveListeners=function(){n.removeEventListener("mousemove",this._dragFn);n.removeEventListener("mouseup",this._endDragFn);n.removeEventListener("touchup",this._endDragFn);n.removeEventListener("touchmove",this._dragFn)};g.prototype.dispose=function(){this.listeners.each(function(a){a.elem&&(a.useJquery?b(a.elem).off(a.eventName,
a.callback):a.elem.removeEventListener(a.eventName,a.callback))});this.container=this.resizeHandle=this.listeners=null};g.prototype.registerEvent=function(a,d,e,f){this.listeners.push({elem:a,eventName:d,callback:e,useJquery:f});f?b(a).on(d,e):a.addEventListener(d,e)};c.register("foundation.adapters",{type:"foundation-container-resizable",selector:".foundation-container-resizable",adapter:function(a){var d=new Number(a.dataset.graniteLayoutPanelMinWidth),e=a.querySelector(".foundation-container-resizable-handle");
isNaN(d)&&(d=-1);if(e&&("ontouchstart"in n||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints)){var f=h.createElement("div");f.classList.add("foundation-container-resizable-handle-drag");e.appendChild(f)}return new g(a,e,d)}})})(window,document,Granite.$);
(function(n,h){function b(e){var f=e.data("foundationAdvancedselectControlSrc");if(f){var m=e.closest(".foundation-advancedselect");if(m.length){var p=h(window).adaptTo("foundation-ui");p.wait();var k=m.find(".foundation-advancedselect-navigator"),t=m.find(".foundation-advancedselect-collection");h.ajax(f).done(function(l){var q=h(window).adaptTo("foundation-util-htmlparser");l=Granite.UI.Foundation.Utils.sanitizeHtml(l);q.parse(l).then(function(r){r=h(r.querySelectorAll(".foundation-advancedselect"));
var z=r.find(".foundation-advancedselect-navigator");k.replaceWith(z);var u=t.adaptTo("foundation-collection");m.data("foundation-advancedselect.internal.ignoreselectionevent",!0);u.clear();u.append(r.find(".foundation-collection-item").toArray());m.removeData("foundation-advancedselect.internal.ignoreselectionevent");g(m,z,t);m.trigger("foundation-contentloaded");p.clearWait()})}).fail(function(){p.clearWait();var l=Granite.I18n.get("Error"),q=Granite.I18n.get("Something went wrong.");p.alert(l,
q,"error")})}}}function g(e,f,m){f=f.data("foundationAdvancedselectNavigatorPath").toString();(f=(e.data("foundation-advancedselect.internal.values")||{})[f])&&f.each(function(p,k){e.find(".foundation-collection-item[data-foundation-collection-item-id]").each(function(){h(this).data("foundationCollectionItemId")===k.value&&m.adaptTo("foundation-selections").select(this)})})}function c(e,f){var m=e.find(".foundation-advancedselect-navigator");m=m.length?m.data("foundationAdvancedselectNavigatorPath").toString():
"_default";var p=e.data("foundation-advancedselect.internal.values");p||(p={},e.data("foundation-advancedselect.internal.values",p));p[m]&&p[m].remove();var k=e.data("foundationAdvancedselectName");e=e.find(".foundation-advancedselect-collection .foundation-selections-item").map(function(){var t=h(this),l=t.data("foundationCollectionItemId");l?t=h(n.createElement("input")).prop("type","hidden").prop("name",k).prop("value",l):(t=t.find("input.aria-value[type\x3dhidden]").clone(),t.prop("disabled",
!1),k&&!t.prop("name")&&t.prop("name",k));return t.appendTo(f)[0]});p[m]=e}h(n).on("click",".foundation-advancedselect-control",function(e){e.preventDefault();e=h(this);"foundation.navigate"===e.data("foundationAdvancedselectControlAction")&&b(e)});h(n).on("foundation-selections-change",".foundation-advancedselect",function(e){e=h(this);if(!e.data("foundation-advancedselect.internal.ignoreselectionevent")){var f=e.find(".foundation-advancedselect-values");c(e,f);var m=e.find(".foundation-advancedselect-status");
m.length&&(f=m.data("foundationAdvancedselectStatusTemplate").replace("{{count}}",f.children().length),m.html(f));if(e=e.adaptTo("foundation-validation"))e.checkValidity(),e.updateUI()}});var a=h(window).adaptTo("foundation-registry");a.register("foundation.validation.selector",{submittable:".foundation-advancedselect",candidate:".foundation-advancedselect",exclude:".foundation-advancedselect *"});var d;a.register("foundation.validation.validator",{selector:".foundation-advancedselect",validate:function(e){if("true"===
e.getAttribute("aria-required")&&0===h(e).find(".foundation-advancedselect-values \x3e *").length)return d||(d=Granite.I18n.get("Please fill out this field.")),d}})})(document,Granite.$);
(function(n,h){function b(c){c=c.children(":not(.foundation-nestedcheckboxlist)");return c.is("input:checkbox:not([disabled])")?c:c.find("input:checkbox:not([disabled])")}function g(c,a){var d=c.closest(".foundation-nestedcheckboxlist").closest("li.foundation-nestedcheckboxlist-item");if(d.length){c=Array.prototype.every.call(c.siblings("li.foundation-nestedcheckboxlist-item"),function(m){return b(h(m)).is(":checked")===a});var e=b(d),f=e.prop("indeterminate");c?f&&(e.prop({indeterminate:!1,checked:a}),
g(d,a)):f||(e.prop({indeterminate:!0,checked:!1}),g(d,a))}}h(n).on("change",".foundation-nestedcheckboxlist-item",function(c){c.stopPropagation();var a=h(this);if(!0!==a.closest(".foundation-nestedcheckboxlist").data("foundation-nestedcheckboxlist-disconnected")){c=h(c.target).prop("checked");var d=a.find(".foundation-nestedcheckboxlist");d.length&&!0===d.data("foundation-nestedcheckboxlist-disconnected")||(a.find("ul input:checkbox").prop({indeterminate:!1,checked:c}),g(a,c))}})})(document,Granite.$);
(function(n,h,b){h(n).on("foundation-contentloaded",function(g){Array.from(g.target.querySelectorAll(".betty-ActionBar")).forEach(function(c){var a=h(c);a.data("betty-ActionBar.internal.init")||(a.data("betty-ActionBar.internal.init",!0),b.commons.ready(c,function(){b.commons.addResizeListener(c,function(d){360>=c.getBoundingClientRect().width?c.classList.add("betty-ActionBar--collapsed"):c.classList.remove("betty-ActionBar--collapsed");c._debounceOnLayout()})}))})})})(document,Granite.$,Coral);
(function(n,h,b,g){function c(){var f=Reflect.construct(HTMLElement,[],this.constructor);f._construct();return f}function a(){var f=Reflect.construct(HTMLElement,[],this.constructor);f._construct();return f}function d(f,m,p,k,t){f={element:k.trackingElement||"No element defined",feature:f.trackingFeature||"No feature defined",type:"change"===p?"breadcrumbs-item":"breadcrumbs-popover",action:p,widget:{name:f.trackingElement||"No widget defined",type:"breadcrumbs"},attributes:t||{}};h(window).adaptTo("foundation-tracker").trackEvent(f)}
var e=h(window).adaptTo("foundation-util-propertybuilder");c.prototype=Object.create(HTMLElement.prototype);c.prototype.constructor=c;c.prototype._construct=function(){var f=this;this._icon=(new b.Icon).set({icon:this.icon,size:"S",alt:""});this._icon.classList.add("betty-breadcrumbs-button-icon");this._headingElement=n.createElement("span");this._headingElement.setAttribute("role","heading");this._headingElement.setAttribute("aria-level","1");this._buttonText=n.createElement("span");var m=(new b.Icon).set({icon:"chevronDown",
size:"XS",alt:""});m.classList.add("betty-breadcrumbs-button-chevron");m.setAttribute("autoarialabel","off");m.setAttribute("aria-hidden",!0);this._button=new b.Button;this._button.setAttribute("variant","quiet");this._button.classList.add("betty-breadcrumbs-button");this._button.type="button";this._button.autocomplete="off";this._button.tracking="off";this._button.setAttribute("aria-haspopup","listbox");var p=g.I18n.get("Change file or folder");this._buttonHiddenAccessibilityLabel=n.createElement("span");
this._buttonHiddenAccessibilityLabel.setAttribute("role","img");this._buttonHiddenAccessibilityLabel.classList.add("betty-breadcrumbs-button-hidden-accessibility-label");this._buttonHiddenAccessibilityLabel.hidden=!0;this._buttonHiddenAccessibilityLabel.setAttribute("aria-label",", "+p);var k=n.createElement("span");k.className="betty-breadcrumbs-button-innerwrapper";this._button.label.appendChild(k);k.appendChild(this._icon);k.appendChild(this._buttonText);k.appendChild(this._buttonHiddenAccessibilityLabel);
k.appendChild(m);this._selectListEl=new b.SelectList;this._selectListEl.tracking="off";this._selectListEl.setAttribute("aria-label",p);var t=!1;this._selectListEl.on("coral-selectlist:change",function(q){var r=q.detail.selection;if(t)t=!1;else{var z=h(r).data("betty-breadcrumbs.internal.targetItem");t=!0;requestAnimationFrame(function(){r.selected=!1;requestAnimationFrame(function(){h(r).attr("aria-selected","true").siblings("[aria-selected\x3d'true']").attr("aria-selected","false")})});l.open=!1;
if(!z.selected){z.selected=!0;var u=n.createEvent("HTMLEvents");u.initEvent("change",!0,!1);f.dispatchEvent(u);d(f,q,"change",z)}}});var l=(new b.Popover).set({target:this._button,alignMy:"center top",alignAt:"center top",tracking:"off"});l.classList.add("betty-breadcrumbs-popover");l.content.appendChild(this._selectListEl);l.setAttribute("role","presentation");l.removeAttribute("aria-live");l.removeAttribute("aria-hidden");l.removeAttribute("tabindex");l.on("coral-overlay:beforeopen",function(){f._updateSelectList()});
l.on("coral-overlay:open",function(q){d(f,q,"open",f.selectedItem)});l.on("coral-overlay:close",function(q){d(f,q,"close",f.selectedItem)});this.insertBefore(l,this.firstChild);this.insertBefore(this._headingElement,this.firstChild);this._headingElement.appendChild(this._button);this._isItemDirty=!0};c.prototype.attributeChangedCallback=function(f,m,p){"icon"===f&&(this._icon.icon=p)};Object.defineProperties(c.prototype,{icon:e.createAttrBasedProperty("icon",""),selectedItem:{get:function(){var f=
null;h(this).children("betty-breadcrumbs-item").each(function(){if(this.selected)return f=this,!1});return f}},trackingFeature:e.createAttrBasedProperty("trackingfeature",""),trackingElement:e.createAttrBasedProperty("trackingelement","")});c.prototype._onItemAttached=function(f){this._isItemDirty=!0;f.selected?this._onSelect(f):this.selectedItem||(f.selected=!0);this._updateButtonDisability()};c.prototype._onItemDetached=function(f){this._isItemDirty=!0;f.selected&&this._onUnselect(f);this._updateButtonDisability()};
c.prototype._onSelect=function(f){h(this).children("betty-breadcrumbs-item").not(f).each(function(){this._selected=!1});this._updateButtonText(f)};c.prototype._onUnselect=function(f){h(this).children("betty-breadcrumbs-item").not(f).first().prop("selected",!0)};c.prototype._onButtonTextChange=function(f){this._isItemDirty=!0;this.selectedItem===f&&this._updateButtonText(f)};c.prototype._updateButtonDisability=function(){var f=this._isItemDirty&&this.contains(n.activeElement);this._button.disabled=
1>=h(this).children("betty-breadcrumbs-item").length;(this._buttonHiddenAccessibilityLabel.hidden=this._button.disabled)&&f?(this._headingElement.tabIndex=-1,this._headingElement.style.outline="none",this._headingElement.focus()):(this._headingElement.removeAttribute("tabindex"),this._headingElement.style.outline="")};c.prototype._updateButtonText=function(f){this._buttonText.textContent=g.I18n.getVar(f.textContent)};c.prototype._updateSelectList=function(){if(this._isItemDirty){var f=this._selectListEl;
f.items.clear();h(this).children("betty-breadcrumbs-item").each(function(){var m=this,p=new b.SelectList.Item;p.classList.add("betty-breadcrumbs-selectlist-item");p.content.textContent=this.textContent;h(p).data("betty-breadcrumbs.internal.targetItem",m);f.items.add(p);requestAnimationFrame(function(){p.setAttribute("aria-selected",m.selected)})});this._isItemDirty=!1}};c.observedAttributes=["icon"];window.customElements.define("betty-breadcrumbs",c);a.prototype=Object.create(HTMLElement.prototype);
a.prototype.constructor=a;a.prototype._construct=function(){this._selected=!1;this._watchDescendants()};a.prototype.connectedCallback=function(){h(this.parentElement).is("betty-breadcrumbs")&&(this._parent=this.parentElement,this._parent._onItemAttached(this))};a.prototype.disconnectedCallback=function(){this._parent&&this._parent._onItemDetached(this);this._parent=null};Object.defineProperties(a.prototype,{selected:{get:function(){return this._selected},set:function(f){!!f!==this._selected&&(this._selected=
!!f,this._parent&&(this._selected?this._parent._onSelect(this):this._parent._onUnselect(this)))}},trackingElement:e.createAttrBasedProperty("trackingelement","")});a.prototype._watchDescendants=function(){var f=this;(new MutationObserver(function(m){f._parent&&f._parent._onButtonTextChange(f)})).observe(this,{childList:!0})};window.customElements.define("betty-breadcrumbs-item",a)})(document,Granite.$,Coral,Granite);
(function(n,h){h(n).on("click",".granite-collection-deselect",function(b){b.preventDefault();if(b=this.dataset.graniteCollectionDeselectTarget)if(b=n.querySelector(b)){var g=h(b).adaptTo("foundation-selections"),c=b.selectedItem;delete b.dataset.foundationSelectionsSelectallMode;g.clear();c&&c.focus()}});h(n).on("click",".foundation-collection-selectall",function(b){if(b=this.dataset.foundationCollectionSelectallTarget){var g=n.querySelector(b);g&&(b=Array.from(n.querySelectorAll(".granite-collection-deselect")).find(function(c){return g.matches(c.dataset.graniteCollectionDeselectTarget)}))&&
function d(a){window.requestAnimationFrame(function(){a.closest("[coral-actionbar-offscreen]")?d(a):a.focus()})}(b)}})})(document,Granite.$);
(function(n,h,b,g){function c(f,m,p){var k=n.createElement("betty-breadcrumbs-item");k.textContent=f;k.dataset.graniteCollectionNavigatorCollectionid=m;k.selected=p;return k}function a(f,m){var p=m.dataset.foundationCollectionId;p.startsWith("parentof:")&&(p=p.substring(9));f.id=f.id?f.id:g.commons.getUID();var k=Array.from(f.querySelectorAll("#"+f.id+" \x3e betty-breadcrumbs-item")),t=window.location.pathname,l=k.find(function(A){return A.dataset.graniteCollectionNavigatorCollectionid===p||t===A.dataset.graniteCollectionNavigatorHref});
if(l)l.selected=!0,h(l).prevAll("betty-breadcrumbs-item").remove();else{l=Array.from(m.querySelectorAll(".foundation-collection-item")).find(function(A){return A.dataset.foundationCollectionItemId===p});if(l){var q=l.closest("coral-columnview-column").dataset.foundationLayoutColumnviewColumnid;var r=k.find(function(A){return A.dataset.graniteCollectionNavigatorCollectionid===q})}if(q&&r&&0!==r.length)m=h(r).prev("betty-breadcrumbs-item"),(k=m[0])?(k.textContent=l.querySelector(".foundation-collection-item-title").textContent,
k.dataset.graniteCollectionNavigatorCollectionid=l.dataset.foundationCollectionItemId,k.selected=!0):(k=n.createElement("betty-breadcrumbs-item"),m=h(k),k.textContent=l.querySelector(".foundation-collection-item-title").textContent,k.dataset.graniteCollectionNavigatorCollectionid=l.dataset.foundationCollectionItemId,k.selected=!0,r.parentNode.insertBefore(k,r)),m.prevAll("betty-breadcrumbs-item").remove();else{r=null;l=f.querySelector("#"+f.id+" \x3e betty-breadcrumbs-item:last-of-type");var z=l.textContent,
u=l.dataset.graniteCollectionNavigatorCollectionid;l=null;k.forEach(function(A){A.remove()});m.id=m.id?m.id:g.commons.getUID();var w=Array.from(m.querySelectorAll("#"+m.id+" \x3e coral-columnview-column"));w.forEach(function(A,x){var L=n.createElement("betty-breadcrumbs-item");if(x<w.length-1){if(A=A.querySelector(".foundation-collection-item[data-foundation-collection-item-id\x3d'"+w[x+1].dataset.foundationLayoutColumnviewColumnid+"']"))L.textContent=A.querySelector(".foundation-collection-item-title").textContent,
L.dataset.graniteCollectionNavigatorCollectionid=A.dataset.foundationCollectionItemId;null!==r?r.parentNode.insertBefore(L,r):f.appendChild(L);r=L}else r&&(r.selected=!0),L=c(z,u),f.appendChild(L)})}}}function d(f,m){var p=m.dataset.foundationCollectionId;m=h(m);f.id||(f.id=g.commons.getUID());var k=Array.from(f.querySelectorAll("#"+f.id+" \x3e betty-breadcrumbs-item")),t=window.location.pathname,l=k.find(function(A){return A.dataset.graniteCollectionNavigatorCollectionid===p||t===A.dataset.graniteCollectionNavigatorHref});
if(l)l.selected=!0,h(l).prevAll("betty-breadcrumbs-item").remove();else{if(l=n.querySelector(".shell-collectionpage-tree"))if(l=l.getParentIdTree(p)){var q=!1,r=0;l.length-1<k.length&&(q=!0);if(!q){var z=l.slice(0).reverse();z.shift();var u=l.length-1>k.length?k.length:l.length-1;for(r=0;r<u-1;++r)if(z[r].id!==k[r].dataset.graniteCollectionNavigatorCollectionid){q=!0;break}}if(q){for(r=0;r<k.length-1;++r)k[r].remove();f=k[k.length-1];for(r=1;r<l.length;++r){var w=c(l[r].title,l[r].id);f.parentNode.insertBefore(w,
f);f=w}w.selected=!0;return}}if(w=m.adaptTo("foundation-collection-meta"))w=c(w.getTitle(),p,!0),f=f.querySelector("#"+f.id+" \x3e betty-breadcrumbs-item:first-of-type"),f.parentNode.insertBefore(w,f)}}function e(f,m,p){var k=History.getState().data.shellCollection,t=f.dataset.graniteCollectionPagetitleSrc;m=m.dataset.foundationCollectionId;(!k||k.id!==m)&&t&&(k=f.dataset.graniteCollectionPagetitleBase,p&&(k=p+" | "+k),p=b.expand(t,{id:m}),History.pushState({shellCollection:{id:m,target:f.dataset.graniteCollectionPagetitleTarget}},
k,p),f=n.head.querySelector("meta[name\x3d'foundation.tracking.page']").getAttribute("content"))&&(f=JSON.parse(f),f.assetId=m,h(window).adaptTo("foundation-tracker").trackPage(f))}h(function(){var f=n.head.querySelector(".granite-collection-pagetitle");if(f){var m=History.getState();f=f.dataset.graniteCollectionPagetitleTarget;var p=n.querySelector(f).dataset.foundationCollectionId;m.data.shellCollection={id:p,target:f};History.replaceState(m.data);h(window).on("statechange",function(){var k=History.getState().data.shellCollection;
if(k){var t=n.querySelector(k.target),l=h(t);t&&t.dataset.foundationCollectionId!==k.id&&l.adaptTo("foundation-collection").load(k.id)}})}});h(n).on("foundation-collection-navigate",".foundation-collection",function(f){var m=this,p=Array.from(n.querySelectorAll(".granite-collection-navigator"));f=Array.from(n.querySelectorAll(".granite-collection-pagetitle"));p.forEach(function(k){m.matches(k.dataset.graniteCollectionNavigatorTarget)&&(m.classList.contains("foundation-layout-columnview")?a(k,m):d(k,
m))});f.forEach(function(k){if(m.matches(k.dataset.graniteCollectionPagetitleTarget)){var t=p.find(function(l){return m.matches(l.dataset.graniteCollectionNavigatorTarget)});t=t?t.querySelectorAll("betty-breadcrumbs-item"):[];1<t.length&&t[0].textContent?e(k,m,t[0].textContent.trim()):e(k,m)}})});h(n).on("change","betty-breadcrumbs.granite-collection-navigator",function(f){var m=this.selectedItem,p=n.querySelector(this.dataset.graniteCollectionNavigatorTarget);(f=m.dataset.graniteCollectionNavigatorCollectionid)?
(h(m).prevAll("betty-breadcrumbs-item").remove(),m=h(p).adaptTo("foundation-collection"),"load"in m||console&&console.warn("FoundationCollection#load is not implemented; do nothing."),m.load(f)):window.location=m.dataset.graniteCollectionNavigatorHref})})(document,Granite.$,Granite.URITemplate,window.Coral);
(function(n,h,b,g){function c(d){if("granite-omnisearch-result"===d.id){d=h.I18n.get("Please wait for items to load before you switch views");var e=h.I18n.get("Info");b(window).adaptTo("foundation-ui").notify(e,d,"info")}}function a(d){d=d.querySelectorAll(".foundation-selections-item");return Array.prototype.map.call(d,function(e){return e.dataset.foundationCollectionItemId})}b(n).on("coral-cyclebutton:change",".granite-collection-switcher",function(d){var e=this.dataset.graniteCollectionSwitcherTarget;
if((d=d.originalEvent.detail.selection.dataset.graniteCollectionSwitcherSrc)&&e){e=h.UI.Foundation.Utils.sanitizeHtml(e);var f=b(e);e=f[0];var m=f.adaptTo("foundation-collection"),p=f.adaptTo("shell-collection-sort");m="getPagination"in m?m.getPagination():null;var k=a(e),t="true"===e.dataset.foundationSelectionsSelectallMode;p&&p.clearCookie();c(e);h.UI.Foundation.Layouts.cleanAll(e);d=g.expand(d,{offset:0,limit:m&&k.length?m.offset:null,id:e.dataset.foundationCollectionId});b.ajax({url:d,cache:!1}).then(function(l){b(window).adaptTo("foundation-util-htmlparser").parse(l).then(function(q){q=
b(q).children();var r=q[0];f.replaceWith(q);r.dataset.foundationSelectionsSelectallMode=t;0<k.length&&q.data("foundation-layout-collection-switcher.internal.selectionIds",k);q.trigger("foundation-contentloaded");q.removeData("foundation-layout-collection-switcher.internal.selectionIds");q=b(".foundation-layout-panel-content.foundation-collection-content coral-masonry")[0];r=b(".foundation-layout-panel-content.foundation-collection-content coral-columnview")[0];q&&b(".foundation-layout-panel-content.foundation-collection-content").attr("role",
"grid");r&&b(".foundation-layout-panel-content.foundation-collection-content").removeAttr("role")})},function(){var l=h.I18n.get("Error"),q=h.I18n.get("Fail to load data.");b(window).adaptTo("foundation-ui").alert(l,q,"error")})}})})(document,Granite,Granite.$,Granite.URITemplate);
(function(n,h){h(n).on("foundation-selections-change",".foundation-collection",function(){var b=h(this),g=0<b.adaptTo("foundation-selections").count();h(".granite-collection-create").filter(function(){return b.is(this.dataset.graniteCollectionCreateTarget)}).each(function(){g?this.classList.add("granite-collection-create-hidden"):this.classList.remove("granite-collection-create-hidden")})});h(n).on("foundation-contentloaded",function(b){h(".granite-collection-create",b.target).each(function(){var g=
Granite.UI.Foundation.Utils.sanitizeHtml(this.dataset.foundationToggleableControlTarget),c=h(g+".granite-pulldown-overlay")[0],a=h(c).closest("#granite-shell-content")[0];Coral.commons.ready(c,function(){c&&a&&(c.within=a)})})})})(document,Granite.$);
(function(n,h){h(n).on("foundation-collection-newpage",function(b){var g=h(b.target);b=g.adaptTo("foundation-collection");var c;b.getPagination&&(c=b.getPagination());h("granite-pagingstatus.granite-collection-pagingstatus").each(function(){var a=this.getAttribute("data-granite-collection-pagingstatus-target");a&&g.is(a)&&(c||(a=g.find(".foundation-collection-item").length,c={offset:a,guessTotal:a,hasNext:!1}),this.current=c.offset,this.guessTotal=c.guessTotal,this.hasNext=null===c.hasNext?1E3<c.guessTotal:
c.hasNext)})})})(document,Granite.$);
(function(n,h,b){b(h).on("coral-cyclebutton:change",".granite-toggleable-control",function(g){var c=b(this);g=g.originalEvent.detail.selection;var a=g.dataset.graniteToggleableControlAction;if("navigate"===a&&"null"!==(new URL(g.dataset.graniteToggleableControlHref,h.baseURI)).origin)n.location.href=g.dataset.graniteToggleableControlHref;else{var d=g.dataset.graniteToggleableControlTarget;if(d){var e=b(h.querySelector(d)).adaptTo("foundation-toggleable");(d=this.dataset.graniteToggleableControlSavekey)&&b.cookie(d,
g.dataset.graniteToggleableControlName||"",{expires:7,path:"/"});requestAnimationFrame(function(){void 0===a&&(a=e.isOpen()?"hide":"show");"show"===a?e.show(c[0]):"hide"===a&&e.hide()})}}})})(window,document,Granite.$);
(function(n,h,b,g){function c(){var a=Reflect.construct(HTMLElement,[],this.constructor);a._construct();return a}h=b(n).adaptTo("foundation-util-propertybuilder");c.prototype=Object.create(HTMLElement.prototype);c.prototype.constructor=c;c.prototype._construct=function(){this._render();for(var a=this.attributes,d=0;d<a.length;d++)this.attributeChangedCallback(a[d].name,void 0,a[d].value)};c.prototype.attributeChangedCallback=function(a,d,e){switch(a){case "current":case "guesstotal":case "hasnext":this._render()}};
Object.defineProperties(c.prototype,{current:(new h(h.createAttrBasedProperty("current"))).mix(h.integerType(-1)).build(),guessTotal:(new h(h.createAttrBasedProperty("guesstotal"))).mix(h.integerType(-1)).build(),hasNext:h.createBooleanAttrBasedProperty("hasnext")});c.prototype._render=function(){var a=""+this.guessTotal;this.hasNext&&(a+="+");this.textContent=g.I18n.get("{0} of {1}",[this.current,a])};c.observedAttributes=["current","guesstotal","hasnext"];n.customElements.define("granite-pagingstatus",
c)})(window,document,Granite.$,Granite);
(function(n,h,b,g){function c(m){var p=!0;Array.from(m.querySelectorAll("a[is\x3d'coral-anchorlist-item']")).some(function(k){return"none"!==n.getComputedStyle(k).display?(p=!1,!0):!1});p&&!0===m.open&&(m.open=!1);m.previousElementSibling.hidden=p}function a(m){(new MutationObserver(function(p){p.some(function(k){return k.target instanceof Coral.AnchorList.Item})&&c(m)})).observe(m,{attributes:!0,subtree:!0,attributeFilter:["hidden","class"]});c(m)}var d=b(n),e=d.adaptTo("foundation-registry"),f=
new WeakMap;e.register("foundation.adapters",{type:"foundation-command",selector:".granite-pulldown-overlay [data-foundation-command]",adapter:function(m){var p=m.closest(".granite-pulldown-overlay").previousElementSibling;return{enhanceUI:function(){var k=d.adaptTo("foundation-util-keyboard"),t=m.textContent.trim();m.dataset.foundationCommandLabel||(m.dataset.foundationCommandLabel=t);t=m._elements.shortcutHint;t||(k=k.normalize(this.getShortcut()),t=h.createElement("span"),t.classList.add("granite-command-alignRight"),
t.textContent=k,m._elements.shortcutHint=t,m.content?m.content.insertBefore(t,m.content.firstChild):m.insertBefore(t,m.firstChild))},execute:function(){m.click()},getLabel:function(){var k=m.dataset.foundationCommandLabel||m.textContent.trim();return g.I18n.get("{0} {1}",[p.textContent.trim(),k])},getShortcut:function(){return m.dataset.foundationCommand},isActive:function(){return 0<p.offsetWidth&&0<p.offsetHeight&&!m.hidden&&!m.classList.contains("foundation-collection-action-hidden")}}}});b(h).on("foundation-contentloaded",
function(m){Array.from(m.target.querySelectorAll(".granite-pulldown-overlay")).forEach(function(p){f.has(p)||(a(p),f.set(p,!0))})})})(window,document,Granite.$,Granite);
(function(n,h,b){n=b(n);var g=n.adaptTo("foundation-util-keyboard");n.adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-command",selector:".granite-ActionGroup-item[data-foundation-command]",adapter:function(c){var a=b(c),d=a.closest(".granite-ActionGroup"),e;return{enhanceUI:function(){if(!c.dataset.foundationCommandLabel){var f=c.textContent.trim();c.dataset.foundationCommandLabel=f}e||(f=g.normalize(this.getShortcut()),e=h.createElement("span"),e.classList.add("granite-command-alignRight"),
e.textContent=f,c.content?c.content.insertBefore(e,c.content.firstChild):c.insertBefore(e,c.firstChild))},execute:function(){a.click()},getLabel:function(){return c.dataset.foundationCommandLabel||c.textContent.trim()},getShortcut:function(){return c.dataset.foundationCommand},isActive:function(){return d.is(":visible")&&!a.prop("hidden")&&!a.prop("disabled")}}}});b(h).on("click",".granite-ActionGroup-item",function(c){b(c.target).closest("coral-popover").hide()})})(window,document,Granite.$);
(function(n,h,b,g){var c=g.UI.Foundation.Utils.everyReverse,a=b(n).adaptTo("foundation-registry");b(h).on("click",".granite-form-saveactivator",function(d){d=this.dataset.graniteFormSaveactivatorHref;var e=b("#"+this.getAttribute("form"));e.addClass("granite-form-saveactivator-form");d?e.attr("data-granite-form-saveactivator-form-redirect",d):e.removeAttr("data-granite-form-saveactivator-form-redirect")});b(h).on("foundation-form-submitted",".granite-form-saveactivator-form",function(d,e,f){if(e){var m=
b(this),p=m.data("foundationFormResponseUiSuccess")||m.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");p||((d=this.dataset.graniteFormSaveactivatorFormRedirect)?(p={name:"foundation.redirect",href:d},b(n).adaptTo("foundation-util-messenger").put(null,g.I18n.get("Properties updated successfully"),"success")):p={name:"foundation.reload"},c(a.get("foundation.form.response.ui.success"),function(k){return k.name!==p.name?!0:!1===k.handler.call(m[0],m[0],p)}))}})})(window,
document,Granite.$,Granite);
(function(n,h,b){function g(m,p){(m=m[0].dataset.granitePickerdialogCollection)&&(m=b(m).adaptTo("foundation-selections"))&&m.clear();return{clean:function(){},replace:function(k){}}}function c(m,p){var k=p.filter("#granite-pickerdialog-search-result-titlebar-center"),t=p.filter("#granite-pickerdialog-search-result-titlebar-right"),l=m.find(".granite-pickerdialog-titlebar"),q=l.children("betty-titlebar-title"),r=l.children("betty-titlebar-secondary");k.length&&(q.prop("hidden",!0).after(k),r.prop("hidden",
!0).after(t));l.trigger("foundation-contentloaded");return{clean:function(){q.prop("hidden",!1);k.remove();r.prop("hidden",!1);t.remove()},replace:function(z){k=z.filter("#granite-pickerdialog-search-result-titlebar-center").replaceAll(k);t=z.filter("#granite-pickerdialog-search-result-titlebar-right").replaceAll(t);l.trigger("foundation-contentloaded")}}}function a(m,p){var k=p.filter("#granite-pickerdialog-search-result-content"),t=m.find(".granite-pickerdialog-content .foundation-layout-panel-content");
t.prop("hidden",!0);k.insertAfter(t).trigger("foundation-contentloaded");return{clean:function(){k.remove();t.prop("hidden",!1)},replace:function(l){k=l.filter("#granite-pickerdialog-search-result-content").replaceAll(k).trigger("foundation-contentloaded")}}}function d(m,p){var k=m.find(".granite-pickerdialog-searchfield"),t=k.children("[foundation-autocomplete-button]"),l=t.prop("icon");p=Granite.I18n.get("Close Search");t.prop("tabIndex",0);t.prop("icon","closeCircle");t.attr("title",p);t.attr("aria-label",
p);t.removeAttr("role");var q=function(r){r.preventDefault();this.blur();e(m)};t.on("click",q);return{clean:function(){var r=k.adaptTo("foundation-field");r&&r.setValue("");t.prop("tabIndex",-1);t.prop("icon",l);t.removeAttr("title");t.removeAttr("aria-label");t.attr("role","presentation");t.off("click",q);k.focus()},replace:function(r){}}}function e(m){m=m[0];var p=f.get(m);p&&Granite.UI.Foundation.Utils.everyReverse(p,function(k){k.clean();return!0});f.delete(m)}var f=new WeakMap;b(n).adaptTo("foundation-registry").register("foundation.form.response.ui.success",
{name:"granite.pickerdialog.search.result",handler:function(m,p,k,t,l,q){b(n).adaptTo("foundation-util-htmlparser").parse(q).then(function(r){var z=b(r).children();r=b(m).closest(".granite-pickerdialog");var u=r[0],w=f.get(u);w?w.forEach(function(A){A.replace(z)}):(w=[],w.push(g(r,z)),w.push(c(r,z)),w.push(a(r,z)),w.push(d(r,z)),f.set(u,w))})}});b(h).on("click",".granite-pickerdialog-search-close",function(m){m.preventDefault();m=b(this).closest(".granite-pickerdialog");e(m)})})(window,document,Granite.$);
(function(n,h){function b(c){return function(a){return c?c.replace("{{count}}",a.count+(0<a.count&&a.hasNext?"+":"")):""}}function g(c){var a={count:c.adaptTo("foundation-selections").count(),hasNext:!1};if("true"!==c[0].dataset.foundationSelectionsSelectallMode)return a;if(c=c.adaptTo("foundation-collection").getPagination())a.hasNext=null===c.hasNext?1E3<c.guessTotal:c.hasNext;return a}h(n).on("foundation-selections-change",".foundation-collection",function(){var c=h(this);h(".foundation-admin-selectionstatus").filter(function(){return c.is(this.dataset.foundationAdminSelectionstatusTarget)}).each(function(){var a=
h(this),d=b(a[0].dataset.foundationAdminSelectionstatusTemplate);a.html(d(g(c)))});h(".granite-collection-deselect").filter(function(){return c.is(this.dataset.graniteCollectionDeselectTarget)}).each(function(){var a=b(this.dataset.graniteCollectionDeselectTemplate);this.children[1].setAttribute("alt",a(g(c)))})})})(document,Granite.$);
(function(n,h,b){b(h).on("foundation-form-submitted","#granite-user-preferences",function(g,c){c&&(g=b(this).serializeArray(),b(n).adaptTo("foundation-preference").setAll(g.reduce(function(a,d){a.set(d.name,d.value);return a},new Map)),b(h).trigger(b.Event("user-preferences-changed",{userPreferences:g})),setTimeout(function(){n.location.reload()},100))});b(h).on("submit","#impersonation-form",function(g){g.preventDefault();g=b(this);b.ajax({url:g.attr("action"),type:g.attr("method")||"post",data:g.serializeArray(),
async:!1,error:function(){h.getElementById("invalid-user-error").removeAttribute("hidden")},success:function(){h.getElementById("invalid-user-error").setAttribute("hidden","true");n.location.reload()}})})})(window,document,Granite.$);(function(n,h,b){n.chrome&&/Google/.test(b.vendor)&&!/OPR|Edge/.test(b.userAgent)&&n.addEventListener("unload",function(){h.documentElement.innerHTML=""})})(window,document,navigator);
(function(n,h){h(n).on("foundation-contentloaded",function(b){b=n.querySelector(".granite-skipNavigationLinks");if(null!==b&&(0===b.hash.length||null===n.querySelector(b.hash))){var g=b.getAttribute("data-target-selector");g=n.querySelector(g);null!==g&&(g.id=g.id||"skip-navigation-links-target-"+Coral.commons.getUID(),b.setAttribute("href","#"+g.id))}})})(document,Granite.$);